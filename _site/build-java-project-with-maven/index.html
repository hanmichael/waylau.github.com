<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <meta name="description" content="Way Lau's Personal Site | www.waylau.com">
  <meta name="author" content="Way Lau">
  <meta name="keywords" content="使用maven编译Java项目, Way Lau's Blog, Way Lau">
  <title>使用maven编译Java项目 - Way Lau's Blog</title>
  <link rel="canonical" href="http://www.waylau.com/build-java-project-with-maven/">
  <link rel="icon" href="/res/img/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/res/img/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/res/css/public.css">
  <link rel="stylesheet" href="/res/css/light.css">
  <script src="/res/js/light.js"></script>
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?28cf5fa48a599e39c5cc760931de942f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>
</head>
<body>
  <div id="blog">
    <div class="sidebar">
  <div class="profilepic">
    <a href="/"><img src="/res/img/icon.png" alt="logo"></img></a>
  </div>
  <h1 class="title"><a href="/">Way Lau's Blog</a></h1>
  <h2 class="sub-title">技术改变世界！</h2>
  <nav id="nav">
    <ul>
    
      <li><a href="/timing/"><i class="fa fa-clock-o"></i>&nbsp;时光机</a></li>
    
      <li><a href="/categories/"><i class="fa fa-tags"></i>&nbsp;分类</a></li>
    
      <li><a href="/tags/"><i class="fa fa-bookmark"></i>&nbsp;标签</a></li>
    
      <li><a href="http://labs.waylau.com/"><i class="fa fa-building"></i>&nbsp;示例</a></li>
    
      <li><a href="/books/"><i class="fa fa-book"></i>&nbsp;书籍</a></li>
    
      <li><a href="/about/"><i class="fa fa-paper-plane-o"></i>&nbsp;关于</a></li>
    
    </ul>
  </nav>  
  <nav id="sub-nav">
    <a class="weibo " href="http://weibo.com/waylau521" title="新浪微博" target="_blank"><i class="fa fa-weibo "></i></a>
    <a class="github" href="https://github.com/waylau" title="GitHub" target="_blank"><i class="fa fa-github fa-2x"></i></a>
    <a class="twitter" href="https://twitter.com/waylau521" title="Twitter" target="_blank"><i class="fa fa-twitter fa-2x"></i></a>
    <a class="rss" href="/page/feed.xml" title="RSS订阅" target="_blank"><i class="fa fa-rss"></i></a>
  </nav>
  <div id="license">
    <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank" title="本站所有作品采用：&#10;知识共享《署名 非商业性使用 相同方式共享 3.0》&#10;进行许可" >
    <img alt="License" height="31" width="88" src="/res/img/license.png" /></a>
  </div>
</div>
    <div class="main">
    <header class="post-header">
  <h1 class="post-title"><a href="/build-java-project-with-maven/">使用maven编译Java项目</a></h2>
  <p class="post-meta">
    <i class="fa fa-calendar"></i>
    2014年07月17日
    <i class="space"></i>
    <i class="fa fa-tags"></i>
    <a class="post-category" href="/page/category.html#maven">maven</a>	
  </p>
</header>
<div class="post-main">
<h1>综述</h1>

<p>本文演示了用Maven编译Java项目</p>

<h1>需要</h1>

<ul>
<li>时间：15分钟</li>
<li>文本编辑器或者IDE</li>
<li>JDK 6 或者更高版本</li>
</ul>


<h1>创建项目</h1>

<p>本例主要为了展示Maven，所以Java的项目力求简单。</p>

<h1>创建项目结构</h1>

<p>选择一个项目目录，在 *nix系统上使用下面语句</p>

<pre><code>mkdir -p src/main/java/hello
</code></pre>

<p>window下使用命令</p>

<pre><code>mkdir src\main\java\hello
</code></pre>

<p>创建如下结构：</p>

<pre><code>└── src
    └── main
        └── java
            └── hello
</code></pre>

<p>在<code>src/main/java/hello</code>目录下创建Java文件<code>HelloWorld.java</code>和 <code>Greeter.java</code></p>

<p><code>src/main/java/hello/HelloWorld.java</code></p>

<pre><code>package hello;

public class HelloWorld {
    public static void main(String[] args) {
        Greeter greeter = new Greeter();
        System.out.println(greeter.sayHello());
    }
}
</code></pre>

<p><code>src/main/java/hello/Greeter.java</code></p>

<pre><code>package hello;

public class Greeter {
    public String sayHello() {
        return "Hello world!";
    }
}
</code></pre>

<p>现在项目完成，可以用Maven编译了。有关Maven的安装，可以参考<a href="http://www.waylau.com/apache-maven-3-1-0-installation-deployment-and-use/">Apache Maven 3.1.0 安装、部署、使用</a></p>

<h1>定义简单的Maven编译</h1>

<p>首先，在项目的根目录下创建一个Maven项目定义文件<code>pom.xml</code>,该文件主要是说明项目的名称、版本和依赖库</p>

<p><code>pom.xml</code></p>

<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;gs-maven&lt;/artifactId&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;
    &lt;version&gt;0.1.0&lt;/version&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.1&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;shade&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;transformers&gt;
                                &lt;transformer
                                    implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"&gt;
                                    &lt;mainClass&gt;hello.HelloWorld&lt;/mainClass&gt;
                                &lt;/transformer&gt;
                            &lt;/transformers&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;
</code></pre>

<p>除了&lt;packaging&gt; 元素可选外，其他的元素是构成<code>pom.xml</code> 文件的最基本的元素了。它包括以下几个项目的配置：</p>

<ul>
<li>&lt;modelVersion&gt; ：POM 模块版本(通常是4.0.0).</li>
<li>&lt;groupId&gt; ：项目所属的组织编号，通常用域名</li>
<li>&lt;artifactId&gt; 项目的名称(比如，JAR或者WAR的名称)</li>
<li>&lt;version&gt; 项目编译的版本号</li>
<li>&lt;packaging&gt; 项目打包形式，jar或者war</li>
</ul>


<h1>编译Java代码</h1>

<p>运行下面语句编译</p>

<pre><code>mvn compile
</code></pre>

<p>编译完成的<code>.class</code>文件将会出现在<code>target/classes</code>目录下.如下图
<img src="http://e.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=0fd2eacb8544ebf86971643ae9c2a617/0d338744ebf81a4c35bd3f01d52a6059242da66f.jpg?referer=b410ea0c33adcbef58234a360225&amp;x=.jpg" alt="编译Java代码" /></p>

<p><img src="http://h.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=19799d719c510fb37c197792e908b9a8/7a899e510fb30f24bd133fcbca95d143ac4b0369.jpg?referer=07ad60e0347adab464c72f736d28&amp;x=.jpg" alt="class" /></p>

<p>运行项目：</p>

<pre><code>mvn exec:java -Dexec.mainClass="hello.HelloWorld"
</code></pre>

<p>输出如下：
<img src="http://h.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=ebd4d2505cdf8db1b82e7c613918ac69/35a85edf8db1cb13fee0efdbdf54564e93584b69.jpg?referer=66b45c59cf11728b693ab812b527&amp;x=.jpg" alt="HelloWorld" /></p>

<p>如果不想直接运行<code>.class</code>文件，可以将其打包：</p>

<pre><code>mvn package
</code></pre>

<p>打包完成后，会在<code>target</code>目录下生成一个JAR文件，文件名由&lt;artifactId&gt; 和 &lt;version&gt;组成。比如本例，将会根据<code>pom.xml</code>生成<code>gs-maven-0.1.0.jar</code></p>

<p><img src="http://g.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=460dfe20be3eb13540c7b7be9625d9ee/18d8bc3eb13533fa448c41e6aad3fd1f40345bc4.jpg?referer=141ce90c19d5ad6ef3ee50daa5da&amp;x=.jpg" alt="gs-maven-0.1.0.jar" /></p>

<p><img src="http://c.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=f9566573a41ea8d38e227401a7314173/838ba61ea8d3fd1f8b9870f2324e251f94ca5f61.jpg?referer=1768b62283cb39db98d75366993f&amp;x=.jpg" alt="gs-maven-0.1.0.jar" />
如果你想安装您的项目的JAR文件到本地Maven仓库，那么你应该调用下面语句：</p>

<pre><code>mvn install
</code></pre>

<p>此时，你的项目代码将会经过编译、测试、打包并拷贝到本地依赖库，提供给其他项目引用。</p>

<p>以上例子源码的地址<a href="https://github.com/waylau/maven-demo">https://github.com/waylau/maven-demo</a>中的demo1</p>

<p>说到项目依赖，下面说下<code>声明依赖</code></p>

<h1>声明依赖</h1>

<p>上面的例子比较简单，没有用到其他库。但是真实的项目可能会引用（依赖）到很多其他库。</p>

<p>下面例子，依赖了<code>Joda Time</code>的库。</p>

<p>修改<code>src/main/java/hello/HelloWorld.java</code></p>

<pre><code>package hello;

import org.joda.time.LocalTime;

public class HelloWorld {
    public static void main(String[] args) {
        LocalTime currentTime = new LocalTime();
        System.out.println("The current local time is: " + currentTime);
        Greeter greeter = new Greeter();
        System.out.println(greeter.sayHello());
    }
}
</code></pre>

<p>现在运行<code>mvn compile</code>将会报错，因为没有声明依赖。在 &lt;project&gt; 节点下插入如下：</p>

<pre><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;joda-time&lt;/groupId&gt;
        &lt;artifactId&gt;joda-time&lt;/artifactId&gt;
        &lt;version&gt;2.2&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>

<p><img src="http://b.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=90b4aaf06c061d957946373d4bcf7bec/4d086e061d950a7b3bbd9d0c08d162d9f3d3c96a.jpg?referer=87bc8d9bf4246b60221986443728&amp;x=.jpg" alt="声明依赖" /></p>

<p>这段内容就声明了项目的依赖。每个依赖节点&lt;dependency&gt;都由三个子节点组成：</p>

<ul>
<li>&lt;groupId&gt; ： 该依赖库所属的组织名称</li>
<li>&lt;artifactId&gt; ： 依赖的库名</li>
<li>&lt;version&gt; ： 依赖的库版本</li>
</ul>


<p>在POM 4中，&lt;dependency&gt; 中还引入了&lt;scope&gt; ，它主要管理依赖的部署。目前&lt;scope&gt; 可以使用5个值：</p>

<ul>
<li>compile，缺省值，适用于所有阶段，会随着项目一起发布。</li>
<li>provided，类似compile，期望JDK、容器或使用者会提供这个依赖。如servlet.jar。</li>
<li>runtime，只在运行时使用，如JDBC驱动，适用运行和测试阶段。</li>
<li>test，只在测试时使用，用于编译和运行测试代码。不会随项目发布。</li>
<li>system，类似provided，需要显式提供包含依赖的jar，Maven不会在Repository中查找它。</li>
</ul>


<p>现在你运行<code>mvn compile</code>或者<code>mvn package</code>，Maven会自动下载相关依赖。</p>

<p>完整的<code>pom.xml</code></p>

<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;gs-maven&lt;/artifactId&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;
    &lt;version&gt;0.1.0&lt;/version&gt;

    &lt;!-- tag::joda[] --&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;joda-time&lt;/groupId&gt;
            &lt;artifactId&gt;joda-time&lt;/artifactId&gt;
            &lt;version&gt;2.2&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
    &lt;!-- end::joda[] --&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.1&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;shade&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;transformers&gt;
                                &lt;transformer
                                    implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"&gt;
                                    &lt;mainClass&gt;hello.HelloWorld&lt;/mainClass&gt;
                                &lt;/transformer&gt;
                            &lt;/transformers&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;
</code></pre>

<p>运行项目：</p>

<pre><code>mvn exec:java -Dexec.mainClass="hello.HelloWorld"
</code></pre>

<p>输出如下：
<img src="http://g.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=df2c5f61ab014c081d3b28a03a407335/b999a9014c086e062b9ded8300087bf40bd1cbc5.jpg?referer=3c4e15e7bc096b63d80e6a6035db&amp;x=.jpg" alt="运行项目" /></p>

<p>以上例子源码的地址<a href="https://github.com/waylau/maven-demo">https://github.com/waylau/maven-demo</a>中的demo2</p>

<p>参考：<a href="http://spring.io/guides/gs/maven/">http://spring.io/guides/gs/maven/</a></p>

<p><a href="http://www.vineetmanohar.com/2009/11/3-ways-to-run-java-main-from-maven/">http://www.vineetmanohar.com/2009/11/3-ways-to-run-java-main-from-maven/</a></p>

</div>
<div class="share">
  <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more"></a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
  </div>
  <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":["qzone","tsina","weixin","sqq"],"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/res/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</div>
<div class="pagination">

<a class="pagination-item newer" href="/use-maven-mirrors/"><i class="fa fa-arrow-left"></i>&nbsp;&nbsp;使用maven镜像</a>


<a class="pagination-item older" href="/jersey-sqlserver-hibernate4-spring3/">用Jersey构建RESTful服务7--Jersey+SQLServer+Hibernate4.3+Spring3.2&nbsp;&nbsp;<i class="fa fa-arrow-right"></i></a>

</div>
<div class="comments">
  <div class="ds-thread" data-title="使用maven编译Java项目" data-thread-key="/build-java-project-with-maven" data-url="http://www.waylau.com/build-java-project-with-maven/"></div>
  <script type="text/javascript">var duoshuoQuery = {short_name:"waylau"};(function(){var ds = document.createElement('script');ds.type = 'text/javascript';ds.async = true;ds.src = '/res/js/embed.js';ds.charset = 'UTF-8';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);})();</script>
</div>
    <footer>Copyright&nbsp;&copy;&nbsp;2014 <a href="http://www.waylau.com">Way Lau's Blog</a><br/><i class="fa fa-cogs" style="color:blueviolet;">&nbsp;</i>Powered by <a href="https://github.com/waylau/jekyll-theme-blog" target="_blank">jekyll-theme-blog</a></footer>
    </div>


  </div>    
  <div id="top"><a id="rocket" href="javascript:;" title="返回顶部"><i></i></a></div>
  


</body>
</html>