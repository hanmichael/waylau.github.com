<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <meta name="description" content="Way Lau's Personal Site | www.waylau.com">
  <meta name="author" content="Way Lau">
  <meta name="keywords" content="Way Lau's Personal Site | www.waylau.com, Way Lau's Blog, 技术改变世界！, Way Lau">
  <title>Way Lau's Personal Site | www.waylau.com</title>
  <link rel="canonical" href="http://www.waylau.com">
  <link rel="icon" href="/res/img/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/res/img/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/res/css/public.css">
  <link rel="stylesheet" href="/res/css/light.css">
  <script src="/res/js/light.js"></script>
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?28cf5fa48a599e39c5cc760931de942f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>
</head>
<body>
  <div id="blog">
    <div class="sidebar">
  <div class="profilepic">
    <a href="/"><img src="/res/img/icon.png" alt="logo"></img></a>
  </div>
  <h1 class="title"><a href="/">Way Lau's Blog</a></h1>
  <h2 class="sub-title">技术改变世界！</h2>
  <nav id="nav">
    <ul>
    
      <li><a href="/timing/"><i class="fa fa-clock-o"></i>&nbsp;时光机</a></li>
    
      <li><a href="/categories/"><i class="fa fa-tags"></i>&nbsp;分类</a></li>
    
      <li><a href="/tags/"><i class="fa fa-bookmark"></i>&nbsp;标签</a></li>
    
      <li><a href="http://labs.waylau.com/"><i class="fa fa-building"></i>&nbsp;示例</a></li>
    
      <li><a href="/books/"><i class="fa fa-book"></i>&nbsp;书籍</a></li>
    
      <li><a href="/about/"><i class="fa fa-paper-plane-o"></i>&nbsp;关于</a></li>
    
    </ul>
  </nav>  
  <nav id="sub-nav">
    <a class="weibo " href="http://weibo.com/waylau521" title="新浪微博" target="_blank"><i class="fa fa-weibo "></i></a>
    <a class="github" href="https://github.com/waylau" title="GitHub" target="_blank"><i class="fa fa-github fa-2x"></i></a>
    <a class="twitter" href="https://twitter.com/waylau521" title="Twitter" target="_blank"><i class="fa fa-twitter fa-2x"></i></a>
    <a class="rss" href="/page/feed.xml" title="RSS订阅" target="_blank"><i class="fa fa-rss"></i></a>
  </nav>
  <div id="license">
    <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank" title="本站所有作品采用：&#10;知识共享《署名 非商业性使用 相同方式共享 3.0》&#10;进行许可" >
    <img alt="License" height="31" width="88" src="/res/img/license.png" /></a>
  </div>
</div>
    <div class="main">
    
<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/build-java-project-with-maven/">使用maven编译Java项目</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年07月17日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#maven">maven</a>
      </p>
    </header>
    <div class="post-main">
      <h1>综述</h1>

<p>本文演示了用Maven编译Java项目</p>

<h1>需要</h1>

<ul>
<li>时间：15分钟</li>
<li>文本编辑器或者IDE</li>
<li>JDK 6 或者更高版本</li>
</ul>


<h1>创建项目</h1>

<p>本例主要为了展示Maven，所以Java的项目力求简单。</p>

<h1>创建项目结构</h1>

<p>选择一个项目目录，在 *nix系统上使用下面语句</p>

<pre><code>mkdir -p src/main/java/hello
</code></pre>

<p>window下使用命令</p>

<pre><code>mkdir src\main\java\hello
</code></pre>

<p>创建如下结构：</p>

<pre><code>└── src
    └── main
        └── java
            └── hello
</code></pre>

<p>在<code>src/main/java/hello</code>目录下创建Java文件<code>HelloWorld.java</code>和 <code>Greeter.java</code></p>

<p><code>src/main/java/hello/HelloWorld.java</code></p>

<pre><code>package hello;

public class HelloWorld {
    public static void main(String[] args) {
        Greeter greeter = new Greeter();
        System.out.println(greeter.sayHello());
    }
}
</code></pre>

<p><code>src/main/java/hello/Greeter.java</code></p>

<pre><code>package hello;

public class Greeter {
    public String sayHello() {
        return "Hello world!";
    }
}
</code></pre>

<p>现在项目完成，可以用Maven编译了。有关Maven的安装，可以参考<a href="http://www.waylau.com/apache-maven-3-1-0-installation-deployment-and-use/">Apache Maven 3.1.0 安装、部署、使用</a></p>

<h1>定义简单的Maven编译</h1>

<p>首先，在项目的根目录下创建一个Maven项目定义文件<code>pom.xml</code>,该文件主要是说明项目的名称、版本和依赖库</p>

<p><code>pom.xml</code></p>

<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;gs-maven&lt;/artifactId&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;
    &lt;version&gt;0.1.0&lt;/version&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.1&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;shade&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;transformers&gt;
                                &lt;transformer
                                    implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"&gt;
                                    &lt;mainClass&gt;hello.HelloWorld&lt;/mainClass&gt;
                                &lt;/transformer&gt;
                            &lt;/transformers&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;
</code></pre>

<p>除了&lt;packaging&gt; 元素可选外，其他的元素是构成<code>pom.xml</code> 文件的最基本的元素了。它包括以下几个项目的配置：</p>

<ul>
<li>&lt;modelVersion&gt; ：POM 模块版本(通常是4.0.0).</li>
<li>&lt;groupId&gt; ：项目所属的组织编号，通常用域名</li>
<li>&lt;artifactId&gt; 项目的名称(比如，JAR或者WAR的名称)</li>
<li>&lt;version&gt; 项目编译的版本号</li>
<li>&lt;packaging&gt; 项目打包形式，jar或者war</li>
</ul>


<h1>编译Java代码</h1>

<p>运行下面语句编译</p>

<pre><code>mvn compile
</code></pre>

<p>编译完成的<code>.class</code>文件将会出现在<code>target/classes</code>目录下.如下图
<img src="http://e.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=0fd2eacb8544ebf86971643ae9c2a617/0d338744ebf81a4c35bd3f01d52a6059242da66f.jpg?referer=b410ea0c33adcbef58234a360225&amp;x=.jpg" alt="编译Java代码" /></p>

<p><img src="http://h.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=19799d719c510fb37c197792e908b9a8/7a899e510fb30f24bd133fcbca95d143ac4b0369.jpg?referer=07ad60e0347adab464c72f736d28&amp;x=.jpg" alt="class" /></p>

<p>运行项目：</p>

<pre><code>mvn exec:java -Dexec.mainClass="hello.HelloWorld"
</code></pre>

<p>输出如下：
<img src="http://h.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=ebd4d2505cdf8db1b82e7c613918ac69/35a85edf8db1cb13fee0efdbdf54564e93584b69.jpg?referer=66b45c59cf11728b693ab812b527&amp;x=.jpg" alt="HelloWorld" /></p>

<p>如果不想直接运行<code>.class</code>文件，可以将其打包：</p>

<pre><code>mvn package
</code></pre>

<p>打包完成后，会在<code>target</code>目录下生成一个JAR文件，文件名由&lt;artifactId&gt; 和 &lt;version&gt;组成。比如本例，将会根据<code>pom.xml</code>生成<code>gs-maven-0.1.0.jar</code></p>

<p><img src="http://g.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=460dfe20be3eb13540c7b7be9625d9ee/18d8bc3eb13533fa448c41e6aad3fd1f40345bc4.jpg?referer=141ce90c19d5ad6ef3ee50daa5da&amp;x=.jpg" alt="gs-maven-0.1.0.jar" /></p>

<p><img src="http://c.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=f9566573a41ea8d38e227401a7314173/838ba61ea8d3fd1f8b9870f2324e251f94ca5f61.jpg?referer=1768b62283cb39db98d75366993f&amp;x=.jpg" alt="gs-maven-0.1.0.jar" />
如果你想安装您的项目的JAR文件到本地Maven仓库，那么你应该调用下面语句：</p>

<pre><code>mvn install
</code></pre>

<p>此时，你的项目代码将会经过编译、测试、打包并拷贝到本地依赖库，提供给其他项目引用。</p>

<p>以上例子源码的地址<a href="https://github.com/waylau/maven-demo">https://github.com/waylau/maven-demo</a>中的demo1</p>

<p>说到项目依赖，下面说下<code>声明依赖</code></p>

<h1>声明依赖</h1>

<p>上面的例子比较简单，没有用到其他库。但是真实的项目可能会引用（依赖）到很多其他库。</p>

<p>下面例子，依赖了<code>Joda Time</code>的库。</p>

<p>修改<code>src/main/java/hello/HelloWorld.java</code></p>

<pre><code>package hello;

import org.joda.time.LocalTime;

public class HelloWorld {
    public static void main(String[] args) {
        LocalTime currentTime = new LocalTime();
        System.out.println("The current local time is: " + currentTime);
        Greeter greeter = new Greeter();
        System.out.println(greeter.sayHello());
    }
}
</code></pre>

<p>现在运行<code>mvn compile</code>将会报错，因为没有声明依赖。在 &lt;project&gt; 节点下插入如下：</p>

<pre><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;joda-time&lt;/groupId&gt;
        &lt;artifactId&gt;joda-time&lt;/artifactId&gt;
        &lt;version&gt;2.2&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>

<p><img src="http://b.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=90b4aaf06c061d957946373d4bcf7bec/4d086e061d950a7b3bbd9d0c08d162d9f3d3c96a.jpg?referer=87bc8d9bf4246b60221986443728&amp;x=.jpg" alt="声明依赖" /></p>

<p>这段内容就声明了项目的依赖。每个依赖节点&lt;dependency&gt;都由三个子节点组成：</p>

<ul>
<li>&lt;groupId&gt; ： 该依赖库所属的组织名称</li>
<li>&lt;artifactId&gt; ： 依赖的库名</li>
<li>&lt;version&gt; ： 依赖的库版本</li>
</ul>


<p>在POM 4中，&lt;dependency&gt; 中还引入了&lt;scope&gt; ，它主要管理依赖的部署。目前&lt;scope&gt; 可以使用5个值：</p>

<ul>
<li>compile，缺省值，适用于所有阶段，会随着项目一起发布。</li>
<li>provided，类似compile，期望JDK、容器或使用者会提供这个依赖。如servlet.jar。</li>
<li>runtime，只在运行时使用，如JDBC驱动，适用运行和测试阶段。</li>
<li>test，只在测试时使用，用于编译和运行测试代码。不会随项目发布。</li>
<li>system，类似provided，需要显式提供包含依赖的jar，Maven不会在Repository中查找它。</li>
</ul>


<p>现在你运行<code>mvn compile</code>或者<code>mvn package</code>，Maven会自动下载相关依赖。</p>

<p>完整的<code>pom.xml</code></p>

<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;gs-maven&lt;/artifactId&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;
    &lt;version&gt;0.1.0&lt;/version&gt;

    &lt;!-- tag::joda[] --&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;joda-time&lt;/groupId&gt;
            &lt;artifactId&gt;joda-time&lt;/artifactId&gt;
            &lt;version&gt;2.2&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
    &lt;!-- end::joda[] --&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.1&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;shade&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;transformers&gt;
                                &lt;transformer
                                    implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"&gt;
                                    &lt;mainClass&gt;hello.HelloWorld&lt;/mainClass&gt;
                                &lt;/transformer&gt;
                            &lt;/transformers&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;
</code></pre>

<p>运行项目：</p>

<pre><code>mvn exec:java -Dexec.mainClass="hello.HelloWorld"
</code></pre>

<p>输出如下：
<img src="http://g.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=df2c5f61ab014c081d3b28a03a407335/b999a9014c086e062b9ded8300087bf40bd1cbc5.jpg?referer=3c4e15e7bc096b63d80e6a6035db&amp;x=.jpg" alt="运行项目" /></p>

<p>以上例子源码的地址<a href="https://github.com/waylau/maven-demo">https://github.com/waylau/maven-demo</a>中的demo2</p>

<p>参考：<a href="http://spring.io/guides/gs/maven/">http://spring.io/guides/gs/maven/</a></p>

<p><a href="http://www.vineetmanohar.com/2009/11/3-ways-to-run-java-main-from-maven/">http://www.vineetmanohar.com/2009/11/3-ways-to-run-java-main-from-maven/</a></p>

      <div class="readall"><a href="/build-java-project-with-maven/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/use-maven-mirrors/">使用maven镜像</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年07月16日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#maven">maven</a>
      </p>
    </header>
    <div class="post-main">
      <h1>综述</h1>

<p>用maven做项目，最郁闷的莫过于某些依赖库下载不了。被墙了，你懂的。使用maven镜像仓库及其重要，特别是国内的镜像，可以有效缓解被墙疼痛。</p>

<h1>常用的镜像</h1>

<h2>国外镜像</h2>

<p>ibiblio.org</p>

<pre><code>&lt;mirror&gt;  
     &lt;id&gt;ibiblio&lt;/id&gt;  
     &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;  
     &lt;name&gt;ibiblio Mirror of http://repo1.maven.org/maven2/&lt;/name&gt;  
     &lt;url&gt;http://mirrors.ibiblio.org/pub/mirrors/maven2/&lt;/url&gt;  
&lt;/mirror&gt;  
</code></pre>

<p>jboss</p>

<pre><code>&lt;mirror&gt;  
     &lt;id&gt;jboss-public-repository-group&lt;/id&gt;  
     &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;  
     &lt;name&gt;JBoss Public Repository Group&lt;/name&gt;  
     &lt;url&gt;http://repository.jboss.org/nexus/content/groups/public&lt;/url&gt;  
&lt;/mirror&gt;
</code></pre>

<p>repo2</p>

<pre><code>&lt;mirror&gt;
  &lt;id&gt;repo2&lt;/id&gt;
  &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
  &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;
  &lt;url&gt;http://repo2.maven.org/maven2/&lt;/url&gt;
&lt;/mirror&gt;
</code></pre>

<p>uk.maven.org</p>

<pre><code>&lt;mirror&gt;
  &lt;id&gt;ui&lt;/id&gt;
  &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
  &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;
 &lt;url&gt;http://uk.maven.org/maven2/&lt;/url&gt;
&lt;/mirror&gt;
</code></pre>

<h2>国内镜像</h2>

<p>oschina.net</p>

<pre><code>&lt;mirror&gt;
    &lt;id&gt;nexus-osc&lt;/id&gt;
    &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;
    &lt;name&gt;Nexus osc&lt;/name&gt;
    &lt;url&gt;http://maven.oschina.net/content/groups/public/&lt;/url&gt;
&lt;/mirror&gt;
</code></pre>

<p>net.cn</p>

<pre><code>&lt;mirror&gt;
    &lt;id&gt;net-cn&lt;/id&gt;
    &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
    &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;
    &lt;url&gt;http://maven.net.cn/content/groups/public/&lt;/url&gt;   
 &lt;/mirror&gt;
</code></pre>

<h1>使用镜像</h1>

<p>下文以oschina.net的镜像为例子.</p>

<p>1.Maven 的安装目录下的 conf 文件下有个<code>settings.xml</code>文件,编辑该文件</p>

<p>2.在&lt;mirrors&gt;中插入:</p>

<pre><code>&lt;mirror&gt;
    &lt;id&gt;nexus-osc&lt;/id&gt;
    &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;
    &lt;name&gt;Nexus osc&lt;/name&gt;
    &lt;url&gt;http://maven.oschina.net/content/groups/public/&lt;/url&gt;
&lt;/mirror&gt;
</code></pre>

<p>3.这里是配置 Maven 的 mirror 地址指向OSChina 的 Maven 镜像地址。 在执行 Maven 命令的时候， Maven 还需要安装一些插件包，这些插件包的下载地址也让其指向 oschina.net 的 Maven 地址。在&lt;profiles&gt;中插入:</p>

<pre><code>&lt;profile&gt;
    &lt;id&gt;jdk-1.4&lt;/id&gt;
    &lt;activation&gt;
    &lt;jdk&gt;1.4&lt;/jdk&gt;
    &lt;/activation&gt;
    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;nexus&lt;/id&gt;
            &lt;name&gt;local private nexus&lt;/name&gt;
            &lt;url&gt;http://maven.oschina.net/content/groups/public/&lt;/url&gt;
            &lt;releases&gt;
                &lt;enabled&gt;true&lt;/enabled&gt;
            &lt;/releases&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;
    &lt;pluginRepositories&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;nexus&lt;/id&gt;
            &lt;name&gt;local private nexus&lt;/name&gt;
            &lt;url&gt;http://maven.oschina.net/content/groups/public/&lt;/url&gt;
            &lt;releases&gt;
                &lt;enabled&gt;true&lt;/enabled&gt;
            &lt;/releases&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;
&lt;/profile&gt;
</code></pre>

<p>参考：<a href="http://maven.oschina.net/help.html">http://maven.oschina.net/help.html</a></p>

      <div class="readall"><a href="/use-maven-mirrors/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/simple-polyline-algorithm/">简单折线算法</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年07月15日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#data visualization">data visualization</a>
      </p>
    </header>
    <div class="post-main">
      <h1>一、综述</h1>

<p>在做流程图软件时，折线必不可少。本文展示的是现有系统的简单折线实现。折线主要分为一折折线、二折折线。下面例子默认起点为“图1”，终点为“图2”，假设pt1,pt2为已知点,pt3,pt4为动态计算点。</p>

<h1>二、一折折线</h1>

<p> <img src="http://a.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=4239278589d4b31cf43c94beb7ed5642/2f738bd4b31c8701a95f8e20257f9e2f0608ff0e.jpg?referer=4bc264d44d4a20a4680908f73904&amp;x=.jpg" alt="一折折线" /></p>

<pre><code>pt3 = ( pt2.x  , pt1.y )
</code></pre>

<h1>三、二折折线</h1>

<h2>1.pt1 在pt2的左侧</h2>

<p> <img src="http://d.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=b8c88ef7a38b87d65442ab1a37335905/8601a18b87d6277f95fb0efe2a381f30e824fc0e.jpg?referer=2b704fd50bf79052b608730e3c04&amp;x=.jpg" alt="二折折线,pt1 在pt2的左侧" /></p>

<pre><code>pt3 = ( pt1.x + ( pt2.x – pt1.x )*0.5 , pt1.y )
pt4 = ( pt1.x + ( pt2.x – pt1.x )*0.5 , pt2.y )
</code></pre>

<h2>2.pt1 在pt2的右侧</h2>

<p> <img src="http://d.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=b8c88ef7a38b87d65442ab1a37335905/8601a18b87d6277f95fb0efe2a381f30e824fc0e.jpg?referer=2b704fd50bf79052b608730e3c04&amp;x=.jpg" alt="二折折线,pt1 在pt2的右侧" /></p>

<pre><code>pt3 = ( pt2.x + ( pt1.x – pt2.x )*0.5 , pt1.y )
pt4 = ( pt2.x + ( pt1.x – pt2.x )*0.5 , pt2.y )
</code></pre>

      <div class="readall"><a href="/simple-polyline-algorithm/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/about-dnscrypt/">又一架梯子上墙利器--DNSCrypt</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年07月09日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#web">web</a>
      </p>
    </header>
    <div class="post-main">
      <p><img src="http://f.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=2265d17b85d6277fed12323d18036e0d/a08b87d6277f9e2fa26c58c81d30e924b999f391.jpg?referer=e3477907925298225c240df33d8f&amp;x=.jpg" alt="翻墙" /></p>

<h1>神马是DNSCrypt？</h1>

<p>官方提法“DNSCrypt is a piece of lightweight software that everyone should use to boost online privacy and security.  It works by encrypting all DNS traffic between the user and OpenDNS, preventing any spying, spoofing or man-in-the-middle attacks.”</p>

<p>可加密DNS流量，阻止常见的DNS攻击，如重放攻击、观察攻击、时序攻击、中间人攻击和解析伪造攻击，是<em>防止DNS污染</em>的绝佳工具。</p>

<h1>神马是DNS污染？</h1>

<p>是指一些刻意制造或无意中制造出来的域名服务器分组，把域名指往不正确的IP地址。擦~不就是被“墙”了吗？</p>

<h1>DNSCrypt搞起来！</h1>

<p>DNSCrypt官方介绍页面：http://www.opendns.com/about/innovations/dnscrypt/</p>

<p>DNSCrypt最新下载地址：http://shared.opendns.com/dnscrypt/packages/windows-client/DNSCryptWin-v0.0.6.exe</p>

<p>安装运行后,亮绿灯
<img src="http://b.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=21aa4b379d3df8dca23d8f94fd2a03b6/3ac79f3df8dcd100ebc4bde1708b4710b8122f91.jpg?referer=5e413257db33c895ff69ac4b898f&amp;x=.jpg" alt="DNSCrypt" /></p>

<p>测试下https://www.flickr.com
<img src="http://h.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=bf7279d4a918972ba73a00cfd6f60ab4/0824ab18972bd4075a9e963d79899e510eb30990.jpg?referer=9967037dab7739129d31b151778f&amp;x=.jpg" alt="https://www.flickr.com" /></p>

<p>测试下https://www.facebook.com/
<img src="http://b.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=27cbd33c7ed98d1072d40c341104c933/a2cc7cd98d1001e9301751cfba0e7bec55e797c2.jpg?referer=c20539a40b23dd5478649358d1c0&amp;x=.jpg" alt="https://www.facebook.com/" /></p>

<p>测试下https://www.youtube.com 网速有点慢，今天的主脚竟然是涛哥和温总
<img src="http://d.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=a2aec747d2a20cf44290feda46323a0b/b3b7d0a20cf431ad30c303f94936acaf2fdd98d9.jpg?referer=c1055805e2fe9925921b5d60d8b7&amp;x=.jpg" alt="https://www.youtube.com/" /></p>

      <div class="readall"><a href="/about-dnscrypt/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/newborn-beat-vibration/">新生儿拍隔</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年07月03日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#newborn">newborn</a>
      </p>
    </header>
    <div class="post-main">
      <p>因为宝宝吃奶的时候很容易把空气吃进去，所以在宝宝吃完奶之后要给他们拍背，拍背的目的是给宝宝拍嗝，所以不是按时间来说的，只要宝宝打了嗝就可以不再拍了，当然有些宝宝拍很长时间也不打嗝，这是很正常的，遇到这种情况拍一两分钟那就不需要再拍了。</p>

<p>1.爸爸妈妈一手托住宝宝的头，另一手支撑宝宝的屁股，将宝宝竖着抱起来，调整好位置，让宝宝的脸可以靠在大人肩膀上。手掌略为拱起，呈半圆弧、类汤匙状，用空掌的方式轻拍宝宝背部，从背脊或腰部位置，由下往上拍，利用震动原理，慢慢地将宝宝体内的空气拍出来。</p>

<p>2.让宝宝坐在爸爸或妈妈的大腿上，身体侧面稍微靠着爸爸或妈妈的胸口，妈妈用虎口托住宝宝的下巴，另一只手先在宝宝背部轻柔画几个圆圈后，同样以空掌的方式轻拍宝宝背部。</p>

<p>3.用手指托着宝宝的颚骨，扶BB坐直约90度，将手掌微微并拢，呈空心状，从BB背部由下往上扫，直到BB嗝气。不一定是拍，可以是扫的手法，但要留意不要太用力，用力过大也会造成吐奶。</p>

<p>4.宝宝吃好奶以后，就让她上身直立，抱一会儿。因为宝宝还小，脊椎发育还不完善，所以一定要托好她的后背、脊椎以及头颈。一般来说，这样十几二十分钟后，宝宝也会打嗝；或者妈妈端坐着，一只手托住宝宝的脊椎、头颈，也让她上身呈“坐”的姿势，妈妈的另一只手托住宝宝的下巴，这样宝宝会很快打出嗝来
<img src="http://d.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=3b5c176a67380cd7e21ea2e8917fdc09/cb8065380cd791231cff7caeaf345982b3b780c9.jpg?referer=16342010ad51f3de9aa58d54e0c7&amp;x=.jpg" alt="拍隔" /></p>

<p><img src="http://d.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=a7a361e01bd8bc3ec20806cfb2b0d723/810a19d8bc3eb135f8d86361a41ea8d3fc1f44c9.jpg?referer=b63c33f10cf41bd58344dcc4a4c7&amp;x=.jpg" alt="端坐" /></p>

<h2>其他</h2>

<p>多给宝宝做腹部按摩消消滞：如果宝宝打嗝的原因是由于乳食停滞不化造成的，那么在宝宝打嗝时就可以闻到不消化的酸腐异味，多给宝宝做腹部的按摩，让宝宝在你的温柔指尖中调整自己的小肚子，帮助“排气”，食消气顺，则嗝自止。</p>

<p>做好腹部的保暖：新生儿若无其他疾病而突然打嗝，并且嗝声高亢有力且连续，一般是受寒凉所致，寒热之气逆而不顺时也容易诱发打嗝，这时可以给宝宝喝点温白开水，因此，天气寒凉时要注意宝宝腹部的保暖，睡觉时注意将被子或衣服盖在宝宝的胸腹部上，夏天开空调时温度不宜太低，以26~28℃为宜。</p>

<p>止嗝小方法：如果小宝宝打嗝不止，可以用手指轻轻挠下宝宝的脚底板，宝宝会因为突然的刺激而停止了打嗝，或者也可以轻轻挠下宝宝的小嘴巴和小耳朵，这里的神经比较敏感，也可以有效地制止打嗝现象。</p>

      <div class="readall"><a href="/newborn-beat-vibration/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/javascript-style-guide/">JavaScript规范</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年06月20日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#javascript">javascript</a>
      </p>
    </header>
    <div class="post-main">
      <h2><a name='TOC'>目录</a></h2>

<ol>
<li> <a href="#types">类型</a></li>
<li> <a href="#objects">对象</a></li>
<li> <a href="#arrays">数组</a></li>
<li> <a href="#strings">字符串</a></li>
<li> <a href="#functions">函数</a></li>
<li> <a href="#properties">属性</a></li>
<li> <a href="#variables">变量</a></li>
<li> <a href="#conditionals">条件表达式和等号</a></li>
<li> <a href="#blocks">块</a></li>
<li> <a href="#comments">注释</a></li>
<li> <a href="#whitespace">空白</a></li>
<li> <a href="#commas">逗号</a></li>
<li> <a href="#semicolons">分号</a></li>
<li> <a href="#type-coercion">类型转换</a></li>
<li> <a href="#naming-conventions">命名约定</a></li>
<li> <a href="#accessors">存取器</a></li>
<li> <a href="#constructors">构造器</a></li>
<li> <a href="#events">事件</a></li>
<li> <a href="#modules">模块</a></li>
<li> <a href="#jquery">jQuery</a></li>
<li> <a href="#dont-use">不使用</a></li>
</ol>


<h2><a name='types'>类型</a></h2>

<ul>
<li><p><strong>原始值</strong>: 相当于传值</p>

<ul>
<li><code>string</code></li>
<li><code>number</code></li>
<li><code>boolean</code></li>
<li><code>null</code></li>
<li><code>undefined</code></li>
</ul>


<pre><code class="javascript">var foo = 1,
    bar = foo;

bar = 9;

console.log(foo, bar); // =&gt; 1, 9
</code></pre></li>
<li><p><strong>复杂类型</strong>: 相当于传引用</p>

<ul>
<li><code>object</code></li>
<li><code>array</code></li>
<li><code>function</code></li>
</ul>


<pre><code class="javascript">var foo = [1, 2],
    bar = foo;

bar[0] = 9;

console.log(foo[0], bar[0]); // =&gt; 9, 9
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='objects'>对象</a></h2>

<ul>
<li><p>使用字面值创建对象</p>

<pre><code class="javascript">// bad
var item = new Object();

// good
var item = {};
</code></pre></li>
<li><p>不要使用保留字 <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Reserved_Words">reserved words</a> 作为键</p>

<pre><code class="javascript">// bad
var superman = {
  class: 'superhero',
  default: { clark: 'kent' },
  private: true
};

// good
var superman = {
  klass: 'superhero',
  defaults: { clark: 'kent' },
  hidden: true
};
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='arrays'>数组</a></h2>

<ul>
<li><p>使用字面值创建数组</p>

<pre><code class="javascript">// bad
var items = new Array();

// good
var items = [];
</code></pre></li>
<li><p>如果你不知道数组的长度，使用push</p>

<pre><code class="javascript">var someStack = [];


// bad
someStack[someStack.length] = 'abracadabra';

// good
someStack.push('abracadabra');
</code></pre></li>
<li><p>当你需要拷贝数组时使用slice. <a href="http://jsperf.com/converting-arguments-to-an-array/7">jsPerf</a></p>

<pre><code class="javascript">var len = items.length,
    itemsCopy = [],
    i;

// bad
for (i = 0; i &lt; len; i++) {
  itemsCopy[i] = items[i];
}

// good
itemsCopy = items.slice();
</code></pre></li>
<li><p>使用slice将类数组的对象转成数组.</p>

<pre><code class="javascript">function trigger() {
  var args = Array.prototype.slice.call(arguments);
  ...
}
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='strings'>字符串</a></h2>

<ul>
<li><p>对字符串使用单引号 <code>''</code></p>

<pre><code class="javascript">// bad
var name = "Bob Parr";

// good
var name = 'Bob Parr';

// bad
var fullName = "Bob " + this.lastName;

// good
var fullName = 'Bob ' + this.lastName;
</code></pre></li>
<li><p>超过80个字符的字符串应该使用字符串连接换行</p></li>
<li><p>注: 如果过度使用，长字符串连接可能会对性能有影响. <a href="http://jsperf.com/ya-string-concat">jsPerf</a> &amp; <a href="https://github.com/airbnb/javascript/issues/40">Discussion</a></p>

<pre><code class="javascript">// bad
var errorMessage = 'This is a super long error that was thrown because of Batman. When you stop to think about how Batman had anything to do with this, you would get nowhere fast.';

// bad
var errorMessage = 'This is a super long error that was thrown because \
of Batman. When you stop to think about how Batman had anything to do \
with this, you would get nowhere \
fast.';

// good
var errorMessage = 'This is a super long error that was thrown because ' +
  'of Batman. When you stop to think about how Batman had anything to do ' +
  'with this, you would get nowhere fast.';
</code></pre></li>
<li><p>编程时使用join而不是字符串连接来构建字符串，特别是IE: <a href="http://jsperf.com/string-vs-array-concat/2">jsPerf</a>.</p>

<pre><code class="javascript"> var items,
    messages,
    length,
    i;

messages = [{
  state: 'success',
  message: 'This one worked.'
}, {
  state: 'success',
  message: 'This one worked as well.'
}, {
  state: 'error',
  message: 'This one did not work.'
}];

length = messages.length;

// bad
function inbox(messages) {
  items = '&lt;ul&gt;';

  for (i = 0; i &lt; length; i++) {
    items += '&lt;li&gt;' + messages[i].message + '&lt;/li&gt;';
  }

  return items + '&lt;/ul&gt;';
}

// good
function inbox(messages) {
  items = [];

  for (i = 0; i &lt; length; i++) {
    items[i] = messages[i].message;
  }

  return '&lt;ul&gt;&lt;li&gt;' + items.join('&lt;/li&gt;&lt;li&gt;') + '&lt;/li&gt;&lt;/ul&gt;';
}
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='functions'>函数</a></h2>

<ul>
<li><p>函数表达式:</p>

<pre><code class="javascript">// 匿名函数表达式
var anonymous = function() {
  return true;
};

// 有名函数表达式
var named = function named() {
  return true;
};

// 立即调用函数表达式
(function() {
  console.log('Welcome to the Internet. Please follow me.');
})();
</code></pre></li>
<li><p>绝对不要在一个非函数块里声明一个函数，把那个函数赋给一个变量。浏览器允许你这么做，但是它们解析不同。</p></li>
<li><p><strong>注:</strong> ECMA-262定义把<code>块</code>定义为一组语句，函数声明不是一个语句。<a href="http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf#page=97">阅读ECMA-262对这个问题的说明</a>.</p>

<pre><code class="javascript">// bad
if (currentUser) {
  function test() {
    console.log('Nope.');
  }
}

// good
if (currentUser) {
  var test = function test() {
    console.log('Yup.');
  };
}
</code></pre></li>
<li><p>绝对不要把参数命名为 <code>arguments</code>, 这将会逾越函数作用域内传过来的 <code>arguments</code> 对象.</p>

<pre><code class="javascript">// bad
function nope(name, options, arguments) {
  // ...stuff...
}

// good
function yup(name, options, args) {
  // ...stuff...
}
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='properties'>属性</a></h2>

<ul>
<li><p>一般而言，对象中的属性的值是通过点(.)运算符来取值</p>

<pre><code class="javascript">var luke = {
  jedi: true,
  age: 28
};

// bad
var isJedi = luke['jedi'];

// good
var isJedi = luke.jedi;
</code></pre></li>
<li><p>如果一个对象的属性本身就包含点(.)的键(self.ref)，点操作符就无能为力了</p>

<pre><code class="javascript">var ref = {
  id : "reference1",
  func : function(){
    return this.id;
  }
};

var obj = {
  id : "object1",
  "self.ref" : ref
};
</code></pre>

<p>当我们尝试访问obj的”self.ref”这个属性的时候：obj.self.ref，解释器会以为obj中有个名为self的属性，而self对象又有个ref的属性，这样会发生不可预知的错误，一个好的解决方法是使用中括号([])运算符来访问：</p>

<p>  obj["self.ref"].func();</p></li>
</ul>


<p>在这种情况下，中括号操作符成为唯一可行的方式，因此，建议在不知道对象的内部结构的时候(比如要遍历对象来获取某个属性的值)，一定要使用中括号操作符，这样可以避免一些意想不到的bug。</p>

<ul>
<li><p>当使用变量访问属性时使用中括号.</p>

<pre><code class="javascript">var luke = {
  jedi: true,
  age: 28
};

function getProp(prop) {
  return luke[prop];
}

var isJedi = getProp('jedi');
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='variables'>变量</a></h2>

<ul>
<li><p>总是使用 <code>var</code> 来声明变量，如果不这么做将导致产生全局变量，我们要避免污染全局命名空间。</p>

<pre><code class="javascript">// bad
superPower = new SuperPower();

// good
var superPower = new SuperPower();
</code></pre></li>
<li><p>使用一个 <code>var</code> 以及新行声明多个变量，缩进4个空格。</p>

<pre><code class="javascript">// bad
var items = getItems();
var goSportsTeam = true;
var dragonball = 'z';

// good
var items = getItems(),
    goSportsTeam = true,
    dragonball = 'z';
</code></pre></li>
<li><p>最后再声明未赋值的变量，当你想引用之前已赋值变量的时候很有用。</p>

<pre><code class="javascript">// bad
var i, len, dragonball,
    items = getItems(),
    goSportsTeam = true;

// bad
var i, items = getItems(),
    dragonball,
    goSportsTeam = true,
    len;

// good
var items = getItems(),
    goSportsTeam = true,
    dragonball,
    length,
    i;
</code></pre></li>
<li><p>在作用域顶部声明变量，避免变量声明和赋值引起的相关问题。</p>

<pre><code class="javascript">// bad
function() {
  test();
  console.log('doing stuff..');

  //..other stuff..

  var name = getName();

  if (name === 'test') {
    return false;
  }

  return name;
}

// good
function() {
  var name = getName();

  test();
  console.log('doing stuff..');

  //..other stuff..

  if (name === 'test') {
    return false;
  }

  return name;
}

// bad
function() {
  var name = getName();

  if (!arguments.length) {
    return false;
  }

  return true;
}

// good
function() {
  if (!arguments.length) {
    return false;
  }

  var name = getName();

  return true;
}
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='conditionals'>条件表达式和等号</a></h2>

<ul>
<li>适当使用 <code>===</code> 和 <code>!==</code> 以及 <code>==</code> 和 <code>!=</code>.</li>
<li><p>条件表达式的强制类型转换遵循以下规则：</p>

<ul>
<li><strong>对象</strong> 被计算为 <strong>true</strong></li>
<li><strong>Undefined</strong> 被计算为 <strong>false</strong></li>
<li><strong>Null</strong> 被计算为 <strong>false</strong></li>
<li><strong>布尔值</strong> 被计算为 <strong>布尔的值</strong></li>
<li><strong>数字</strong> 如果是 <strong>+0, -0, or NaN</strong> 被计算为 <strong>false</strong> , 否则为 <strong>true</strong></li>
<li><strong>字符串</strong> 如果是空字符串 <code>''</code> 则被计算为 <strong>false</strong>, 否则为 <strong>true</strong></li>
</ul>


<pre><code class="javascript">if ([0]) {
  // true
  // An array is an object, objects evaluate to true
}
</code></pre></li>
<li><p>使用快捷方式.</p>

<pre><code class="javascript">// bad
if (name !== '') {
  // ...stuff...
}

// good
if (name) {
  // ...stuff...
}

// bad
if (collection.length &gt; 0) {
  // ...stuff...
}

// good
if (collection.length) {
  // ...stuff...
}
</code></pre></li>
<li><p>阅读 <a href="http://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/#more-2108">Truth Equality and JavaScript</a> 了解更多</p>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='blocks'>块</a></h2>

<ul>
<li><p>给所有多行的块使用大括号</p>

<pre><code class="javascript">// bad
if (test)
  return false;

// good
if (test) return false;

// good
if (test) {
  return false;
}

// bad
function() { return false; }

// good
function() {
  return false;
}
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='comments'>注释</a></h2>

<ul>
<li><p>使用 <code>/** ... */</code> 进行多行注释，包括描述，指定类型以及参数值和返回值</p>

<pre><code class="javascript">// bad
// make() returns a new element
// based on the passed in tag name
//
// @param &lt;String&gt; tag
// @return &lt;Element&gt; element
function make(tag) {

  // ...stuff...

  return element;
}

// good
/**
 * make() returns a new element
 * based on the passed in tag name
 *
 * @param &lt;String&gt; tag
 * @return &lt;Element&gt; element
 */
function make(tag) {

  // ...stuff...

  return element;
}
</code></pre></li>
<li><p>使用 <code>//</code> 进行单行注释，在评论对象的上面进行单行注释，注释前放一个空行.</p>

<pre><code class="javascript">// bad
var active = true;  // is current tab

// good
// is current tab
var active = true;

// bad
function getType() {
  console.log('fetching type...');
  // set the default type to 'no type'
  var type = this._type || 'no type';

  return type;
}

// good
function getType() {
  console.log('fetching type...');

  // set the default type to 'no type'
  var type = this._type || 'no type';

  return type;
}
</code></pre></li>
<li><p>如果你有一个问题需要重新来看一下或如果你建议一个需要被实现的解决方法的话需要在你的注释前面加上 <code>FIXME</code> 或 <code>TODO</code> 帮助其他人迅速理解</p>

<pre><code class="javascript">function Calculator() {

  // FIXME: shouldn't use a global here
  total = 0;

  return this;
}
</code></pre>

<pre><code class="javascript">function Calculator() {

  // TODO: total should be configurable by an options param
  this.total = 0;

  return this;
}
</code></pre>

<p>  <strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='whitespace'>空白</a></h2>

<ul>
<li><p>多行数组和元素初始化时，最好缩进两个空格。</p>

<pre><code class="javascript">// 对象初始化
var inset = {
  top: 10,
  right: 20,
  bottom: 15,
  left: 12
};

// 数组初始化
this.rows_ = [
  '"Slartibartfast" &lt;fjordmaster@magrathea.com&gt;',
  '"Zaphod Beeblebrox" &lt;theprez@universe.gov&gt;',
  '"Ford Prefect" &lt;ford@theguide.com&gt;',
  '"Arthur Dent" &lt;has.no.tea@gmail.com&gt;',
  '"Marvin the Paranoid Android" &lt;marv@googlemail.com&gt;',
  'the.mice@magrathea.com'
];

// 直接在方法中调用
goog.dom.createDom(goog.dom.TagName.DIV, {
  id: 'foo',
  className: 'some-css-class',
  style: 'display:none'
}, 'Hello, world!');
</code></pre></li>
<li><p>尽可能的将所有的函数参数都写在同一行上，但为了保持增强可读性，如果一行超过了80字符的话可适当的换行，甚至可以每个参数都独立一行，记得格式上的优化，比如缩进4个空格和对齐括号。</p>

<pre><code class="javascript">// Four-space, wrap at 80.  Works with very long function names, survives
// renaming without reindenting, low on space.
goog.foo.bar.doThingThatIsVeryDifficultToExplain = function(
    veryDescriptiveArgumentNumberOne, veryDescriptiveArgumentTwo,
    tableModelEventHandlerProxy, artichokeDescriptorAdapterIterator) {
  // ...
};

// Four-space, one argument per line.  Works with long function names,
// survives renaming, and emphasizes each argument.
goog.foo.bar.doThingThatIsVeryDifficultToExplain = function(
    veryDescriptiveArgumentNumberOne,
    veryDescriptiveArgumentTwo,
    tableModelEventHandlerProxy,
    artichokeDescriptorAdapterIterator) {
  // ...
};

// Parenthesis-aligned indentation, wrap at 80.  Visually groups arguments,
// low on space.
function foo(veryDescriptiveArgumentNumberOne, veryDescriptiveArgumentTwo,
             tableModelEventHandlerProxy, artichokeDescriptorAdapterIterator) {
  // ...
}

// Parenthesis-aligned, one argument per line.  Visually groups and
// emphasizes each individual argument.
function bar(veryDescriptiveArgumentNumberOne,
             veryDescriptiveArgumentTwo,
             tableModelEventHandlerProxy,
             artichokeDescriptorAdapterIterator) {
  // ...
}
</code></pre></li>
<li><p>事实上，除了数组和元素的初始化和传递匿名方法以外，都应该相对于上一行表达式的左对齐缩进4个空格，而不是2个</p>

<pre><code class="javascript">someWonderfulHtml = '' +
                    getEvenMoreHtml(someReallyInterestingValues, moreValues,
                                    evenMoreParams, 'a duck', true, 72,
                                    slightlyMoreMonkeys(0xfff)) +
                    '';

thisIsAVeryLongVariableName =
    hereIsAnEvenLongerOtherFunctionNameThatWillNotFitOnPrevLine();

thisIsAVeryLongVariableName = 'expressionPartOne' + someMethodThatIsLong() +
    thisIsAnEvenLongerOtherFunctionNameThatCannotBeIndentedMore();

someValue = this.foo(
    shortArg,
    'Some really long string arg - this is a pretty common case, actually.',
    shorty2,
    this.bar());

if (searchableCollection(allYourStuff).contains(theStuffYouWant) &amp;&amp;
    !ambientNotification.isActive() &amp;&amp; (client.isAmbientSupported() ||
                                        client.alwaysTryAmbientAnyways())) {
  ambientNotification.activate();
}
</code></pre></li>
<li><p>二元和三元操作符</p>

<pre><code class="javascript">// 能放一行的都放在一行里
var x = a ? b : c; 

// 缩进4个空格
var y = a ?
    longButSimpleOperandB : longButSimpleOperandC;

// 缩进到第一个判断变量位置
var z = a ?
        moreComplicatedB :
        moreComplicatedC;
</code></pre></li>
<li><p>大括号前放一个空格</p>

<pre><code class="javascript">// bad
function test(){
  console.log('test');
}

// good
function test() {
  console.log('test');
}

// bad
dog.set('attr',{
  age: '1 year',
  breed: 'Bernese Mountain Dog'
});

// good
dog.set('attr', {
  age: '1 year',
  breed: 'Bernese Mountain Dog'
});
</code></pre></li>
<li><p>在做长方法链时使用缩进.</p>

<pre><code class="javascript">// bad
$('#items').find('.selected').highlight().end().find('.open').updateCount();

// good
$('#items')
  .find('.selected')
    .highlight()
    .end()
  .find('.open')
    .updateCount();

// bad
var leds = stage.selectAll('.led').data(data).enter().append('svg:svg').class('led', true)
    .attr('width',  (radius + margin) * 2).append('svg:g')
    .attr('transform', 'translate(' + (radius + margin) + ',' + (radius + margin) + ')')
    .call(tron.led);

// good
var leds = stage.selectAll('.led')
    .data(data)
  .enter().append('svg:svg')
    .class('led', true)
    .attr('width',  (radius + margin) * 2)
  .append('svg:g')
    .attr('transform', 'translate(' + (radius + margin) + ',' + (radius + margin) + ')')
    .call(tron.led);
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='commas'>逗号</a></h2>

<ul>
<li><p>不要将逗号放前面</p>

<pre><code class="javascript">// bad
var once
  , upon
  , aTime;

// good
var once,
    upon,
    aTime;

// bad
var hero = {
    firstName: 'Bob'
  , lastName: 'Parr'
  , heroName: 'Mr. Incredible'
  , superPower: 'strength'
};

// good
var hero = {
  firstName: 'Bob',
  lastName: 'Parr',
  heroName: 'Mr. Incredible',
  superPower: 'strength'
};
</code></pre></li>
<li><p>不要加多余的逗号，这可能会在IE下引起错误，同时如果多一个逗号某些ES3的实现会计算多数组的长度。</p>

<pre><code class="javascript">// bad
var hero = {
  firstName: 'Kevin',
  lastName: 'Flynn',
};

var heroes = [
  'Batman',
  'Superman',
];

// good
var hero = {
  firstName: 'Kevin',
  lastName: 'Flynn'
};

var heroes = [
  'Batman',
  'Superman'
];
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='semicolons'>分号</a></h2>

<ul>
<li><p>语句结束一定要加分号</p>

<pre><code class="javascript">// bad
(function() {
  var name = 'Skywalker'
  return name
})()

// good
(function() {
  var name = 'Skywalker';
  return name;
})();

// good
;(function() {
  var name = 'Skywalker';
  return name;
})();
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='type-coercion'>类型转换</a></h2>

<ul>
<li>在语句的开始执行类型转换.</li>
<li><p>字符串:</p>

<pre><code class="javascript">//  =&gt; this.reviewScore = 9;

// bad
var totalScore = this.reviewScore + '';

// good
var totalScore = '' + this.reviewScore;

// bad
var totalScore = '' + this.reviewScore + ' total score';

// good
var totalScore = this.reviewScore + ' total score';
</code></pre></li>
<li><p>对数字使用 <code>parseInt</code> 并且总是带上类型转换的基数.</p>

<pre><code class="javascript">var inputValue = '4';

// bad
var val = new Number(inputValue);

// bad
var val = +inputValue;

// bad
var val = inputValue &gt;&gt; 0;

// bad
var val = parseInt(inputValue);

// good
var val = Number(inputValue);

// good
var val = parseInt(inputValue, 10);

// good
/**
 * parseInt was the reason my code was slow.
 * Bitshifting the String to coerce it to a
 * Number made it a lot faster.
 */
var val = inputValue &gt;&gt; 0;
</code></pre></li>
<li><p>布尔值:</p>

<pre><code class="javascript">var age = 0;

// bad
var hasAge = new Boolean(age);

// good
var hasAge = Boolean(age);

// good
var hasAge = !!age;
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='naming-conventions'>命名约定</a></h2>

<ul>
<li>JavaScript文件命名。所有js文件名，多个单词组成时，采用中划线连接方式，比如说： 账号模型文件 <code>account-model.js</code></li>
<li><p>避免单个字符名，让你的变量名有描述意义。</p>

<pre><code class="javascript">// bad
function q() {
  // ...stuff...
}

// good
function query() {
  // ..stuff..
}
</code></pre></li>
<li><p>当命名对象、函数和实例时使用驼峰命名规则</p>

<pre><code class="javascript">// bad
var OBJEcttsssss = {};
var this_is_my_object = {};
var this-is-my-object = {};
function c() {};
var u = new user({
  name: 'Bob Parr'
});

// good
var thisIsMyObject = {};
function thisIsMyFunction() {};
var user = new User({
  name: 'Bob Parr'
});
</code></pre></li>
<li><p>当命名构造函数或类时使用驼峰式大写</p>

<pre><code class="javascript">// bad
function user(options) {
  this.name = options.name;
}

var bad = new user({
  name: 'nope'
});

// good
function User(options) {
  this.name = options.name;
}

var good = new User({
  name: 'yup'
});
</code></pre></li>
<li><p>命名私有属性时前面加个下划线 <code>_</code></p>

<pre><code class="javascript">// bad
this.__firstName__ = 'Panda';
this.firstName_ = 'Panda';

// good
this._firstName = 'Panda';
</code></pre></li>
<li><p>当保存对 <code>this</code> 的引用时使用 <code>_this</code>.</p>

<pre><code class="javascript">// bad
function() {
  var self = this;
  return function() {
    console.log(self);
  };
}

// bad
function() {
  var that = this;
  return function() {
    console.log(that);
  };
}

// good
function() {
  var _this = this;
  return function() {
    console.log(_this);
  };
}
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='accessors'>存取器</a></h2>

<ul>
<li>属性的存取器函数不是必需的</li>
<li><p>如果你确实有存取器函数的话使用getVal() 和 setVal('hello')</p>

<pre><code class="javascript">// bad
dragon.age();

// good
dragon.getAge();

// bad
dragon.age(25);

// good
dragon.setAge(25);
</code></pre></li>
<li><p>如果属性是布尔值，使用isVal() 或 hasVal()</p>

<pre><code class="javascript">// bad
if (!dragon.age()) {
  return false;
}

// good
if (!dragon.hasAge()) {
  return false;
}
</code></pre></li>
<li><p>可以创建get()和set()函数，但是要保持一致</p>

<pre><code class="javascript">function Jedi(options) {
  options || (options = {});
  var lightsaber = options.lightsaber || 'blue';
  this.set('lightsaber', lightsaber);
}

Jedi.prototype.set = function(key, val) {
  this[key] = val;
};

Jedi.prototype.get = function(key) {
  return this[key];
};
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='constructors'>构造器</a></h2>

<ul>
<li><p>给对象原型分配方法，而不是用一个新的对象覆盖原型，覆盖原型会使继承出现问题。</p>

<pre><code class="javascript">function Jedi() {
  console.log('new jedi');
}

// bad
Jedi.prototype = {
  fight: function fight() {
    console.log('fighting');
  },

  block: function block() {
    console.log('blocking');
  }
};

// good
Jedi.prototype.fight = function fight() {
  console.log('fighting');
};

Jedi.prototype.block = function block() {
  console.log('blocking');
};
</code></pre></li>
<li><p>方法可以返回 <code>this</code> 帮助方法可链。</p>

<pre><code class="javascript">// bad
Jedi.prototype.jump = function() {
  this.jumping = true;
  return true;
};

Jedi.prototype.setHeight = function(height) {
  this.height = height;
};

var luke = new Jedi();
luke.jump(); // =&gt; true
luke.setHeight(20) // =&gt; undefined

// good
Jedi.prototype.jump = function() {
  this.jumping = true;
  return this;
};

Jedi.prototype.setHeight = function(height) {
  this.height = height;
  return this;
};

var luke = new Jedi();

luke.jump()
  .setHeight(20);
</code></pre></li>
<li><p>可以写一个自定义的toString()方法，但是确保它工作正常并且不会有副作用。</p>

<pre><code class="javascript">function Jedi(options) {
  options || (options = {});
  this.name = options.name || 'no name';
}

Jedi.prototype.getName = function getName() {
  return this.name;
};

Jedi.prototype.toString = function toString() {
  return 'Jedi - ' + this.getName();
};
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='events'>事件</a></h2>

<ul>
<li><p>当给事件附加数据时，传入一个哈希而不是原始值，这可以让后面的贡献者加入更多数据到事件数据里而不用找出并更新那个事件的事件处理器</p>

<pre><code class="js">// bad
$(this).trigger('listingUpdated', listing.id);

...

$(this).on('listingUpdated', function(e, listingId) {
  // do something with listingId
});
</code></pre>

<p>更好:</p>

<pre><code class="js">// good
$(this).trigger('listingUpdated', { listingId : listing.id });

...

$(this).on('listingUpdated', function(e, data) {
  // do something with data.listingId
});
</code></pre></li>
</ul>


<p>  <strong><a href="#TOC">[↑]</a></strong></p>

<h2><a name='modules'>模块</a></h2>

<ul>
<li>模块应该以 <code>!</code> 开始，这保证了如果一个有问题的模块忘记包含最后的分号在合并后不会出现错误</li>
<li>这个文件应该以驼峰命名，并在同名文件夹下，同时导出的时候名字一致</li>
<li>加入一个名为noConflict()的方法来设置导出的模块为之前的版本并返回它</li>
<li><p>总是在模块顶部声明 <code>'use strict';</code></p>

<pre><code class="javascript">// fancyInput/fancyInput.js

!function(global) {
  'use strict';

  var previousFancyInput = global.FancyInput;

  function FancyInput(options) {
    this.options = options || {};
  }

  FancyInput.noConflict = function noConflict() {
    global.FancyInput = previousFancyInput;
    return FancyInput;
  };

  global.FancyInput = FancyInput;
}(this);
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='jquery'>jQuery</a></h2>

<ul>
<li><p>缓存jQuery查询</p>

<pre><code class="javascript">// bad
function setSidebar() {
  $('.sidebar').hide();

  // ...stuff...

  $('.sidebar').css({
    'background-color': 'pink'
  });
}

// good
function setSidebar() {
  var $sidebar = $('.sidebar');
  $sidebar.hide();

  // ...stuff...

  $sidebar.css({
    'background-color': 'pink'
  });
}
</code></pre></li>
<li><p>对DOM查询使用级联的 <code>$('.sidebar ul')</code> 或 <code>$('.sidebar ul')</code>，<a href="http://jsperf.com/jquery-find-vs-context-sel/16">jsPerf</a></p></li>
<li><p>对有作用域的jQuery对象查询使用 <code>find</code></p>

<pre><code class="javascript">// bad
$('.sidebar', 'ul').hide();

// bad
$('.sidebar').find('ul').hide();

// good
$('.sidebar ul').hide();

// good
$('.sidebar &gt; ul').hide();

// good (slower)
$sidebar.find('ul');

// good (faster)
$($sidebar[0]).find('ul');
</code></pre>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<h2><a name='dont-use'>不使用</a></h2>

<ul>
<li>生成标签。在 JavaScript 文件中生成标签让内容变得更难查找，更难编辑，性能更差。应该尽量避免这种情况的出现。</li>
<li>eval 非特殊业务， 禁用！！！</li>
<li><p>with 非特殊业务， 禁用！！！</p>

<p><strong><a href="#TOC">[↑]</a></strong></p></li>
</ul>


<hr />

<h3>参考</h3>

<ul>
<li><a href="https://github.com/airbnb/javascript">https://github.com/airbnb/javascript</a></li>
<li><a href="https://github.com/adamlu/javascript-style-guide">https://github.com/adamlu/javascript-style-guide</a></li>
<li><a href="http://chajn.org/jsguide/javascriptguide.html">http://chajn.org/jsguide/javascriptguide.html</a></li>
</ul>


      <div class="readall"><a href="/javascript-style-guide/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="pagination">
  
  
  <a class="pagination-item newer" href="/page/5"><i class="fa fa-arrow-left"></i>&nbsp;&nbsp;上一页</a>
  
    

    
      <a href="/">1</a>
      

    
      
      <a href="/page/2">2</a>
      
    
      
      <a href="/page/3">3</a>
      
    
      
      <a href="/page/4">4</a>
      
    
      
      <a href="/page/5">5</a>
      
    
      
      <span class="current-page">6</span>
      
    
      
      <a href="/page/7">7</a>
      
    
      
      <a href="/page/8">8</a>
      
    
      
      <a href="/page/9">9</a>
      
    
      
      <a href="/page/10">10</a>
      
    
      
      <a href="/page/11">11</a>
      
    
      
      <a href="/page/12">12</a>
      
    
      
      <a href="/page/13">13</a>
      
    
      
      <a href="/page/14">14</a>
      
    
      
      <a href="/page/15">15</a>
      
    
      
      <a href="/page/16">16</a>
      
    
      
      <a href="/page/17">17</a>
      
    
      
      <a href="/page/18">18</a>
      
    
      
      <a href="/page/19">19</a>
      
    
      
      <a href="/page/20">20</a>
      
    
      
      <a href="/page/21">21</a>
      
    
      
      <a href="/page/22">22</a>
      
    
  (共129篇)

  
  <a class="pagination-item older" href="/page/7">下一页&nbsp;&nbsp;<i class="fa fa-arrow-right"></i></a>
  
</div>

    <footer>Copyright&nbsp;&copy;&nbsp;2014 <a href="http://www.waylau.com">Way Lau's Blog</a><br/><i class="fa fa-cogs" style="color:blueviolet;">&nbsp;</i>Powered by <a href="https://github.com/waylau/jekyll-theme-blog" target="_blank">jekyll-theme-blog</a></footer>
    </div>


  </div>    
  <div id="top"><a id="rocket" href="javascript:;" title="返回顶部"><i></i></a></div>
  


</body>
</html>