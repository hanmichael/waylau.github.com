<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <meta name="description" content="Way Lau's Personal Site | www.waylau.com">
  <meta name="author" content="Way Lau">
  <meta name="keywords" content="Way Lau's Personal Site | www.waylau.com, Way Lau's Blog, 技术改变世界！, Way Lau">
  <title>Way Lau's Personal Site | www.waylau.com</title>
  <link rel="canonical" href="http://www.waylau.com">
  <link rel="icon" href="/res/img/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/res/img/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/res/css/public.css">
  <link rel="stylesheet" href="/res/css/light.css">
  <script src="/res/js/light.js"></script>
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?28cf5fa48a599e39c5cc760931de942f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>
</head>
<body>
  <div id="blog">
    <div class="sidebar">
  <div class="profilepic">
    <a href="/"><img src="/res/img/icon.png" alt="logo"></img></a>
  </div>
  <h1 class="title"><a href="/">Way Lau's Blog</a></h1>
  <h2 class="sub-title">技术改变世界！</h2>
  <nav id="nav">
    <ul>
    
      <li><a href="/timing/"><i class="fa fa-clock-o"></i>&nbsp;时光机</a></li>
    
      <li><a href="/categories/"><i class="fa fa-tags"></i>&nbsp;分类</a></li>
    
      <li><a href="/tags/"><i class="fa fa-bookmark"></i>&nbsp;标签</a></li>
    
      <li><a href="http://labs.waylau.com/"><i class="fa fa-building"></i>&nbsp;示例</a></li>
    
      <li><a href="/books/"><i class="fa fa-book"></i>&nbsp;书籍</a></li>
    
      <li><a href="/about/"><i class="fa fa-paper-plane-o"></i>&nbsp;关于</a></li>
    
    </ul>
  </nav>  
  <nav id="sub-nav">
    <a class="weibo " href="http://weibo.com/waylau521" title="新浪微博" target="_blank"><i class="fa fa-weibo "></i></a>
    <a class="github" href="https://github.com/waylau" title="GitHub" target="_blank"><i class="fa fa-github fa-2x"></i></a>
    <a class="twitter" href="https://twitter.com/waylau521" title="Twitter" target="_blank"><i class="fa fa-twitter fa-2x"></i></a>
    <a class="rss" href="/page/feed.xml" title="RSS订阅" target="_blank"><i class="fa fa-rss"></i></a>
  </nav>
  <div id="license">
    <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank" title="本站所有作品采用：&#10;知识共享《署名 非商业性使用 相同方式共享 3.0》&#10;进行许可" >
    <img alt="License" height="31" width="88" src="/res/img/license.png" /></a>
  </div>
</div>
    <div class="main">
    
<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/java-split-dot/">Java版本号处理-split 点号 split(".")</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年09月24日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#java">java</a>
      </p>
    </header>
    <div class="post-main">
      <p>近期在做一个版本号的判断，在使用 Java split() 方法时，希望把版本号中的数字组成数组。很自然的，我用了 split(".") 来分割成数组，结果不行。</p>

<pre><code>String v = "1.0.1";
String[] vs = v.split(".");

int len = vs.length;

for(int i = 0; i&lt;len; i ++){
    System.out.println(vs[i]);
}
</code></pre>

<p>后查 API，得知 split　的参数是　String regex
代表的是一个正则表达式。如果是正则中的特殊字符，就不能了。点正好是一个特殊字符。如下方式解决：</p>

<pre><code>String v = "1.0.1";
String[] vs = v.split("[.]");

int len = vs.length;

for(int i = 0; i&lt;len; i ++){
    System.out.println(vs[i]);
}
</code></pre>

      <div class="readall"><a href="/java-split-dot/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/label-inprove-input-user-experience/">HTML &lt;label&gt; 提升&lt;input&gt;用户体验</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年09月17日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#html">html</a>
      </p>
    </header>
    <div class="post-main">
      <p>如果没有 &lt;label&gt; 当然也能显示 &lt;input&gt; 的本文，
比如</p>

<pre><code>&lt;input type="radio" name="status" checked="true"  value="0"/&gt;改造前
&lt;input type="radio" name="status" value="2"/&gt;改造后
&lt;input type="checkbox" name="status1" value="3"/&gt;www.waylau.com
</code></pre>

<p>点击组件上的文本不会有任何效果</p>

<p><input type="radio" name="status" checked="true"  value="0"/>改造前
<input type="radio" name="status" value="2"/>改造后
<input type="checkbox" name="status1" value="3"/>www.waylau.com</p>

<p>但是，加上  &lt;label&gt; 后立马就不同了，可以点击文本来选中组件</p>

<pre><code>&lt;label&gt;&lt;input type="radio" name="status2" checked="true"  value="0"/&gt;改造前&lt;/label&gt;
&lt;label&gt;&lt;input type="radio" name="status2" value="2"/&gt;改造后&lt;/label&gt;
&lt;label&gt;&lt;input type="checkbox" name="status3" value="3"/&gt;www.waylau.com&lt;/label&gt;
</code></pre>

<p><label><input type="radio" name="status2" checked="true"  value="0"/>改造前</label>
<label><input type="radio" name="status2" value="2"/>改造后</label>
<label><input type="checkbox" name="status3" value="3"/>www.waylau.com
</label></p>

      <div class="readall"><a href="/label-inprove-input-user-experience/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/html-mask-display-toolbar/">HTML 遮罩显示工具栏</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年09月16日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#html">html</a>
      </p>
    </header>
    <div class="post-main">
      <h1>需求</h1>

<p>想要实现一个照片，鼠标移到照片上，可以显示编辑该照片的工具栏</p>

<h1>实现</h1>

<h2>整体布局</h2>

<pre><code>  &lt;div id="photo_id" class="photo_contarner" onmouseover="handlerIn( event )" onmouseout="handlerOut( event )"&gt;
        &lt;a href="javascript:void(0);" onclick="alert('我是底图');" &gt;
            &lt;img  src="img/wl_white.png"  /&gt;
            &lt;div class="toolbar" name="toolbar" id="toolbar"&gt;
                &lt;a href="javascript:void(0);" class="toolbar_edit" onclick="alert('编辑一把');"  &gt;
                &lt;/a&gt;
                &lt;a href="javascript:void(0);" class="toolbar_delete" onclick="alert('删了吧');" &gt;
                &lt;/a&gt;
            &lt;/div&gt;
        &lt;/a&gt;
    &lt;/div&gt;
</code></pre>

<p>一个照片，上面加一个 div 工具栏（toolbar）里面有两个按钮</p>

<h2>样式</h2>

<pre><code>.photo_contarner {
    width: 128px;height: 128px;
    margin: 20px;
    float: left;
    position:relative;
}

.photo_contarner img{
    width: 128px;height: 128px;
    border: 0
}
.toolbar {
    position:absolute;
    width: 48px;
    height: 24px;
    top: 0px;
    right: 0px;
    z-index:3;
    background-color: gray;
}
.toolbar_edit {
    background:url(../img/edit_24.png);
}
.toolbar_delete {
    background:url(../img/remove_24.png);
}
.toolbar_edit,.toolbar_delete{
    width:24px;height:24px;float: left;
}
</code></pre>

<p><a href="http://s1288.photobucket.com/user/waylau/media/waylau%20blog/bar002_zps5a21d9df.jpg.html" target="_blank"><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/bar002_zps5a21d9df.jpg" border="0" alt=" photo bar002_zps5a21d9df.jpg"/></a></p>

<p>先看下整体效果，工具栏在照片上的右上角，工具栏包含两个图标。关键点： <code>z-index:3</code> 该属性设置元素的堆叠顺序。拥有更高堆叠顺序的元素总是会处于堆叠顺序较低的元素的前面。</p>

<p>默认工具栏为隐藏 .toolbar 的样式中添加</p>

<pre><code>display:none;
</code></pre>

<h2>事件</h2>

<p>鼠标移入移出事件，移入为显示，移出为隐藏</p>

<p>var handlerIn = function( event ){
    document.getElementById('toolbar').style.display ='block';
};</p>

<p>var handlerOut = function( event ){
    document.getElementById('toolbar').style.display ='none';
};</p>

<p>移入
<a href="http://s1288.photobucket.com/user/waylau/media/waylau%20blog/bar002_zps5a21d9df.jpg.html" target="_blank"><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/bar002_zps5a21d9df.jpg" border="0" alt=" photo bar002_zps5a21d9df.jpg"/></a></p>

<p>移出
<a href="http://s1288.photobucket.com/user/waylau/media/waylau%20blog/bar001_zps018d0a02.jpg.html" target="_blank"><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/bar001_zps018d0a02.jpg" border="0" alt=" photo bar001_zps018d0a02.jpg"/></a></p>

<p>点击工具栏
<a href="http://s1288.photobucket.com/user/waylau/media/waylau%20blog/bar003_zpsf0a8f537.jpg.html" target="_blank"><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/bar003_zpsf0a8f537.jpg" border="0" alt=" photo bar003_zpsf0a8f537.jpg"/></a></p>

<h1>源码</h1>

<p>HTML 遮罩显示工具栏<a href="https://github.com/waylau/html-css-demo/blob/master/MaskDisplay.html">源码</a></p>

      <div class="readall"><a href="/html-mask-display-toolbar/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/build-angularjs-app-with-yeoman-in-windows/">在Windows环境下用Yeoman构建AngularJS项目</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年08月27日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#yeomanangularjs">yeomanangularjs</a>
      </p>
    </header>
    <div class="post-main">
      <h1><a name='TOC'>目录</a></h1>

<ol>
<li><a href="#%E8%AE%A4%E8%AF%86Yeoman">认识Yeoman</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AE%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83">设置开发环境</a></li>
<li><a href="#%E5%AE%89%E8%A3%85Yeoman%E7%94%9F%E6%88%90%E5%99%A8">安装 Yeoman 生成器</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E8%84%9A%E6%89%8B%E6%9E%B6">使用脚手架</a></li>
<li><a href="#%E9%A2%84%E8%A7%88Yeoman%E7%94%9F%E6%88%90%E7%9A%84%E5%BA%94%E7%94%A8">预览 Yeoman 生成的应用</a></li>
<li><a href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E9%A2%84%E8%A7%88%E5%BA%94%E7%94%A8">浏览器中预览应用</a></li>
<li><a href="#%E5%86%99%E4%B8%80%E4%B8%AA%E8%87%AA%E5%B7%B1%E7%9A%84AngularJS%E5%BA%94%E7%94%A8">写一个自己的 AngularJS 应用</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8Bower%E5%AE%89%E8%A3%85%E5%8C%85">使用 Bower 安装包</a></li>
<li><a href="#%E7%94%A8Karma%E5%92%8CJasmine%E8%BF%9B%E8%A1%8C%E6%B5%8B%E8%AF%95">用 Karma 和 Jasmine 进行测试</a></li>
<li> <a href="#%E5%87%86%E5%A4%87%E5%8F%91%E5%B8%83%E4%BA%A7%E5%93%81">准备发布产品</a></li>
<li> <a href="#%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8%E6%9D%A5%E6%8C%81%E4%B9%85%E5%8C%96%E6%95%B0%E6%8D%AE">本地存储来持久化数据</a></li>
<li> <a href="#%E6%80%BB%E7%BB%93">总结</a></li>
<li> <a href="#%E5%8F%82%E8%80%83">参考</a></li>
<li> <a href="#%E6%BA%90%E7%A0%81">源码</a></li>
</ol>


<p>本文将通过 Yeoman 创建一个 AngularJS 应用，同时 也能感受到 <a href="http://gruntjs.com/">Grunt</a> 和 <a href="http://bower.io/">Bower</a> 的功能。</p>

<h1><a name='认识Yeoman'>认识Yeoman</a></h1>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/meet_zpsafcce7c4.jpg" alt="认识Yeoman" /></p>

<p>Yeoman 是一位戴帽子、立意奇颖的人。</p>

<p>Yeoman 是一套工作流程。</p>

<p>Yeoman 是Web 应用开发脚手架。</p>

<p>通过很少的命令，就能给你整个应用或者独立的模块生成模板代码，比如控制器或者模型。Yeoman 可以启动预览 Web 服务器，观察文件，如果被编辑，就会重新加载的变化和编译你的 <a href="http://sass-lang.com/">Sass</a> 。 Yeoman 也可以运行单元测试，最小化代码，优化图像等等。</p>

<p>Yeoman 致力于提高你在构建web应用时的生产力和舒适度，优化工作流程。用到三种核心工具：yo（脚手架工具），grunt（构建工具），bower（包管理工具）。</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/meet2_zpsb9a9cb73.jpg" alt="Yeoman流程" /></p>

<p><a href="http://yeoman.io/">Yo</a> 一个用于构建特定框架的生态系统的代码工具，称之为生成器(generator)。使用 yo 就能提前处理那些些繁琐的任务。</p>

<p><a href="http://gruntjs.com/">Grunt</a> 被用来构建，预览以及测试你的项目，感谢来自那些由 Yeoman 团队和 <a href="https://github.com/gruntjs/grunt-contrib">grunt-contrib</a> 所管理的任务的帮助。</p>

<p><a href="http://bower.io/">Bower</a> 被用来进行依赖管理，所以你不再需要手动的下载和管理你的脚本了。</p>

<p>你能使用 <a href="http://npmjs.org/">npm</a> 安装生成器，现在可用的生成器数量已经超过了 <a href="http://yeoman.io/generators/">1000+个生成器</a>，这其中很多都是由开源社区编写的。比较受欢迎的有 <a href="https://github.com/yeoman/generator-angular">generator-angular</a>、 <a href="https://github.com/yeoman/generator-backbone">generator-backbone</a>、 <a href="https://github.com/yeoman/generator-ember">generator-ember</a>。</p>

<h2>为何用 Yeoman</h2>

<p>Yeoman 是一个强大的有想法的客户端栈，包括那些能帮助开发者快速构建漂亮web应用的工具和框架。我们关注于提供所有应用上手所需要的东西，尽量免去所有手动安装的麻烦。</p>

<p>采用了可以扩展的模块化架构，我们利用来自一些开源社区的成功经验和教训来确保开发者使用的栈尽可能的智能。</p>

<p>作为一个良好的文档和深思熟虑的构建过程的坚定的拥趸，Yeoman 包括了对代码规范检测，测试，最小化以及更多其他功能的支持，所以开发者可以专注于解决方案而不用担心这些零散的东西。</p>

<p>Yeoman 是快速的，高性能的并且经过优化可以很好的在现代浏览器中工作。</p>

<p><a href="#TOC">[↑]</a></p>

<h1><a name='设置开发环境'>设置开发环境</a></h1>

<p>大部分通过命令行形式与 Yeoman 相互作用。支持MAC、Linux、Windows等名称。本文以 Windows 为例，用<code>cmd.exe</code></p>

<h2>安装前提</h2>

<p>安装 Yeoman, 先要安装:</p>

<ul>
<li>Node.js v0.10.x+ ：<a href="http://nodejs.org/dist/v0.10.31/x64/node-v0.10.31-x64.msi">下载</a></li>
<li>npm (在 Node 中做了捆绑,无需另外安装) v1.4.3+</li>
<li>git :<a href="https://www.kernel.org/pub/software/scm/git/">下载</a></li>
</ul>


<p>确认安装成功：</p>

<blockquote><p>$ node --version &amp;&amp; npm --version</p></blockquote>

<p><img src="http://image16.poco.cn/mypoco/myphoto/20140827/19/17476175320140827194357088.jpg?506x127_120" alt="node" /></p>

<blockquote><p>$ git --version</p></blockquote>

<p><img src="http://image16.poco.cn/mypoco/myphoto/20140827/19/17476175320140827194420054.jpg?396x87_12" alt="git" /></p>

<h2>安装 Yeoman 工具集</h2>

<p>该工具集包括了 Yeoman、Bower、Grunt</p>

<blockquote><p>$ npm install --global yo</p></blockquote>

<p>完成后出现如下界面：</p>

<p><img src="http://image16.poco.cn/mypoco/myphoto/20140827/19/17476175320140827194437090.jpg?667x547_120" alt="yo" /></p>

<p>确认安装成功</p>

<blockquote><p>$ yo --version &amp;&amp; bower --version &amp;&amp; grunt --version</p></blockquote>

<p>出现</p>

<blockquote><p>C:\Users\Administrator>yo --version &amp;&amp; bower --version &amp;&amp; grunt --version
[?] ==========================================================================
We're constantly looking for ways to make yo better!
May we anonymously report usage statistics to improve the tool over time?
More info: https://github.com/yeoman/insight &amp; http://yeoman.io
==========================================================================: (Y/n
)</p></blockquote>

<p>意思是说，是否愿意上报使用统计。输入 y 或者 n 或者任意字符，继续</p>

<p>则会显示三个版本信息，分别是 Yeoman、Bower、Grunt CLI 的。说明yeoman 安装成功。</p>

<p><img src="http://image16.poco.cn/mypoco/myphoto/20140828/14/17476175320140828140802098.jpg?642x189_120" alt="yo-version" /></p>

<p><a href="#TOC">[↑]</a></p>

<h1><a name='安装Yeoman生成器'>安装 Yeoman 生成器</a></h1>

<p>在传统的 Web 开发流程，你将需要花大量的时间给你的 webapp 建立样板代码，下载依赖，并手动创建应用的文件夹结构。现在这一切交给 Yeoman 生成器来做！下面安装 AngularJS 的生成器</p>

<h2>安装 AngularJS 的生成器</h2>

<p>Yeoman 生成器使用  <a href="https://www.npmjs.org/">npm</a> 命令,现在可用的生成器数量已经超过了 <a href="http://yeoman.io/generators/">1000+个生成器</a>，这其中很多都是由开源社区编写的</p>

<p>安装 <a href="https://www.npmjs.org/package/generator-angular">generator-angular</a> 生成器</p>

<blockquote><p>$ npm install --global generator-angular@0.9.5</p></blockquote>

<p><code>0.9.5</code> 指版本号</p>

<p><a href="#TOC">[↑]</a></p>

<h1><a name='使用脚手架'>使用脚手架</a></h1>

<p>Yeoman 脚手架,会根据你的具体配置要求自动生产应用文件。</p>

<h2>创建项目文件夹</h2>

<p>在你的工作区间（可以是任意目录）创建项目文件夹 <code>mytodo</code>(可以是任意项目名称)，并且切换到该应用文件夹目录下</p>

<blockquote><p>$ mkdir mytodo &amp;&amp; cd mytodo</p></blockquote>

<p>本例的工作目录是<code>D:\workspaceNG</code></p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/yo-04_zps5032bdf4.jpg" alt="工作目录" /></p>

<h2>使用生成器</h2>

<p>查看所有的生成器</p>

<blockquote><p>$ yo</p></blockquote>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/yo-05_zpsa643f09d.jpg" alt="yo" />
键盘上下键选中 angular 的生成器，点击 <code>enter</code> 键</p>

<p>当你熟悉了你的生成器之后，可以使用快速命令</p>

<blockquote><p>$ yo angular</p></blockquote>

<h2>配置生成器</h2>

<p>一些生成器也会提供一些有共同开发库（common developer libraries）的可选配置来定制你的应用，能够加速初始化你的开发环境。 generator-angular 会询问你需不需要使用 <a href="http://sass-lang.com/">Sass</a> (使用 <a href="http://compass-style.org/">Compass</a>)或者<a href="http://getbootstrap.com/">Twitter Bootstrap</a>，使用’n'和’y'进行选择。本例不要用 Sass ，而选用 Bootstrap</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/yo-06_zpsbb47e1cf.jpg" alt="Bootstrap" /></p>

<p>接着选用 Angular 模块。你可以使用空格键来取消项目。(当你在试用空格的效果时，确保所有的模块都被标记为绿色)。我们选用默认值就可以（即全部选中）。</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/yo-07_zps3470357f.jpg" alt="Angular 模块" /></p>

<p>点击 <code>enter</code> 键，此时将会自动生成代码</p>

<p><a href="#TOC">[↑]</a></p>

<h1><a name='预览Yeoman生成的应用'>预览 Yeoman 生成的应用</a></h1>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/yo-08_zpsca5cd70f.jpg" alt="Yeoman 生成的应用" /></p>

<p>打开’mytodo’目录，会看到下面的文件结构：</p>

<ul>
<li><strong>app</strong>: Web应用的父级目录。

<ul>
<li><strong>index.html</strong>:  Angular应用的基准HTML文件</li>
<li><strong>404.html</strong>, <strong>favicon.ico</strong>, and <strong>robots.txt</strong>: 通用的Web文件，Yeoman已经将它创建出来了，你不需要再手动去创建</li>
<li><strong>scripts</strong>: JS 文件夹

<ul>
<li><strong>app.js</strong>: Angular 主程序</li>
<li><strong>controllers</strong>: Angular 控制器</li>
</ul>
</li>
<li><strong>styles</strong>: CSS 文件夹</li>
<li><strong>views</strong>: Angular模板</li>
</ul>
</li>
<li><p><strong>bower_components</strong>, <strong>bower.json</strong>:存放项目相关的JavaScript或Web依赖，由bower安装的</p></li>
<li><p><strong>Gruntfile.js</strong>, <strong>package.json</strong>, and <strong>node_modules</strong>: Grunt需要使用的依赖以及配置</p></li>
<li><p><strong>test</strong>: 测试框架以及针对这个项目的单元测试，包括了为控制器写的样板测试（boilerplate tests）</p></li>
</ul>


<p>另外：示例中的所有 <code>js</code> 代码都使用了严格模式，有关严格模式的内容可以参考<a href="http://www.waylau.com/javascript-use-strict-mode/">http://www.waylau.com/javascript-use-strict-mode/</a></p>

<p><a href="#TOC">[↑]</a></p>

<h1><a name='浏览器中预览应用'>浏览器中预览应用</a></h1>

<p>无需在你的电脑中安装 web 服务器，Yeoman 已经包含了。</p>

<h2>启动服务</h2>

<blockquote><p>$ grunt serve</p></blockquote>

<p>浏览器访问 <a href="localhost:9000">localhost:9000</a> (或者 127.0.0.1:9000 )</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/grunt-01_zps006769aa.jpg" alt="grunt serve" /></p>

<h2>关闭服务</h2>

<p>使用 <code>Ctrl+C</code> 键</p>

<h2>查看文件</h2>

<p>现在可以打开编辑器开始更改应用。每次保存更改后，浏览器将会自动刷新，就是说你是不需要手动再刷新浏览器了。这个被称作<code>live reloading</code>，这提供了一个很好的方式来实时查看应用的状态。它是通过一系列的 Grunt 任务(配置在 <code>Gruntfile.js</code> )来监视你的文件的更改情况，一旦发现文件被改动了，<code>live reloading</code>就会自动刷新应用。在这个例子中，我们编辑了 <code>main.html</code>，通过 <code>live reloading</code> 我们从下面的状态：</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/grunt-02_zps7baacb9d.jpg" alt="旧状态" /></p>

<p>马上到了这个状态：</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/grunt-03_zps095fca5f.jpg" alt="新" /></p>

<p>(PS:在各个浏览器测试中，老旧的浏览器可能不会自动刷新页面，比如IE9)</p>

<p><a href="#TOC">[↑]</a></p>

<h1><a name='写一个自己的AngularJS应用'>写一个自己的 AngularJS 应用</a></h1>

<p>这里 Yeoman 提供最终的<a href="http://yeoman.io/codelab.html#source-files">项目源码</a>,如果打不开(国外网站，可能被墙)，也可以访问笔者的项目源码<a href="https://github.com/waylau/mytodo">https://github.com/waylau/mytodo</a></p>

<h2>创建新模板展现 Todo 列表</h2>

<p>打开<code>views/main.html</code></p>

<p>除了 <code>&lt;div class="jumbotron"&gt;</code> 其他标签都清除了。并把 <code>jumbotron</code> 改名为 <code>container</code>,最终代码是这样的</p>

<pre><code>&lt;div class="container"&gt;
&lt;/div&gt;
</code></pre>

<p>打开 <code>scripts/controllers/main.js</code></p>

<p>代码修改为，<code>todos</code> 为 列表容器：</p>

<pre><code>'use strict';

angular.module('mytodoApp')
  .controller('MainCtrl', function ($scope) {
    $scope.todos = ['Item 1', 'Item 2', 'Item 3'];
  });
</code></pre>

<p>修改 <code>main.html</code>，将<code>todos</code> 中的项目以<code>input</code>标签形式输出：</p>

<pre><code>&lt;div class="container"&gt;
  &lt;h2&gt;My todos&lt;/h2&gt;
  &lt;p class="form-group" ng-repeat="todo in todos"&gt;
    &lt;input type="text" ng-model="todo" class="form-control"&gt;
  &lt;/p&gt;
&lt;/div&gt;
</code></pre>

<p>在 <code>p</code> 标签中的 <a href="http://docs.angularjs.org/api/ng.directive:ngRepeat">ng-repeat</a> 属性是一个 Angular 指令 (<a href="http://docs.angularjs.org/guide/directive">directive</a>)，当获取到一个集合(collection)中的项时，它将项实例化。</p>

<p>在我们的例子中，你可以想象一下，每个 p 标签和它的内容都带着这个’ng-repeat‘属性。对于每个在todos数组中的项，Angular都会生成一组新的 <code>&lt;p&gt;&lt;input&gt;&lt;/p&gt;</code></p>

<p><a href="http://docs.angularjs.org/api/ng.directive:ngModel">ng-model</a> 是另一个 Angular 指令，它主要是和<code>input</code>、<code>select</code>、<code>textarea</code> 标签和一些自定义控件一起使用，达到<a href="http://docs.angularjs.org/guide/databinding">数据双向绑定</a>的效果。在我们的例子中，它用于显示一系列带有<code>todo</code>的值的文本输入域。</p>

<p>在浏览器中查看ng-repeat和ng-model动态变化的效果。在保存之前，我们的应用看起来应该是下图这个样子的：</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/todo_zps5ca53abc.jpg" alt="todos" /></p>

<p>更新 <code>$scope.todos</code>,增加第四个项目</p>

<pre><code>$scope.todos = ['Item 1', 'Item 2', 'Item 3', 'Item 4'];
</code></pre>

<p>通过 <code>live reloading</code> 我们看到页面新的项目出现了。移除第四个项目，则页面也移除了。</p>

<h2>增加一个 todo 项目</h2>

<p>下面将实现添加一个 <code>todo</code> 到列表中，修改 <code>main.html</code>：在<code>h2</code> 元素和 <code>p</code> 元素之间加上一个 <code>form</code> 元素。现在你的 <code>main.html</code> 应该是下面这个样子：</p>

<pre><code>&lt;div class="container"&gt;
  &lt;h2&gt;My todos&lt;/h2&gt;

  &lt;!-- Todos input --&gt;
  &lt;form role="form" ng-submit="addTodo()"&gt;
    &lt;div class="row"&gt;
      &lt;div class="input-group"&gt;
        &lt;input type="text" ng-model="todo" placeholder="What needs to be done?" class="form-control"&gt;
        &lt;span class="input-group-btn"&gt;
          &lt;input type="submit" class="btn btn-primary" value="Add"&gt;
        &lt;/span&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/form&gt;
  &lt;p&gt;&lt;/p&gt;

  &lt;!-- Todos list --&gt;
  &lt;p class="form-group" ng-repeat="todo in todos"&gt;
    &lt;input type="text" ng-model="todo" class="form-control"&gt;
  &lt;/p&gt;
&lt;/div&gt;
</code></pre>

<p>在页面顶部增加了一个带有提交按钮的表单。这个表单使用了另一个Angular指令 <a href="http://docs.angularjs.org/api/ng.directive:ngSubmit">ng-submit</a>。返回查看你的浏览器，现在的UI应该是下面这个这样子的：</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/todo-01_zpsd8034d7b.jpg" alt="todo add" /></p>

<p>点击 <code>Add</code> 按钮，啥事都不会发生，现在要做下改动：</p>

<p><code>ng-submit</code> 是将一个 Angular 表达式绑定到表单的 <code>onsubmit</code> 事件上。如果 <code>form</code> 上没有绑定任何动作，它也会阻止浏览器的默认行为。在我们的例子中，我们添加了一个 <code>addTodo()</code> 表达式。</p>

<p>下面的 <code>addTodo</code> 方法是实现将新增的 <code>todo</code> 项目添加入已有的事项列表中，然后清空顶部的文本输入域：</p>

<pre><code>$scope.addTodo = function () {
  $scope.todos.push($scope.todo);
  $scope.todo = '';
};
</code></pre>

<p>将 <code>addTodo()</code> 方法加到 <code>main.js</code> 的 <code>MainCtrl</code> 控制器的定义中，现在你的控制器代码应该如下所示：</p>

<pre><code>'use strict';

angular.module('mytodoApp')
  .controller('MainCtrl', function ($scope) {
    $scope.todos = ['Item 1', 'Item 2', 'Item 3'];
    $scope.addTodo = function () {
      $scope.todos.push($scope.todo);
      $scope.todo = '';
    };
  });
</code></pre>

<p>添加一个文本进去看下效果：</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/todo-02_zps6d7c0e8c.jpg" alt="add a item" /></p>

<p>注意：本例只是一个简单的演示，未对输入做验证</p>

<h2>移除一个 todo　项目</h2>

<p>现在来添加一个移除 todo　项目的功能，先在列表中每一个 todo　项目的边上加上一个 <code>移除</code> 按钮。回到我们的视图模板（main.html），在现有的 <code>ng-repeat</code> 指令上添加一个按钮。然后确认我们的输入框和移除按钮是对齐的，将 <code>p</code> 标签的 <code>class</code> 从 <code>form-group</code> 改成 <code>input-group</code>。 再改动之前代码是这样的：</p>

<pre><code>&lt;!-- Todos list --&gt;
&lt;p class="input-group" ng-repeat="todo in todos"&gt;
  &lt;input type="text" ng-model="todo" class="form-control"&gt;
  &lt;span class="input-group-btn"&gt;
    &lt;button class="btn btn-danger" ng-click="removeTodo($index)" aria-label="Remove"&gt;X&lt;/button&gt;
  &lt;/span&gt;
&lt;/p&gt;
</code></pre>

<p>回到浏览器，现在你的应用看起来有点靓了哦！</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/todo-03_zps8f5ffa11.jpg" alt="remove a item" /></p>

<p>上面的代码中使用了一个新的 Angular 指令 <a href="http://docs.angularjs.org/api/ng.directive:ngClick">ng-click</a>。可以用 ng-click 来控制元素被点击时的行为。在这个例子中，我们调用了<code>removeTodo()</code> 方法并将 <code>$index</code> 传入了这个方法。</p>

<p><code>$index</code> 的值是当前 <code>todo</code> 项在整个 <code>todos</code> 数组中的位置的索引值。举个例子，数组中的第一项的索引值是0，那么0就会被传入<code>removeTodo()</code>；类似的，在一个五项的Todo列表中，最后一项的索引值是4,4就会被传入 <code>removeTodo()</code>。</p>

<p>现在我们来实现这个 <code>removeTodo()</code> 方法，下面的代码是使用 <code>JavaScript</code> 中的 <code>splice</code> 方法将要移除的项通过给定的 <code>$index</code> 值从数组中移除：</p>

<pre><code>$scope.removeTodo = function (index) {
  $scope.todos.splice(index, 1);
};
</code></pre>

<p>完整的 <code>main.js</code> 代码如下:</p>

<pre><code>'use strict';

angular.module('mytodoApp')
  .controller('MainCtrl', function ($scope) {
    $scope.todos = ['Item 1', 'Item 2', 'Item 3'];
    $scope.addTodo = function () {
      $scope.todos.push($scope.todo);
      $scope.todo = '';
    };
    $scope.removeTodo = function (index) {
      $scope.todos.splice(index, 1);
    };
  });
</code></pre>

<p>回到浏览器，现在你可以点击移除按钮将一个 todo 项从列表中移除。有点屌！</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/todo-04_zps4d21502a.jpg" alt="remve item" /></p>

<p>虽然我们可以添加和移除Todo事项，但是这些记录都不能永久地保存。一旦页面被刷新了，更改的记录都会不见了，又恢复到 <code>main.js</code> 中设置的<code>todo</code> 数组的值。不过不要担心这个问题，之后会讲到更多关于使用 <code>Bower</code> 安装包，这个问题就会被解决的。</p>

<p><a href="#TOC">[↑]</a></p>

<h1><a name='使用Bower安装包'>使用 Bower 安装包</a></h1>

<p>现在给我们的列表添加一些排列方式来合理地显示它。所以我们要使用<code>Bower</code> 安装了一个 Angular 组件，叫做<a href="https://github.com/angular-ui/ui-sortable">AngularUI Sortable module</a>。</p>

<h2>列出已经安装的包</h2>

<p>用下面的指令我们可以检查现在已经安装上的包：</p>

<blockquote><p>$ bower list</p></blockquote>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/bower_zps6514aa7b.jpg" alt=" bower list" /></p>

<p>在项目初始化配置的时候，我们已经将包添加进了项目</p>

<h2>查询包</h2>

<p>查找<code>angular-ui-sortable</code>包，确认有 AngularUI 的包可以使用</p>

<blockquote><p>$ bower search angular-ui-sortable</p></blockquote>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/bower-01_zpsce838305.jpg" alt="bower search" /></p>

<p>结果搜到两个记录，我们需要的是第一个</p>

<p>同时，我们还要安装另外一个<a href="http://jqueryui.com/">jQuery UI</a>,包名是"jquery-ui".</p>

<p>进行包的安装：</p>

<blockquote><p>$ bower install --save angular-ui-sortable</p>

<p>$ bower install --save jquery-ui</p></blockquote>

<p>用 <code>--save</code> 更新 <code>bower.json</code> 文件中关于angular-ui-sortable和jquery-ui的依赖，这样你就不用手动去 <code>bower.json</code> 中更新依赖了。</p>

<p>也可以用下面的命令，将多个包一起安装</p>

<blockquote><p>$ bower install --save angular-ui-sortable jquery-ui</p></blockquote>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/bower-02_zpscc976603.jpg" alt="bower install" /></p>

<h2>确认安装</h2>

<p>看一下你的 <code>bower_components</code> 目录是不是所有包都已经检出下来了，你可以看到 <code>jquery-ui</code> 和 <code>angular-ui-sortable</code> 出现在之前已经安装的Angular包边上了：</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/bower-03_zps32cbeaeb.jpg" alt="确认安装" /></p>

<h2>让 todos 应用可排序</h2>

<p>这些新安装的依赖要被添加进我们的 <code>index.html</code> 文件。你可以手动添加，不过其实Yeoman会自动添加上。先在命令行中使用Ctrl+c，退出当前的进程。再次运行：</p>

<blockquote><p>$ grunt serve</p></blockquote>

<p>可以看到，新的包已经添加进来了</p>

<pre><code>&lt;!-- build:js(.) scripts/vendor.js --&gt;
&lt;!-- bower:js --&gt;
&lt;script src="bower_components/jquery/dist/jquery.js"&gt;&lt;/script&gt;
&lt;script src="bower_components/angular/angular.js"&gt;&lt;/script&gt;
&lt;script src="bower_components/json3/lib/json3.js"&gt;&lt;/script&gt;
&lt;script src="bower_components/bootstrap/dist/js/bootstrap.js"&gt;&lt;/script&gt;
&lt;script src="bower_components/angular-resource/angular-resource.js"&gt;&lt;/script&gt;
&lt;script src="bower_components/angular-cookies/angular-cookies.js"&gt;&lt;/script&gt;
&lt;script src="bower_components/angular-sanitize/angular-sanitize.js"&gt;&lt;/script&gt;
&lt;script src="bower_components/angular-animate/angular-animate.js"&gt;&lt;/script&gt;
&lt;script src="bower_components/angular-touch/angular-touch.js"&gt;&lt;/script&gt;
&lt;script src="bower_components/angular-route/angular-route.js"&gt;&lt;/script&gt;
&lt;script src="bower_components/jquery-ui/jquery-ui.js"&gt;&lt;/script&gt;
&lt;script src="bower_components/angular-ui-sortable/sortable.js"&gt;&lt;/script&gt;
&lt;!-- endbower --&gt;
&lt;!-- endbuild --&gt;
</code></pre>

<p>为了使用<code>Sortable模块</code>，我们需要在 <code>scripts/app.js</code> 中更新Angular 模块，将   <code>Sortable</code> 可以加载到我们的应用中，更改前代码，
将 <code>ui.sortable</code> 添加进数组中,如下：</p>

<pre><code>angular
  .module('mytodoApp', [
    'ngAnimate',
    'ngCookies',
    'ngResource',
    'ngRoute',
    'ngSanitize',
    'ngTouch',
    'ui.sortable'
  ])
</code></pre>

<p>最后，在 <code>main.html</code> 中，我们需要将 <code>ui-sortable</code> 指令作为一个<code>div</code> 将 <code>ng-repeat</code> 层包起来。</p>

<pre><code>&lt;!-- Todos list --&gt;
&lt;div ui-sortable ng-model="todos"&gt;
  &lt;p class="input-group" ng-repeat="todo in todos"&gt;
</code></pre>

<p>添加一些内联的CSS，将鼠标显示为“可移动”样式来告诉用户这些 todo 项是可以移动的：</p>

<pre><code>&lt;p class="input-group" ng-repeat="todo in todos" style="padding:5px 10px; cursor: move;"&gt;
</code></pre>

<p>完整代码如下：</p>

<pre><code>&lt;!-- Todos list --&gt;
&lt;div ui-sortable ng-model="todos"&gt;
  &lt;p class="input-group" ng-repeat="todo in todos" style="padding:5px 10px; cursor: move;"&gt;
    &lt;input type="text" ng-model="todo" class="form-control"&gt;
    &lt;span class="input-group-btn"&gt;
      &lt;button class="btn btn-danger" ng-click="removeTodo($index)" aria-label="Remove"&gt;X&lt;/button&gt;
    &lt;/span&gt;
  &lt;/p&gt;
&lt;/div&gt;
</code></pre>

<p>效果如下：</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/grunt-04_zpsc5335661.gif" alt="可移动" /></p>

<p><a href="#TOC">[↑]</a></p>

<h1><a name='用Karma和Jasmine进行测试'>用 Karma 和 Jasmine 进行测试</a></h1>

<p><a href="http://karma-runner.github.io/">Karma</a>是一个JS测试框架。Angular生成器本身已经包括了两个测试框架：<a href="https://code.angularjs.org/1.2.16/docs/guide/e2e-testing">ngScenario</a> 和<a href="http://jasmine.github.io/">Jasmine</a>。当之前我们运行<code>yo angular</code> 的时候，在 <code>mytodo</code> 文件夹下会生成了一个 <code>test</code> 目录，还有一个 <code>karma.conf.js</code> 文件，它会被放入在 <code>Node</code> 模块中以使用<code>Karma</code>。我们将会编辑一个 <code>Jasmine</code> 脚本来完成我们的测试。现在先来看看要怎么进行测试。</p>

<h2>执行单位测试</h2>

<p>现在回到命令行结束 <code>grunt server</code> 的进程（使用 <code>Ctrl+c</code>）。在<code>Gruntfile.js</code>中已经有了用于运行测试的grunt任务，可以直接像下面这样运行：</p>

<blockquote><p>$ grunt test</p></blockquote>

<p>之后在控制台会看到几条警告信息，测试失败，不要紧，下面进行修正。</p>

<h2>更新 Karma 配置</h2>

<p>首先， 修改 <code>karma.conf.js</code>，添加</p>

<pre><code>  'bower_components/jquery/dist/jquery.js',
  'bower_components/jquery-ui/ui/jquery-ui.js',
  'bower_components/angular-ui-sortable/sortable.js',
</code></pre>

<p>最终的样子是：</p>

<pre><code>files: [
  'bower_components/angular/angular.js',
  'bower_components/angular-mocks/angular-mocks.js',
  'bower_components/angular-animate/angular-animate.js',
  'bower_components/angular-cookies/angular-cookies.js',
  'bower_components/angular-resource/angular-resource.js',
  'bower_components/angular-route/angular-route.js',
  'bower_components/angular-sanitize/angular-sanitize.js',
  'bower_components/angular-touch/angular-touch.js',
  'bower_components/jquery/dist/jquery.js',
  'bower_components/jquery-ui/ui/jquery-ui.js',
  'bower_components/angular-ui-sortable/sortable.js',
  'app/scripts/**/*.js',
  'test/mock/**/*.js',
  'test/spec/**/*.js'
],
</code></pre>

<h2>更新单位测试</h2>

<p>打开<code>test/spec/controllers/main.js</code>,这个是测试 <code>MainCtrl</code> 控制器的。这个测试样本还是引入了之前老项目的代码，需要进行修改，将</p>

<pre><code>it('should attach a list of awesomeThings to the scope', function () {
  expect(scope.awesomeThings.length).toBe(3);
});
</code></pre>

<p>改为</p>

<pre><code>it('should have no items to start', function () {
  expect(scope.todos.length).toBe(0);
});
</code></pre>

<p>打开<code>scripts/controllers/main.js</code>,清空 <code>todos</code> 数组</p>

<pre><code>$scope.todos = [];
</code></pre>

<p>执行测试</p>

<blockquote><p>$ grunt test</p></blockquote>

<p>测试通过，效果如下：</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/karma_zps2ece45af.jpg" alt="测试通过" /></p>

<h2>添加更多单位测试</h2>

<p>上面例子只测试了部分方法，可以再多加：</p>

<pre><code>it('should add items to the list', function () {
  scope.todo = 'Test 1';
  scope.addTodo();
  expect(scope.todos.length).toBe(1);
});

it('should add then remove an item from the list', function () {
  scope.todo = 'Test 1';
  scope.addTodo();
  scope.removeTodo(0);
  expect(scope.todos.length).toBe(0);
});
</code></pre>

<p>MainCtrl 控制器完整的测试文档（<code>test/spec/controllers/main.js</code>），如下：</p>

<pre><code>'use strict';

describe('Controller: MainCtrl', function () {

  // load the controller's module
  beforeEach(module('mytodoApp'));

  var MainCtrl,
    scope;

  // Initialize the controller and a mock scope
  beforeEach(inject(function ($controller, $rootScope) {
    scope = $rootScope.$new();
    MainCtrl = $controller('MainCtrl', {
      $scope: scope
    });
  }));

  it('should have no items to start', function () {
    expect(scope.todos.length).toBe(0);
  });

  it('should add items to the list', function () {
    scope.todo = 'Test 1';
    scope.addTodo();
    expect(scope.todos.length).toBe(1);
  });

  it('should add then remove an item from the list', function () {
    scope.todo = 'Test 1';
    scope.addTodo();
    scope.removeTodo(0);
    expect(scope.todos.length).toBe(0);
  });

});
</code></pre>

<p>测试通过，效果如下：</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/karma-01_zps30870c3a.jpg" alt="测试通过" /></p>

<p>屌爆了！</p>

<p>当项目变大，开发人员不断加入的时候，编写单元测试更容易捕捉 BUG，Yeoman  的脚手架功能使编写单元测试更容易，所以没有理由不写自己的测试！;)b</p>

<h1><a name='准备发布产品'>准备发布产品</a></h1>

<h2>为产品优化文件</h2>

<p>为了将应用发布为产品版本，还需要做很多工作：</p>

<ul>
<li>校验我们的代码</li>
<li>运行我们的测试</li>
<li>合并和缩小脚本和样式来减少网络请求</li>
<li>优化任何使用到的图像</li>
<li>对所有输出进行编译处理，使程序瘦身</li>
</ul>


<p>呦西~实现上述目标只需一句：</p>

<blockquote><p>$ grunt</p></blockquote>

<p>这个命令将会完成 Grunt 的任务以及根据 Gruntfile.js 文件进行配置，创建一个可以运行的应用版本。只需等上一分钟，你就能得到一个完整的编译版本，和一份编译过程耗时的报告。</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/grunt-04_zpsc278574f.jpg" alt="编译完成" /></p>

<p>编译完成后的文件，放在了 dist 目录下，是一个可以拿去服务器上的部署的真正的产品。</p>

<h2>编译和预览应用产品</h2>

<p>执行一句</p>

<blockquote><p>$ grunt serve:dist</p></blockquote>

<p>它会自动编译项目，并且启动 web 服务器 。Yo 真是牛！</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/grunt-05_zpsd14207be.jpg" alt="编译运行项目" /></p>

<p><a href="#TOC">[↑]</a></p>

<h1><a name='本地存储来持久化数据'>本地存储来持久化数据</a></h1>

<p>之前项目的数据，当浏览器刷新后就不会保存了。现在扯下数据持久化。</p>

<h2>安装 Bower 包</h2>

<p>安装 Angular 模块 <a href="http://gregpike.net/demos/angular-local-storage/demo.html">angular-local-storage</a>，让我们快速实现本地存储（<a href="http://diveintohtml5.info/storage.html">local storage</a>）</p>

<p>执行</p>

<blockquote><p>$ bower install --save angular-local-storage</p></blockquote>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/storage_zps2447b234.jpg" alt="angular-local-storage" /></p>

<h2>添加本地存储</h2>

<p>关闭线程，重启服务</p>

<blockquote><p>$ grunt serve</p></blockquote>

<p><code>index.html</code> 页面会自动引入包</p>

<pre><code>&lt;script src="bower_components/angular-local-storage/angular-local-storage.js"&gt;&lt;/script&gt;
</code></pre>

<p>编辑 <code>scripts/app.js</code> 添加 <code>LocalStorageModule</code>的 适配器:</p>

<pre><code>angular
  .module('mytodoApp', [
    'ngAnimate',
    'ngCookies',
    'ngResource',
    'ngRoute',
    'ngSanitize',
    'ngTouch',
    'ui.sortable',
    'LocalStorageModule'
])
</code></pre>

<p>同时也要配置 <code>localStorageServiceProvider</code>，用<code>ls</code>为 <code>localStorage</code>名称前缀这样你的应用程序不会碰巧读到，从另一个应用程序使用相同的变量名：</p>

<pre><code>.config(['localStorageServiceProvider', function(localStorageServiceProvider){
  localStorageServiceProvider.setPrefix('ls');
}])
</code></pre>

<p>完整的文件：</p>

<pre><code>'use strict';

angular
  .module('mytodoApp', [
    'ngAnimate',
    'ngCookies',
    'ngResource',
    'ngRoute',
    'ngSanitize',
    'ngTouch',
    'ui.sortable',
    'LocalStorageModule'
  ])
  .config(['localStorageServiceProvider', function(localStorageServiceProvider){
    localStorageServiceProvider.setPrefix('ls');
  }])
  .config(function ($routeProvider) {
    $routeProvider
      .when('/', {
        templateUrl: 'views/main.html',
        controller: 'MainCtrl'
      })
      .when('/about', {
        templateUrl: 'views/about.html',
        controller: 'AboutCtrl'
      })
      .otherwise({
        redirectTo: '/'
      });
</code></pre>

<p>  });</p>

<p>需要在你的控制器<code>scripts/controllers/main.js</code> 中声明对本地存储服务的依赖。将<code>localStorageService</code>作为第二个传入参数添加到你的回调函数中。</p>

<pre><code>'use strict';

angular.module('mytodoApp')
  .controller('MainCtrl', function ($scope, localStorageService) {
    // (code hidden here to save space)
  });
</code></pre>

<p>现在，todo 项就不是从静态的数组中读取的，将会从本地存储里读取然后再将它们存入<code>$scope.todos</code> 中。 我们还需要使用 Angular 的 <code>$warch</code> 监听器来监听 <code>$scope.todos</code> 的值得变化。如果有人添加或者删减了 todo 项目，本地存储中的数据也会被同步</p>

<p>因此，我们需要将现在的 <code>$scope.todos</code> 声明删掉：</p>

<pre><code>$scope.todos = [];
</code></pre>

<p>替换为：</p>

<pre><code>var todosInStore = localStorageService.get('todos');

$scope.todos = todosInStore &amp;&amp; todosInStore.split('\n') || [];

$scope.$watch('todos', function () {
  localStorageService.add('todos', $scope.todos.join('\n'));
}, true);
</code></pre>

<p>完整的代码：</p>

<pre><code>'use strict';

angular.module('mytodoApp')
  .controller('MainCtrl', function ($scope, localStorageService) {

    var todosInStore = localStorageService.get('todos');

    $scope.todos = todosInStore &amp;&amp; todosInStore.split('\n') || [];

    $scope.$watch('todos', function () {
      localStorageService.add('todos', $scope.todos.join('\n'));
    }, true);

    $scope.addTodo = function () {
      $scope.todos.push($scope.todo);
      $scope.todo = '';
    };

    $scope.removeTodo = function (index) {
      $scope.todos.splice(index, 1);
    };

  });
</code></pre>

<p>在浏览器中查看应用，你会发现 todo 列表中没有任何东西。因为这个应用从本地存储中读取了 todo 数组，而本地存储中还没有任何 todo 项。</p>

<p>再来添加一些项目到列表中吧：
<img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/storage-01_zpscc3fbcdb.jpg" alt="添加一些项目" /></p>

<p>在当我们再次刷新我们的浏览器的时候，这些项目都还在。哦也~</p>

<p>在Chrome浏览器 按 F12 ,弹出开发工具（Chrome DevTools）中的 Resources 面板里确认我们的数据是不是真的被永久储存在本地存储中。在资源面板的左侧里选中<code>Local Storage</code>：</p>

<p><img src="http://i1288.photobucket.com/albums/b484/waylau/waylau%20blog/yeoman/storage-02_zpsabd7b10f.jpg" alt="Local Storage" /></p>

<p>更多有关单位测试的，可以移步至<a href="http://andyshora.com/unit-testing-best-practices-angularjs.html">Unit Testing Best Practices in AngularJS</a></p>

<p><a href="#TOC">[↑]</a></p>

<h1><a name='总结'>总结</a></h1>

<h2>Yeoman 可以做更多</h2>

<p>Yeoman 支持 包括 Angular 在内的其他框架的脚手架。</p>

<p>Anugular生成器也支持创建新的视图、指令和控制器。可以通过运行 <code>yo angular:route routeName</code> 搭建一个新的控制器，同时在 <code>app.js</code> 中的路由也会被更新。在可能使用单元测试的地方，我们也会试图搭建测试。</p>

<p>了解更多有关于 Angular 生成器的 Yeoman 命令，请查看<a href="https://github.com/yeoman/generator-angular#readme">generator readme</a>。</p>

<h2>下步工作</h2>

<ul>
<li><a href="angularjs.org">AngularJS</a> 帮助我们写 todo 应用程序快速和优雅。深入挖掘用AngularJS的甜蜜点.<a href="http://docs.angularjs.org/guide/overview">详细的文档</a></li>
<li><a href="http://gruntjs.com/">Grunt</a>提供了几乎所有与你的应用交互的服务，包括<a href="https://github.com/gruntjs/grunt-contrib-compass">编译CoffeeScript</a>或者与像 PHP 或者 Express 编写的<a href="https://github.com/gruntjs/grunt-contrib-connect">中间层连接</a>。你的 Yeoman 已经生成了Gruntfile.js，所以你要做的就是看一看如何<a href="http://gruntjs.com/configuring-tasks">配置Grunt tasks</a></li>
<li><a href="http://bower.io/">Bower</a>上可以获取的包的资源越来越多，可以在这里查看所有的<a href="http://bower.io/">包</a></li>
<li>Yeoman 会持续更新。查看<a href="http://yeoman.io/">yeoman.io</a>获取更多信息，也可以关注<a href="https://twitter.com/yeoman">@yeoman</a>和<a href="https://plus.sandbox.google.com/101063139999404044459/posts">+Yeoman</a></li>
</ul>


<p><a href="#TOC">[↑]</a></p>

<h1><a name='参考'>参考</a></h1>

<ul>
<li><a href="http://yeoman.io/codelab.html">http://yeoman.io/codelab.html</a></li>
</ul>


<h1><a name='源码'>源码</a></h1>

<p>这里 Yeoman 提供最终的<a href="http://yeoman.io/codelab.html#source-files">项目源码</a>,如果打不开(国外网站，可能被墙)，也可以访问笔者的项目源码<a href="https://github.com/waylau/mytodo">https://github.com/waylau/mytodo</a></p>

<p><a href="#TOC">[↑]</a></p>

      <div class="readall"><a href="/build-angularjs-app-with-yeoman-in-windows/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/sql-start-time-end-time/">SQL Server取开始时间、截止时间</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年08月26日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#sqlserver">sqlserver</a>
      </p>
    </header>
    <div class="post-main">
      <pre><code>--当天开始
SELECT dateadd(ms,0,DATEADD(dd, DATEDIFF(dd,0,getdate()), 0))       当天开始
--当天结束
SELECT dateadd(ms,-3,DATEADD(dd, DATEDIFF(dd,-1,getdate()), 0))     当天结束

--当月第一天
SELECT DATEADD(mm, DATEDIFF(mm,0,getdate()), 0)             当月第一天
--当月最后一天
SELECT   dateadd(ms,-3,DATEADD(mm,   DATEDIFF(m,0,getdate())+1,   0))   当月最后一天
</code></pre>

<p><img src="http://d.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=7686612ae6dde711e3d243f397d4bf26/8435e5dde71190efd52243f0cd1b9d16fcfa60c0.jpg?referer=12d1d7e5818ba61e86f9fc1fc0de&amp;x=.jpg" alt="时间" /></p>

      <div class="readall"><a href="/sql-start-time-end-time/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="posts">
  <section class="post">
    <header class="post-header">
      <h1 class="post-title"><a href="/dont-write-angularjs-app-using-jquery-thinking/">不要用jQuery思维写AngularJS应用</a></h1>
      <p class="post-meta">
        <i class="fa fa-calendar"></i>
        2014年08月23日
        <i class="space"></i>
        <i class="fa fa-tags"></i>
        <a class="post-category" href="/page/category.html#angularjs">angularjs</a>
      </p>
    </header>
    <div class="post-main">
      <h1>jQuery and AngularJS 苹果、橙</h1>

<p>jQuery 和 AngularJS 就像苹果和橙，本身不是一类东西，注重点也不同。</p>

<p>jQuery 主要是用来操作DOM，作用就是消除各浏览器的差异，简化和丰富DOM 的API，比如 DOM 文档的转换，事件处理，动画，和 AJAX 交互等。</p>

<p>AngularJS 是一个完整的框架，试图解决现代 Web 2.0 应用程序开发的各个方面。 AngularJS 有着诸多特性，最为核心的是：MVC、模块化、自动化双向数据绑定、语义化标签、依赖注入，等等。(看到了Flex 和 Spring 的影子)</p>

<p>最重要的是，用 AngularJS 以一种完全不同的方法构建用户界面，其中以声明方式指定视图的模型驱动的变化。而 jQuery 常常需要编写以DOM为中心的代码，随着项目的增长（无论是在规模和交互性方面）将会变得越来越难控制。</p>

<p>用 AngularJS 以现代的Web应用程序开发的整体方法，并试图让浏览器更好的发展平台。</p>

<h1>简单的例子比较</h1>

<p>几个例子看出他们的不同点</p>

<h2>模板</h2>

<p>在jQuery里面，会用编程的方式来修改视图，像下面这样用<code>ul</code>标签来定义一个下拉列表：</p>

<pre><code>&lt;ul class="main-menu"&gt;
    &lt;li class="active"&gt;
        &lt;a href="#/home"&gt;Home&lt;/a&gt;
    &lt;/li&gt;
    &lt;li&gt;
        &lt;a href="#/menu1"&gt;Menu 1&lt;/a&gt;
        &lt;ul&gt;
            &lt;li&gt;&lt;a href="#/sm1"&gt;Submenu 1&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a href="#/sm2"&gt;Submenu 2&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a href="#/sm3"&gt;Submenu 3&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;
        &lt;a href="#/home"&gt;Menu 2&lt;/a&gt;
    &lt;/li&gt;
&lt;/ul&gt;
</code></pre>

<p>在jQuery里面，会像下面这行代码一样来创建这个下拉列表：</p>

<pre><code>$('.main-menu').dropdownMenu();
</code></pre>

<p>如果我们仅仅看视图代码，我们无法立刻发现它有什么功能。对于小型的应用来说，这样做还算可以。但是对于大型应用来说，很快就会变得混乱并难以维护。</p>

<p>然而，在AngularJS中，视图是一种模板，一种潜规则，<code>ul</code>声明看起来就像下面这样：</p>

<pre><code>&lt;ul class="main-menu" dropdown-menu&gt;
    ...
&lt;/ul&gt;
</code></pre>

<p>两种方式的效果完全相同，但是在 AngularJS 的版本中，每一个看到模板的人都知道它在做什么（潜规则）。 不管什么时候开发团队有新人进来，她看到这种代码之后就会立即明白，存在一个叫做<code>dropdownMenu</code>的指令，这个指令负责操控这个视图。凭直觉就可以知道答案，没有必要看任何代码。视图本身已经告诉了我们这里会发生什么。这样就更加清晰了。</p>

<h2>数据绑定</h2>

<p>数据绑定作为 AngularJS 的特性之一，更新视图，无需操纵 DOM ，剩下很多代码（ 想想 Flex ）。在jQuery更新视图的步骤是这样的，将设有如下视图</p>

<pre><code>&lt;ul class="messages" id="log"&gt;
&lt;/ul&gt;
</code></pre>

<p>我要在<code>ul</code>插入<code>li</code>,需要操作 DOM 来添加节点元素。</p>

<pre><code>$.ajax({
  url: '/myEndpoint.json',
  success: function ( data, status ) {
    $('ul#log').append('&lt;li&gt;Data Received!&lt;/li&gt;');
  }
});
</code></pre>

<p>假设，此时，我要删除<code>log</code>视图，那我不得不去 操作 DOM,把ajax 里面的添加方法修改了。太蛋疼了。其实在 js 里面写 html 本身就是一件困难的事，因为 html 包含尖括号、属性、双引号、单引号、方法，在 js 需要对这些特殊符号进行转义 ，代码将会变得冗长易出错且难以识别。 如下面的例子：</p>

<pre><code>var str = "&lt;a href=# name=link5 class="menu1 id=link1" + "onmouseover=MM_showMenu(window.mm_menu_0604091621_0,-10,20,null,\'link5\');"+ "sel1.style.display=\'none\';sel2.style.display=\'none\';sel3.style.display='none\';"+" onmouseout=MM_startTimeout();&gt;Free Services&lt;/a&gt; ";

document.write(str);
</code></pre>

<p>看下 AngularJS 是怎么干的，先定义一个界面模板</p>

<pre><code>&lt;ul class="messages"&gt;
    &lt;li ng-repeat="entry in log"&gt;&lt;/li&gt;
&lt;/ul&gt;
</code></pre>

<p>而后更新数据</p>

<pre><code>$http( '/myEndpoint.json' ).then( function ( response ) {
    $scope.log.push( { msg: 'Data Received!' } );
});
</code></pre>

<p>视图就会根据数据自动刷新了。而界面改成什么样，并不需要去修改更新数据的接口，比如改成下面的样子</p>

<pre><code>&lt;div class="messages"&gt;
    &lt;div class="alert" ng-repeat="entry in log"&gt;

    &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<h1>不要用jQuery思维写AngularJS应用</h1>

<p>用 AngularJS 模型为中心和 jQuery DOM为中心的范式完全不同。经验丰富的jQuery开发者开发 AngularJS 可能会陷入“范式的陷阱”。建议你跳过 JQuery 的依赖，同时学习用 AngularJS（只是不想回到旧的习惯和学会用AngularJS方式解决问题）。不要混合使用 jQuery 和 AngularJS 。不要使用 jQuery 。最好不要引入它。当你遇到一个问题，而这个问题你知道如何使用 jQuery 去解决，那么在你使用$之前， 请思考一下如何以 AngularJS 的方式去解决它。 jQuery 从来就不是必须的。</p>

<p>在架构上，AngularJS 主要是用来构架<a href="http://n.wikipedia.org/wiki/Single-page_application">SPA</a>单页面应用，而不是普通的网页集合，所以在架构上要整体考虑，包括服务端和客户端，如何将应用进行分解，划分模块，考虑模块的独立性、可扩展行，以及可测试性。</p>

<h2>参考</h2>

<ul>
<li><p><a href="https://www.packtpub.com/web-development/mastering-web-application-development-angularjs">Mastering Web Application Development with AngularJS</a></p></li>
<li><p><a href="http://stackoverflow.com/questions/14994391/how-do-i-think-in-angularjs-if-i-have-a-jquery-background">http://stackoverflow.com/questions/14994391/how-do-i-think-in-angularjs-if-i-have-a-jquery-background</a></p></li>
</ul>


      <div class="readall"><a href="/dont-write-angularjs-app-using-jquery-thinking/" id="post-readall">阅读全文&nbsp;<i class="fa fa-chevron-right"></i></a></div>
    </div>
  </section>
</div>

<div class="pagination">
  
  
  <a class="pagination-item newer" href="/page/2"><i class="fa fa-arrow-left"></i>&nbsp;&nbsp;上一页</a>
  
    

    
      <a href="/">1</a>
      

    
      
      <a href="/page/2">2</a>
      
    
      
      <span class="current-page">3</span>
      
    
      
      <a href="/page/4">4</a>
      
    
      
      <a href="/page/5">5</a>
      
    
      
      <a href="/page/6">6</a>
      
    
      
      <a href="/page/7">7</a>
      
    
      
      <a href="/page/8">8</a>
      
    
      
      <a href="/page/9">9</a>
      
    
      
      <a href="/page/10">10</a>
      
    
      
      <a href="/page/11">11</a>
      
    
      
      <a href="/page/12">12</a>
      
    
      
      <a href="/page/13">13</a>
      
    
      
      <a href="/page/14">14</a>
      
    
      
      <a href="/page/15">15</a>
      
    
      
      <a href="/page/16">16</a>
      
    
      
      <a href="/page/17">17</a>
      
    
      
      <a href="/page/18">18</a>
      
    
      
      <a href="/page/19">19</a>
      
    
      
      <a href="/page/20">20</a>
      
    
      
      <a href="/page/21">21</a>
      
    
      
      <a href="/page/22">22</a>
      
    
  (共129篇)

  
  <a class="pagination-item older" href="/page/4">下一页&nbsp;&nbsp;<i class="fa fa-arrow-right"></i></a>
  
</div>

    <footer>Copyright&nbsp;&copy;&nbsp;2014 <a href="http://www.waylau.com">Way Lau's Blog</a><br/><i class="fa fa-cogs" style="color:blueviolet;">&nbsp;</i>Powered by <a href="https://github.com/waylau/jekyll-theme-blog" target="_blank">jekyll-theme-blog</a></footer>
    </div>


  </div>    
  <div id="top"><a id="rocket" href="javascript:;" title="返回顶部"><i></i></a></div>
  


</body>
</html>