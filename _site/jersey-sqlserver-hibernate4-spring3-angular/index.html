<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <meta name="description" content="Way Lau's Personal Site | www.waylau.com">
  <meta name="author" content="Way Lau">
  <meta name="keywords" content="用Jersey构建RESTful服务9--Jersey+SQLServer+Hibernate4.3+Spring3.2+AngularJS, Way Lau's Blog, Way Lau">
  <title>用Jersey构建RESTful服务9--Jersey+SQLServer+Hibernate4.3+Spring3.2+AngularJS - Way Lau's Blog</title>
  <link rel="canonical" href="http://www.waylau.com/jersey-sqlserver-hibernate4-spring3-angular/">
  <link rel="icon" href="/res/img/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/res/img/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/res/css/public.css">
  <link rel="stylesheet" href="/res/css/light.css">
  <script src="/res/js/light.js"></script>
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?28cf5fa48a599e39c5cc760931de942f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>
</head>
<body>
  <div id="blog">
    <div class="sidebar">
  <div class="profilepic">
    <a href="/"><img src="/res/img/icon.png" alt="logo"></img></a>
  </div>
  <h1 class="title"><a href="/">Way Lau's Blog</a></h1>
  <h2 class="sub-title">技术改变世界！</h2>
  <nav id="nav">
    <ul>
    
      <li><a href="/timing/"><i class="fa fa-clock-o"></i>&nbsp;时光机</a></li>
    
      <li><a href="/categories/"><i class="fa fa-tags"></i>&nbsp;分类</a></li>
    
      <li><a href="/tags/"><i class="fa fa-bookmark"></i>&nbsp;标签</a></li>
    
      <li><a href="http://labs.waylau.com/"><i class="fa fa-building"></i>&nbsp;示例</a></li>
    
      <li><a href="/books/"><i class="fa fa-book"></i>&nbsp;书籍</a></li>
    
      <li><a href="/about/"><i class="fa fa-paper-plane-o"></i>&nbsp;关于</a></li>
    
    </ul>
  </nav>  
  <nav id="sub-nav">
    <a class="weibo " href="http://weibo.com/waylau521" title="新浪微博" target="_blank"><i class="fa fa-weibo "></i></a>
    <a class="github" href="https://github.com/waylau" title="GitHub" target="_blank"><i class="fa fa-github fa-2x"></i></a>
    <a class="twitter" href="https://twitter.com/waylau521" title="Twitter" target="_blank"><i class="fa fa-twitter fa-2x"></i></a>
    <a class="rss" href="/page/feed.xml" title="RSS订阅" target="_blank"><i class="fa fa-rss"></i></a>
  </nav>
  <div id="license">
    <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank" title="本站所有作品采用：&#10;知识共享《署名 非商业性使用 相同方式共享 3.0》&#10;进行许可" >
    <img alt="License" height="31" width="88" src="/res/img/license.png" /></a>
  </div>
</div>
    <div class="main">
    <header class="post-header">
  <h1 class="post-title"><a href="/jersey-sqlserver-hibernate4-spring3-angular/">用Jersey构建RESTful服务9--Jersey+SQLServer+Hibernate4.3+Spring3.2+AngularJS</a></h2>
  <p class="post-meta">
    <i class="fa fa-calendar"></i>
    2014年07月31日
    <i class="space"></i>
    <i class="fa fa-tags"></i>
    <a class="post-category" href="/page/category.html#javajerseyrestangularjs">javajerseyrestangularjs</a>	
  </p>
</header>
<div class="post-main">
<h1>一、总体说明</h1>

<p>本例运行演示了用 Jersey 构建 RESTful 服务中，如何集成 angular,用MVC分层的方式访问 RESTful 服务。</p>

<h1>二、环境</h1>

<ul>
<li>1.上上文的项目 <a href="(https://github.com/waylau/RestDemo/tree/master/jersey-demo7-sqlserver-hibernate-spring3">Demo7</a>)</li>
<li>2.angular 库 ,本例为1.2.3 版本</li>
<li>3.样式 bootstrap-3.1.1.min.js</li>
</ul>


<h1>三、配置</h1>

<p>1.完成项目结构</p>

<p><img src="http://h.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=07b98f30acc379317968862cdbffc678/f636afc379310a55cc5093c2b44543a98226108b.jpg?referer=334116001e950a7b2c227bf4508a&amp;x=.jpg" alt="配置" />
创建相应的目录结构</p>

<p>angularjs 、bootstrap 的js,css文件放别放入相应的目录，</p>

<p>在js目录下再创建 <code>app.js</code> 、<code>controller.js</code></p>

<p>在partials目录下再创建 <code>create.html</code>、 <code>list.html</code> 、 <code>detail.html</code></p>

<p>完整目录结构如下<img src="http://c.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=febe1487830a19d8cf03840003c1f3b6/6d81800a19d8bc3e83344bfc818ba61ea8d345c3.jpg?referer=96c30518d11b0ef435ffad6ea3c1&amp;x=.jpg" alt="结构" /></p>

<ol>
<li>在<code>list.html</code>填入如下内容,主要是显示用户列表<code>ng-repeat</code>为 angularjs 迭代器
``作用是数据绑定:</li>
</ol>


<pre><code class="html">
    &lt;div class="pull-right"&gt;
        &lt;a href="#/create" class="btn btn-default" title="Create"&gt;&lt;span class="glyphicon glyphicon-plus"&gt;&lt;/span&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div class="page-header"&gt;
        &lt;h3&gt;Users&lt;/h3&gt;
    &lt;/div&gt;
    &lt;hr /&gt;
    &lt;li ng-repeat="user in users | filter:query | orderBy:orderProp"  &gt;

        &lt;div class="pull-right"&gt;
           &lt;a href="#/users/"  class="btn btn-xs btn-default" title="edit"&gt;
           &lt;span class="glyphicon glyphicon-pencil"&gt;&lt;/span&gt;&lt;/a&gt;
        &lt;/div&gt;
        &lt;h4&gt;userId: &lt;/h4&gt;
        &lt;p&gt;userName:&lt;a href="#/users/"&gt;&lt;/a&gt;   Age:&lt;/p&gt;
    &lt;hr /&gt;
    &lt;/li&gt;

    &lt;hr /&gt;
</code></pre>

<ol>
<li>修改<code>create.html</code>用来添加用户信息，<code>ng-model</code>是模型</li>
</ol>


<pre><code class="html">    &lt;div class="page-header"&gt;
        &lt;h3&gt;Create&lt;/h3&gt;
    &lt;/div&gt;

    &lt;form role="form" name="userForm"&gt;

     &lt;div class="row"&gt;&amp;nbsp;&lt;/div&gt;
     &lt;div class="row" ng-class="{'has-error': userForm.userId.$invalid}"&gt;
      &lt;div class="col-md-1"&gt;
        &lt;i ng-show="userForm.url.$error.required" 
          class="glyphicon glyphicon-pencil"&gt;&lt;/i&gt;
        &lt;label for="urlInput"&gt;userId&lt;/label&gt;
      &lt;/div&gt;
      &lt;div class="col-md-4"&gt;
        &lt;input 
          type="test" 
          class="form-control" id="urlInput"
          name="userId" ng-model="user.userId" required&gt; 
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="row"&gt;&amp;nbsp;&lt;/div&gt;

    &lt;div class="row" ng-class="{'has-error': userForm.userName.$invalid}"&gt;
      &lt;div class="col-md-1"&gt;
        &lt;i ng-show="userForm.userName.$error.required" 
          class="glyphicon glyphicon-pencil"&gt;&lt;/i&gt;
        &lt;label for="nameInput"&gt;userName&lt;/label&gt;
      &lt;/div&gt;
      &lt;div class="col-md-4"&gt;
        &lt;input 
          type="text" 
          class="form-control error" id="nameInput"
          name="userName" 
          ng-model="user.userName" 
          required&gt; 
      &lt;/div&gt;      
    &lt;/div&gt;

    &lt;div class="row"&gt;&amp;nbsp;&lt;/div&gt;
    &lt;div class="row" ng-class="{'has-error': userForm.url.$invalid}"&gt;
      &lt;div class="col-md-1"&gt;
        &lt;i ng-show="userForm.url.$error.required" 
          class="glyphicon glyphicon-pencil"&gt;&lt;/i&gt;
        &lt;label for="urlInput"&gt;age&lt;/label&gt;
      &lt;/div&gt;
      &lt;div class="col-md-4"&gt;
        &lt;input 
          type="text" 
          class="form-control" id="urlInput"
          name="age" ng-model="user.age" required&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="row" ng-hide="showConfirm"&gt;
      &lt;div class="col-md-5"&gt;
        &lt;a href="#users" class="btn"&gt;Cancel&lt;/a&gt;
        &lt;button 
          ng-click="add()" 
          ng-disabled="isClean() || userForm.$invalid"
          class="btn btn-primary"&gt;Save&lt;/button&gt;

      &lt;/div&gt;
    &lt;/div&gt;
</code></pre>

<ol>
<li><p>修改<code>detail.html</code>用来显示用户信息并提供修改、删除等功能
```html
<form role="form" name="userForm"></p>

<p>   <div class="row">&nbsp;</div>
   <div class="row" ng-class="{'has-error': userForm.userId.$invalid}">
    <div class="col-md-1">
      <i ng-show="userForm.url.$error.required"
        class="glyphicon glyphicon-pencil"></i>
      <label for="urlInput">userId</label>
    </div>
    <div class="col-md-4">
      <input
        type="test"
        class="form-control" id="urlInput"
        name="userId" ng-model="user.userId" required>
    </div>
  </div>
  <div class="row">&nbsp;</div></p>

<p>  <div class="row" ng-class="{'has-error': userForm.userName.$invalid}">
    <div class="col-md-1">
      <i ng-show="userForm.userName.$error.required"
        class="glyphicon glyphicon-pencil"></i>
      <label for="nameInput">userName</label>
    </div>
    <div class="col-md-4">
      <input
        type="text"
        class="form-control error" id="nameInput"
        name="userName"
        ng-model="user.userName"
        fend-focus="focusUserNameeInput"
        required>
    </div>    <br/>
  </div>
  <div class="row">&nbsp;</div>
  <div class="row" ng-class="{'has-error': userForm.url.$invalid}">
    <div class="col-md-1">
      <i ng-show="userForm.url.$error.required"
        class="glyphicon glyphicon-pencil"></i>
      <label for="urlInput">age</label>
    </div>
    <div class="col-md-4">
      <input
        type="text"
        class="form-control" id="urlInput"
        name="age" ng-model="user.age" required>
    </div>
  </div></p>

<p>  <div class="row" ng-hide="showConfirm">&nbsp;</div></p>

<p>  <div class="row" ng-hide="showConfirm">
    <div class="col-md-5">
      <a href="#users" class="btn">Cancel</a>
      <button
        ng-click="save()"
        ng-disabled="isClean() || userForm.$invalid"
        class="btn btn-primary">Save</button>
      <button
        ng-click="remove()"
        ng-show="user.userId"
        class="btn btn-danger">Delete</button>
    </div>
  </div></p>

<p></form>
```</p></li>
<li><p>修改<code>index.html</code>作为主页面,嵌入其他子页面，<code>ng-app</code>声明这个是模块，<code>ng-controller</code>说明他的控制器叫<code>ListCtrl</code>,<code>ng-view</code>用来存放子视图（页面）。</p></li>
</ol>


<pre><code class="html">    &lt;!doctype html&gt;
    &lt;html ng-app="appMain" ng-controller="ListCtrl"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"/&gt;
        &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
        &lt;link rel="stylesheet" href="css/bootstrap.min.css" type="text/css"/&gt;
    &lt;/head&gt;
    &lt;body &gt;
        &lt;!-- navbar --&gt;
        &lt;div class="container ng-view"&gt;&lt;/div&gt;
        &lt;!-- footer --&gt;
        &lt;div id="footer" class="hidden-xs"&gt;
          &lt;div class="container"&gt;
            &lt;p class="text-muted"&gt;
              Project Example - by &lt;a href="http://www.waylau.com" target="_blank"&gt;www.waylau.com&lt;/a&gt; | 
              &lt;a href="https://github.com/waylau" target="_blank"&gt;GitHub Project&lt;/a&gt;
            &lt;/p&gt;
          &lt;/div&gt;
        &lt;/div&gt;

        &lt;script src="js/bootstrap-3.1.1.min.js"&gt;&lt;/script&gt;
        &lt;script src="js/angular-1.2.3.js"&gt;&lt;/script&gt;
        &lt;script src="js/angular-resource-1.2.3.js"&gt;&lt;/script&gt;
        &lt;script src="js/angular-route-1.2.3.js"&gt;&lt;/script&gt;
        &lt;script src="js/angular-cookies-1.2.3.js"&gt;&lt;/script&gt;

        &lt;script src="js/app.js"&gt;&lt;/script&gt;
        &lt;script src="js/controller.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
    &lt;/html&gt;
</code></pre>

<ol>
<li>修改<code>app.js</code> ，声明模块<code>appMain</code>,提供路由功能，说明了调转到哪个页面，用哪个控制器</li>
</ol>


<pre><code class="javascript">
    angular.module('appMain', ['ngRoute']).config(['$routeProvider', function ($routeProvider) {
        $routeProvider.
            when('/users', {templateUrl: 'partials/list.html', controller: ListCtrl}).
            when('/users/:userId', {templateUrl: 'partials/detail.html', controller: DetailCtrl}).
            when('/create', {
                templateUrl: 'partials/create.html',
                controller: CreateController
            }).
            otherwise({redirectTo: '/users'});
    }]);
</code></pre>

<ol>
<li>修改<code>controller.js</code>，控制器。主要是对业务逻辑的操作，常见的CURD功能，http访问RESTful接口，并且返回数据</li>
</ol>


<pre><code class="javascript   ">    var url = 'http://localhost:8089/RestDemo/rest';

    function ListCtrl($scope, $http) {
        $http.get( url + '/users' ).success(function(data) {
            $scope.users = data;
        });

        $scope.orderProp = 'age';
    }

    function DetailCtrl($scope, $routeParams, $http) {

        $http.get( url + '/users/'+$routeParams.userId).success(function(data) {
            $scope.user = data;
        });

        $scope.save = function() {
            $http.put( url + '/users',  $scope.user).
            success(function(data, status, headers, config){
                $location.path('/');
            }).error(function(data, status, headers, config){
                alert("error"+status);
            }) ;
        };

        $scope.remove =  function(){
            $http({
                method:'DELETE',
                url: url + '/users/'+  $scope.user.userId ,
            })
            .success(function(data, status, headers, config){
                $location.path('/');
            }).error(function(data, status, headers, config){
                alert("error"+status);
            }) ;
        };
    }

    function CreateController($scope, $http) {


        $scope.add = function() {
            $http.post( url + '/users',  $scope.user).
            success(function(data, status, headers, config){
                $location.path('/');
            }).error(function(data, status, headers, config){
                alert("error"+status);
            }) ;
        };
    }
</code></pre>

<h1>四、运行</h1>

<p>1.先运行项目</p>

<p>2.可以进行CURD操作</p>

<p><img src="http://g.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=78def5b7c81349547a1ee8616675e365/8cb1cb1349540923fb552e489158d109b3de49c3.jpg?referer=eb100a8d4410b912e6d6c3ceb7c1&amp;x=.jpg" alt="LIST" /></p>

<p><img src="http://b.hiphotos.bdimg.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=de95dcc47e1ed21b7dc92ee09d55acf9/a5c27d1ed21b0ef442d4d568dec451da81cb3ec3.jpg?referer=f6c201370955b319c5eeb7457ac2&amp;x=.jpg" alt="DETAIL" /></p>

<p><em>PS</em>:本案例力求简单把 angularjs 访问 RESTful 服务展示出来，在Chrome,firefox,IE上做过测试。</p>

<p><strong>本章源码</strong>：<a href="jersey-demo9-sqlserver-hibernate-spring3-angularjs">jersey-demo9-sqlserver-hibernate-spring3-angularjs</a></p>

</div>
<div class="share">
  <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more"></a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
  </div>
  <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":["qzone","tsina","weixin","sqq"],"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/res/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</div>
<div class="pagination">

<a class="pagination-item newer" href="/jersey-sqlserver-hibernate4-spring3-jquery/"><i class="fa fa-arrow-left"></i>&nbsp;&nbsp;用Jersey构建RESTful服务8--Jersey+SQLServer+Hibernate4.3+Spring3.2+jquery</a>


<a class="pagination-item older" href="/tomcat-failed-start/">eclipse中"Tomcat v8.0 Server at localhost failed to start"解决以及安装方法&nbsp;&nbsp;<i class="fa fa-arrow-right"></i></a>

</div>
<div class="comments">
  <div class="ds-thread" data-title="用Jersey构建RESTful服务9--Jersey+SQLServer+Hibernate4.3+Spring3.2+AngularJS" data-thread-key="/jersey-sqlserver-hibernate4-spring3-angular" data-url="http://www.waylau.com/jersey-sqlserver-hibernate4-spring3-angular/"></div>
  <script type="text/javascript">var duoshuoQuery = {short_name:"waylau"};(function(){var ds = document.createElement('script');ds.type = 'text/javascript';ds.async = true;ds.src = '/res/js/embed.js';ds.charset = 'UTF-8';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);})();</script>
</div>
    <footer>Copyright&nbsp;&copy;&nbsp;2014 <a href="http://www.waylau.com">Way Lau's Blog</a><br/><i class="fa fa-cogs" style="color:blueviolet;">&nbsp;</i>Powered by <a href="https://github.com/waylau/jekyll-theme-blog" target="_blank">jekyll-theme-blog</a></footer>
    </div>


  </div>    
  <div id="top"><a id="rocket" href="javascript:;" title="返回顶部"><i></i></a></div>
  


</body>
</html>