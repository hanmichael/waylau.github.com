(function(bc,aT,a1){function ah(b,a){for(var c in a){a[c]&&(b[c]?b[c].set(a[c]):b[c]=new aX(a[c]))}}function aG(b,a){for(var c in a){b[c]=a[c]}}function aI(){if(aS.checkPermission()){return}var b;while(b=am.shift()){var d=aS.createNotification(b.iconUrl,b.title,b.body),a=b.url;try{d.onclick=function(){bc.focus(),aV.href=a,d.cancel()}}catch(c){}d.show(),setTimeout(function(){d.cancel&&d.cancel()},8000)}}function aF(){return aK.data.user_id==0}function a0(c,a,d){if(aZ){try{aZ.removeItem(c),aZ.removeItem(c+":timestamp"),aZ[c]=a7.stringify(a),aZ[c+":timestamp"]=Math.floor(d)}catch(b){}}}function av(a){aQ.theme=a,a!="none"&&aQ.injectStylesheet(bf+"/styles/embed"+(a?"."+a+".css?"+aO[a]:"."+short_name)+".css")}if(bc.DUOSHUO){return}var aV=bc.location,a7=bc.JSON,aU=bc.XMLHttpRequest,aZ=a7&&a7.stringify&&bc.localStorage,aS=bc.webkitNotifications,bg=aT.getElementsByTagName("head")[0]||aT.getElementsByTagName("body")[0],bb=bc.navigator.userAgent,a3=aT.location.protocol=="https:"?"https:":"http:",be=0,a8,aY=function(){var c={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},a=/&(?!\w+;)|[<>"'`]/g,d=/[&<>"'`]/,b=function(e){return c[e]||"&amp;"};return function(f){return f==null||f===!1?"":d.test(f)?f.replace(a,b):f}}(),bd=function(a){if(a.match(/^(http|https):/)){return a}var b=aT.createElement("a");return b.href=a,aP.hrefNormalized?b.href:b.getAttribute("href",4)},aR={start:0,end:0},a2=function(j){var d=this,b=0,g=0,m,c,l,k,h;aT.selection&&(c=aT.selection.createRange(),c&&c.parentElement()==d&&(k=d.value.length,m=d.value.replace(/\r\n/g,"\n"),l=d.createTextRange(),l.moveToBookmark(c.getBookmark()),h=d.createTextRange(),h.collapse(!1),l.compareEndPoints("StartToEnd",h)>-1?b=g=k:(b=-l.moveStart("character",-k),b+=m.slice(0,b).split("\n").length-1,l.compareEndPoints("EndToEnd",h)>-1?g=k:(g=-l.moveEnd("character",-k),g+=m.slice(0,g).split("\n").length-1)))),aR.start=b,aR.end=g},a9=function(a){return function(){return a}},aO={"default":"d6149e1c",dark:"c11b5925",bluebox:"dbc0a9af"},bf=a3+"//static.duoshuo.com",aQ=bc.DUOSHUO={DOMAIN:"duoshuo.com",REMOTE:"http://duoshuo.com",version:140327,loaded:{jQuery:typeof jQuery!="undefined"&&jQuery.fn.jquery>="1.5",smilies:!1,mzadxN:typeof mzadxN!="undefined"},libs:{jQuery:bf+"/libs/embed.compat.js?24f8ca3f.js",smilies:bf+"/libs/smilies.js?921e8eda.js",mzadxN:"http://js.miaozhen.com/mz_ad_serving.js"},sourceName:{weibo:"\u65b0\u6d6a\u5fae\u535a",qq:"QQ",qzone:"QQ\u7a7a\u95f4",qqt:"\u817e\u8baf\u5fae\u535a",renren:"\u4eba\u4eba\u7f51",douban:"\u8c46\u74e3\u7f51",netease:"\u7f51\u6613\u5fae\u535a",kaixin:"\u5f00\u5fc3\u7f51",sohu:"\u641c\u72d0\u5fae\u535a",baidu:"\u767e\u5ea6",taobao:"\u6dd8\u5b9d",msn:"MSN",google:"\u8c37\u6b4c"},serviceNames:{weibo:"\u5fae\u535a",qq:"QQ",douban:"\u8c46\u74e3",renren:"\u4eba\u4eba",netease:"\u7f51\u6613",kaixin:"\u5f00\u5fc3",sohu:"\u641c\u72d0",baidu:"\u767e\u5ea6",taobao:"\u6dd8\u5b9d",msn:"MSN",google:"\u8c37\u6b4c"},parseDate:function(a){return a.parse("2011-10-28T00:00:00+08:00")&&function(b){return new a(b)}||a.parse("2011/10/28T00:00:00+0800")&&function(b){return new a(b.replace(/-/g,"/").replace(/:(\d\d)$/,"$1"))}||a.parse("2011/10/28 00:00:00+0800")&&function(b){return new a(b.replace(/-/g,"/").replace(/:(\d\d)$/,"$1").replace("T"," "))}||function(b){return new a(b)}}(Date),fullTime:function(b){var a=aQ.parseDate(b);return a.getFullYear()+"\u5e74"+(a.getMonth()+1)+"\u6708"+a.getDate()+"\u65e5 "+a.toLocaleTimeString()},elapsedTime:function(c){var a=aQ.parseDate(c),d=new Date,b=(d-be-a)/1000;return b<10?"\u521a\u521a":b<60?Math.round(b)+"\u79d2\u524d":b<3600?Math.round(b/60)+"\u5206\u949f\u524d":b<86400?Math.round(b/3600)+"\u5c0f\u65f6\u524d":(d.getFullYear()==a.getFullYear()?"":a.getFullYear()+"\u5e74")+(a.getMonth()+1)+"\u6708"+a.getDate()+"\u65e5"},require:function(c,a){if(typeof c=="string"){aQ.loaded[c]?a():az(aQ.libs[c],function(){aQ.loaded[c]=!0,a()})}else{if(typeof c=="object"){var d,b=!0;for(d=0;d<c.length;d++){(function(e){if(aQ.loaded[c[d]]){return}b=!1,az(aQ.libs[e],function(){aQ.loaded[e]=!0;for(var f=0;f<c.length;f++){if(!aQ.loaded[c[f]]){return}}a()})})(c[d])}b&&a()}}},getCookie:function(h){var g=" "+h+"=",d=aT.cookie.split(";"),f=0,j,c,b;for(;f<d.length;f++){j=" "+d[f],c=j.indexOf(g);if(c>=0&&c+g.length==(b=j.indexOf("=")+1)){return decodeURIComponent(j.substring(b,j.length).replace(/\+/g,""))}}return a1},param:function(c){var a=[];for(var b in c){c[b]!=a1&&a.push(b+"="+encodeURIComponent(c[b]))}return a.join("&")},ajax:function(k,q,b,d,p){var n=aQ.getCookie("duoshuo_token");b.v=aQ.version,n?b.jwt=n:aN.remote_auth&&(b.remote_auth=aN.remote_auth);if(aU&&a7&&a7.parse){var j=new aU;if(!!j&&"withCredentials" in j){var g;function m(w,z,o,h){var A,y,v,u=z;if(w>=200&&w<300||w===304){if(w===304){u="notmodified",A=!0}else{try{y=a7.parse(o),u="success",A=!0}catch(x){u="parsererror",v=x}}}else{v=u;if(!u||w){u="error",w<0&&(w=0)}try{y=a7.parse(o)}catch(x){u="parsererror",v=x}}A?d(y):u==="parseerror"?au("\u89e3\u6790\u9519\u8bef: "+o):(p&&p(y),au("\u51fa\u9519\u5566("+y.code+"): "+y.errorMessage),y.errorTrace&&au(y.errorTrace))}j.open(k,aQ.hostUrl+q+".json"+(k=="GET"?"?"+aQ.param(b):""),!0),j.withCredentials=!0,j.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),j.send(k=="GET"?null:aQ.param(b)),g=function(x,l){var w,h,v,y;try{if(g&&(l||j.readyState===4)){g=a1;if(l){j.readyState!==4&&j.abort()}else{w=j.status,v=j.getAllResponseHeaders();try{y=j.responseText}catch(x){}try{h=j.statusText}catch(f){h=""}}}}catch(c){l||m(-1,c)}y&&m(w,h,y,v)},j.readyState===4?g():j.onreadystatechange=g;return}}k!="GET"&&(b._method="POST");var i="cb_"+Math.round(Math.random()*1000000);aQ[i]=function(a){switch(a.code){case 0:d(a);break;default:p&&p(a),au("\u51fa\u9519\u5566("+a.code+"): "+a.errorMessage),a.errorTrace&&au(a.errorTrace)}},b.callback="DUOSHUO['"+i+"']",az(aQ.hostUrl+q+".jsonp?"+aQ.param(b))},injectStylesheet:function(a){var b=aT.createElement("link");b.type="text/css",b.rel="stylesheet",b.href=a,bg.appendChild(b)},setCustomStyle:function(a){a8||(a8=aT.createElement("style"),a8.type="text/css",bg.appendChild(a8)),a=a.replace(/\}/g,"}\n");if(a8.styleSheet){a8.styleSheet.cssText=a}else{while(a8.firstChild){a8.removeChild(a8.firstChild)}a8.appendChild(aT.createTextNode(a))}},compileStyle:function(c){var a="",d={textbox:"#ds-thread #ds-reset .ds-replybox .ds-textarea-wrapper"};if(c){for(var b in c){a+=d[b]+"{"+c[b]+"}\n"}}return a},init:function(b,a){b&&!an[b]&&(an[b]=a||{type:"EmbedThread"}),aQ.initView&&aQ.initView()}},aA=aT.all,ai,aP=aQ.support=function(){var d=aT.createElement("div");d.innerHTML='<a href="/a">a</a><input type="checkbox"/>';var b=d.getElementsByTagName("a")[0],c=d.getElementsByTagName("input")[0],a={placeholder:"placeholder" in c,touch:"ontouchstart" in bc||"onmsgesturechange" in bc,hrefNormalized:b.getAttribute("href")==="/a",iOS:bb.match(/ \((iPad|iPhone|iPod);( U;)? CPU( iPhone)? OS /),android:bb.match(/ \(Linux; U; Android /)};return ai=!aU&&typeof d.style.maxHeight=="undefined",a.authInWin=bc.postMessage&&bc.screen.width>800&&!a.iOS&&!a.android&&aV.origin,a}(),ag=function(d,f){var c=(aT.body||aT.documentElement).style;if(typeof c=="undefined"){return !1}if(typeof c[d]=="string"){return f?d:!0}var a=["Moz","Webkit","ms"],d=d.charAt(0).toUpperCase()+d.substr(1),b=0;for(;b<a.length;b++){if(typeof c[a[b]+d]=="string"){return f?a[b]+d:!0}}},an=aQ.selectors={".ds-thread":{type:"EmbedThread"},".ds-recent-comments":{type:"RecentComments"},".ds-recent-visitors":{type:"RecentVisitors"},".ds-top-users":{type:"TopUsers"},".ds-top-threads":{type:"TopThreads"},".ds-login":{type:"LoginWidget"},".ds-thread-count":{type:"ThreadCount"}},aC=aQ.pagelets=[],a4={post:"\u53d1\u5e03",posting:"\u6b63\u5728\u53d1\u5e03",settings:"\u8bbe\u7f6e",reply:"\u56de\u590d",like:"\u9876",repost:"\u8f6c\u53d1",report:"\u4e3e\u62a5","delete":"\u5220\u9664",reply_to:"\u56de\u590d ",reposts:"\u8f6c\u53d1",comments:"\u8bc4\u8bba",floor:"\u697c",latest:"\u6700\u65b0",earliest:"\u6700\u65e9",hottest:"\u6700\u70ed",share_to:"\u5206\u4eab\u5230:",leave_a_message:"\u8bf4\u70b9\u4ec0\u4e48\u5427\u2026",no_comments_yet:"\u8fd8\u6ca1\u6709\u8bc4\u8bba\uff0c\u6c99\u53d1\u7b49\u4f60\u6765\u62a2",repost_reason:"\u8bf7\u8f93\u5165\u8f6c\u53d1\u7406\u7531",hot_posts_title:"\u88ab\u9876\u8d77\u6765\u7684\u8bc4\u8bba",comments_zero:"\u6682\u65e0\u8bc4\u8bba",comments_one:"1\u6761\u8bc4\u8bba",comments_multiple:"{num}\u6761\u8bc4\u8bba",reposts_zero:"\u6682\u65e0\u8f6c\u53d1",reposts_one:"1\u6761\u8f6c\u53d1",reposts_multiple:"{num}\u6761\u8f6c\u53d1",weibo_reposts_zero:"\u6682\u65e0\u65b0\u6d6a\u5fae\u535a",weibo_reposts_one:"1\u6761\u65b0\u6d6a\u5fae\u535a",weibo_reposts_multiple:"{num}\u6761\u65b0\u6d6a\u5fae\u535a",qqt_reposts_zero:"\u6682\u65e0\u817e\u8baf\u5fae\u535a",qqt_reposts_one:"1\u6761\u817e\u8baf\u5fae\u535a",qqt_reposts_multiple:"{num}\u6761\u817e\u8baf\u5fae\u535a"},ap=function(c,a,d,b){aQ.ajax("GET",c,a,d||function(){},b)},aE=function(c,a,d,b){aQ.ajax("POST",c,a,d||function(){},b)},am=[],ao,bh=[],aB=function(a){if(!("WebSocket" in bc&&a7)){return !1}bh.push(a7.stringify(a)),ao||(ao=aQ.webSocket=new WebSocket("ws://ws.duoshuo.com:8201/"),ao.onopen=function(){var b;if(ao.readyState===1){while(b=bh.shift()){ao.send(b)}}},ao.onmessage=function(f){try{var b=0,g,d=a7.parse(f.data)}catch(c){return}switch(d.type){case"post":for(;b<aQ.pagelets.length;b++){g=aQ.pagelets[b],g.threadId==d.thread_id&&g.onMessage(d)}break;case"notification":am.push(d),aI();break;default:}},bc.addEventListener("beforeunload",function(){ao.close()})),ao.onopen()},al=aQ.Collections={},aw=aQ.Views={},aD=aQ.Callbacks={},a6=aQ.openDialog=function(a){return aQ.dialog!==a1&&aQ.dialog.el.remove(),aQ.dialog=(new aw.Dialog('<div class="ds-dialog"><div class="ds-dialog-inner ds-rounded"><div class="ds-dialog-body">'+a+'</div><div class="ds-dialog-footer"><a href="http://duoshuo.com/" target="_blank" class="ds-logo"></a><span>\u793e\u4f1a\u5316\u8bc4\u8bba\u6846</span></div><a class="ds-dialog-close" href="javascript:void(0)" title="\u5173\u95ed"></a></div></div>')).open()},az=aQ.injectScript=function(c,a){var b=aT.createElement("script"),d=aT.head||aT.getElementsByTagName("head")[0]||aT.documentElement;b.type="text/javascript",b.src=c,b.async="async",b.charset="utf-8",a&&(b.onload=b.onreadystatechange=function(e,f){if(f||!b.readyState||/loaded|complete/.test(b.readyState)){b.onload=b.onreadystatechange=null,d&&b.parentNode&&d.removeChild(b),b=a1,f||a.call(bc)}}),d.insertBefore(b,d.firstChild)},au=aQ.log=function(a){typeof console=="object"&&console.log(a)},aW=aQ.smilies={},aj=["EmbedThread","RecentComments","RecentVisitors","TopUsers","TopThreads","LoginWidget","ThreadCount"],af=0,aN,ad=function(){var b={},a=0;for(;a<arguments.length;a++){arguments[a]&&aG(b,arguments[a])}var c=aQ.param(b);return c?"?"+c:""},ac=function(){var a=aQ.getCookie("duoshuo_token");return a?{jwt:a}:aN.remote_auth?{short_name:aN.short_name,remote_auth:aN.remote_auth}:a1},ae=function(){return !aN&&(aN=bc.duoshuoQuery)&&ba.trigger("queryDefined"),aN};for(var aM in Object.prototype){return alert("Object.prototype\u4e0d\u4e3a\u7a7a\uff0c\u8bf7\u4e0d\u8981\u7ed9Object.prototype\u8bbe\u7f6e\u65b9\u6cd5")}var ar=aQ.templates={userUrl:function(a){return a.url},avatarUrl:function(b,a){return b.avatar_url||a5.data.default_avatar_url},userAnchor:function(b){var a=ar.userUrl(b);return a?'<a rel="nofollow author" target="_blank" href="'+aY(a)+'">'+aY(b.name)+"</a>":aY(b.name)},avatarImg:function(b,a){return'<img src="'+aY(ar.avatarUrl(b,a))+'" alt="'+aY(b.name)+'"'+(a?' style="width:'+a+"px;height:"+a+'px"':"")+"/>"},avatar:function(c,a){var d=ar.avatarImg(c,a),b=ar.userUrl(c);return b?'<a rel="nofollow author" target="_blank" href="'+aY(b)+'" '+(c.user_id?" onclick=\"this.href='"+aQ.hostUrl+"/user-url/?user_id="+c.user_id+"';\"":"")+' title="'+aY(c.name)+'">'+d+"</a>":d},timeHtml:function(b,a){return b?a?'<a href="'+a+'" target="_blank" rel="nofollow" class="ds-time" datetime="'+b+'" title="'+aQ.fullTime(b)+'">'+aQ.elapsedTime(b)+"</a>":'<span class="ds-time" datetime="'+b+'" title="'+aQ.fullTime(b)+'">'+aQ.elapsedTime(b)+"</span>":""},serviceIcon:function(b,a){return'<a href="javascript:void(0)" class="ds-service-icon'+(a?"-grey":"")+" ds-"+b+'" data-service="'+b+'" title="'+aQ.sourceName[b]+'"></a>'},loginButtons:function(a){return'<div class="ds-login-buttons"><p>\u793e\u4ea4\u5e10\u53f7\u767b\u5f55:</p><div class="ds-social-links">'+ar.serviceList()+ar.additionalServices()+"</div></div>"},poweredBy:function(a){return'<p class="ds-powered-by"><a href="http://duoshuo.com" target="_blank" rel="nofollow">'+aY(a)+"</a></p>"},indicator:a9('<div id="ds-indicator"></div>'),waitingImg:a9('<div id="ds-waiting"></div>'),serviceList:function(c){var a='<ul class="ds-service-list">',d=["weibo","qq","renren","douban"],b=0;for(;b<d.length;b++){a+=ar.loginItem(d[b],c)}return a+'<li><a class="ds-more-services" href="javascript:void(0)">\u66f4\u591a\u00bb</a></li></ul>'},additionalServices:function(c){var a='<ul class="ds-service-list ds-additional-services">',d=["kaixin","netease","sohu","baidu","google"],b=0;for(;b<d.length;b++){a+=ar.loginItem(d[b],c)}return a+"</ul>"},loginItem:function(b,a){var c=ar[a?"bindUrl":"loginUrl"](b);return'<li><a href="'+c+'" rel="nofollow" class="ds-service-link ds-'+b+'">'+aQ.serviceNames[b]+(aK.data.social_uid[b]?' <span class="ds-icon ds-icon-ok"></span>':"")+"</a></li>"},loginUrl:function(b,a){return a||(a={}),aN.sso&&aN.sso.login&&(a.sso=1,a.redirect_uri=aN.sso.login),aQ.hostUrl+"/login/"+b+"/"+ad(a)},bindUrl:function(a){return aQ.hostUrl+"/bind/"+a+"/"+ad(aN.sso&&aN.sso.login?{sso:1,redirect_uri:aN.sso.login}:null,ac())},logoutUrl:function(){return aQ.hostUrl+"/logout/"+ad(aN.sso&&aN.sso.logout?{sso:1,redirect_uri:aN.sso.logout}:null)},likePost:function(a){return'<a class="ds-post-likes" href="javascript:void(0);"><span class="ds-icon ds-icon-like"></span>'+a4.like+(a.likes>0?"("+a.likes+")":"")+"</a>"},ctxPost:function(c,a,d){var b=aq(c);return'<li class="ds-ctx-entry"'+(d?' style="display:none"':"")+' data-post-id="'+c.post_id+'"><div class="ds-avatar">'+ar.avatar(b)+'</div><div class="ds-ctx-body"><div class="ds-ctx-head">'+ar.userAnchor(b)+ar.timeHtml(c.created_at,c.url)+(a>=0?'<div class="ds-ctx-nth" title="'+aQ.fullTime(c.created_at)+'">'+(a+1)+a4.floor+"</div>":"")+'</div><div class="ds-ctx-content">'+c.message+(a>=0?'\u3000\u3000\u3000\u3000\u3000\u3000\u3000<div class="ds-comment-actions'+(c.vote>0?" ds-post-liked":"")+'">'+ar.likePost(c)+' <a class="ds-post-repost" href="javascript:void(0);"><span class="ds-icon ds-icon-share"></span>'+a4.repost+'</a> <a class="ds-post-reply" href="javascript:void(0);"><span class="ds-icon ds-icon-reply"></span>'+a4.reply+"</a></div>":"")+"</div></div></li>"}},aq=function(a){return aL[a.author_id]&&aL[a.author_id].data||a.author},ak=function(b){var a=[];for(var c in b){a.push('<input type="hidden" name="'+c+'" value="'+aY(b[c])+'" />')}return a.join("\n")};for(;af<aj.length;af++){aQ[aj[af]]=function(a){return function(b,c){c=c||{},c.type=a,b&&!an[b]&&(an[b]=c),aQ.initSelector&&aQ.initSelector(b,c)}}(aj[af]),aQ["create"+aj[af]]=function(a){return function(e,d){var b=aT.createElement(e);for(var c in d){b.setAttribute("data-"+c,d[c])}return aQ[a](b),b}}(aj[af])}aQ.RecentCommentsWidget=aQ.RecentComments;var ay=0,ab=aQ.Class=function(){};ab.extend=function(c){function b(){!ay&&this.init&&this.init.apply(this,arguments)}ay=1;var a=new this;ay=0;for(var d in c){a[d]=c[d]}return b.prototype=a,b.prototype.constructor=b,b.extend=arguments.callee,b};var aa=aQ.Event=ab.extend({on:function(c,a){var b=this.handlers||(this.handlers={});return b[c]===a1&&(b[c]=[]),b[c].push(a),this},trigger:function(c,a){var d=(this.handlers||(this.handlers={}))[c];if(d){for(var b=0;b<d.length;b++){if(d[b].call(this,a)===!1){break}}}return this}}),aX=aQ.Model=aa.extend({init:function(a){this.data=a},reset:function(a){this.data=a,this.trigger("reset")},remove:function(a){this.data.splice(a,1),this.trigger("reset")},set:function(c,a){if(a===a1){for(var b in c){this.data[b]=c[b]}}else{this.data[c]=a}this.trigger("reset")}}),ba=aQ.events=new aa,a5=aQ.site=new aX,aK=aQ.visitor=new aX,aH=aQ.unread=new aX,ax=aQ.threads={},aJ=aQ.postPool={},aL=aQ.users={};ba.on("queryDefined",function(){var b=aN.short_name;aQ.hostUrl=b?a3+"//"+b+"."+aQ.DOMAIN:aQ.REMOTE,aN.theme&&av(aN.theme);if(aZ){var a=aZ["ds_site_"+b],c=aZ["ds_lang_"+b];a&&a5.reset(a7.parse(a)),c&&aG(a4,a7.parse(c))}}),ae(),aQ.loaded.jQuery&&(aQ.jQuery=bc.jQuery),aQ.require("jQuery",function(){function q(g,a,h){if(g.find(".ds-post[data-post-id="+a.post_id+"]")[0]){return}return g.find(".ds-post-placeholder").remove(),z(ar.post(a,h)).hide()[h.order=="asc"?"appendTo":"prependTo"](g).slideDown(function(){})}function v(g,a){var h;this.delegate("a.ds-post-likes","click",function(l){if(aF()){return r(),!1}var i=z(this).parent();return liked=i.hasClass("ds-post-liked"),matches=z(this).html().match(/\((\d+)\)/),likes=(matches?parseInt(matches[1]):0)+(liked?-1:1),aE("/api/posts/vote",{post_id:i.closest(".ds-ctx-entry, .ds-post-self").attr("data-post-id"),vote:liked?0:1}),z(this).html(z(this).html().replace(/\(\d+\)/,"")+(likes?"("+likes+")":"")),i[liked?"removeClass":"addClass"]("ds-post-liked"),!1}).delegate("a.ds-post-repost","click",function(l){var i=z(this).closest(".ds-post-self"),s=aJ[i.attr("data-post-id")];return aQ.repostDialog(s,""),!1}).delegate("a.ds-post-delete","click",function(i){if(confirm("\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u6761\u8bc4\u8bba\u5417\uff1f")){var l=z(this).closest(".ds-post-self");aE("/api/posts/remove",{post_id:l.attr("data-post-id")}),l.parent().fadeOut(200,function(){g.data.comments--,g.updateCounter("duoshuo"),z(this).remove()})}return !1}).delegate("a.ds-post-report","click",function(l){if(confirm("\u786e\u5b9a\u8981\u4e3e\u62a5\u8fd9\u6761\u8bc4\u8bba\u5417\uff1f")){var i=z(this).closest(".ds-post-self");aE("/api/posts/report",{post_id:i.attr("data-post-id")}),alert("\u611f\u8c22\u60a8\u7684\u53cd\u9988\uff01")}return !1}).delegate("a.ds-post-reply","click",function(y){var l=z(this),B=l.closest(".ds-comment-actions");if(B.hasClass("ds-reply-active")){h.el.fadeOut(200,function(){z(this).detach()}),B.removeClass("ds-reply-active")}else{var i=l.closest(".ds-ctx-entry, .ds-post-self");h?h.actionsBar.removeClass("ds-reply-active"):(h=new aw.Replybox(g),h.render(!0).el.addClass("ds-inline-replybox").detach()),h.el.find("[name=parent_id]").val(i.attr("data-post-id")),h.el.show().appendTo(l.closest(".ds-ctx-body, .ds-comment-body")).find("textarea").focus(),h.actionsBar=B.addClass("ds-reply-active"),a.max_depth<=1?h.postList=g.postList.el:(h.postList=i.siblings(".ds-children"),h.postList[0]||(h.postList=z('<ul class="ds-children"></ul>').insertAfter(i)))}return !1}).delegate("a.ds-weibo-comments","click",function(y){var F=z(this).closest(".ds-post-self"),l=F.attr("data-post-id"),i=F.data("source");if(F.attr("data-root-id")==0){var B=F.siblings(".ds-children");B[0]?B.remove():(B=z('<ul class="ds-children"></ul>').insertAfter(F),ap("/api/posts/listComments",D({post_id:l}),function(s){w(s),B.append(z.map(s.response,function(G){return ar.post(G,a)}).join(""))}))}return !1}).delegate("a.ds-weibo-reposts","click",function(y){var J=z(this).closest(".ds-post-self"),F=aJ[J.attr("data-post-id")],B=F.data.source;if(!aK.data.social_uid[B=="qqt"?"qq":B]){u(B);return}var I=F.data.root_id,l=I!="0"?aJ[I]:F,i="";if(I!="0"){var G=aq(F.data);i=(B=="weibo"?"//@"+G.name:"|| @"+G.qqt_account)+":"+F.data.message}return aQ.repostDialog(l,i,g,B),!1}).delegate("a.ds-expand","click",function(l){var i=z(this).parent();return i.siblings().show(),i.remove(),!1}),aP.touch||this.delegate("a.ds-comment-context, .ds-avatar, .ds-user-name","mouseenter",function(i){var s=this;if(bubbleOutTimer&&e.owner==s){clearTimeout(bubbleOutTimer),bubbleOutTimer=0}else{var l=z(s);c=setTimeout(function(){c=0,e.owner=s,b();var I=l.offset(),G=g.el.offset(),J=l.innerWidth()/2,L=g.el.innerHeight()-(I.top-G.top)+6,F=I.left-G.left-35+(J>35?35:J);try{if(l.hasClass("ds-comment-context")){n.attr("id","ds-ctx-bubble").attr("data-post-id",l.attr("data-post-id")).html('<ul id="ds-ctx">'+ar.ctxPost(aJ[l.attr("data-parent-id")].data)+'</ul><div class="ds-bubble-footer"><a class="ds-ctx-open" href="javascript:void(0);">\u67e5\u770b\u5bf9\u8bdd</a></div>')}else{if(l.hasClass("ds-avatar")||l.hasClass("ds-user-name")){var B={},K=B.user_id=l.attr("data-user-id");if(!K){throw"no info"}n.attr("id","ds-user-card").attr("data-user-id",K).empty(),aL[K]?n.html(ar.userInfo(aL[K].data)):ap("/api/users/profile",D(B),function(N){var M=N.response;aL[K]?aL[K].set(M):aL[K]=new aX(M),e.owner==s&&n.html(ar.userInfo(M))})}}e.css({bottom:L,left:F}).appendTo(g.innerEl)}catch(y){e.detach()}},200)}}).delegate("a.ds-comment-context, .ds-avatar, .ds-user-name","mouseleave",function(){c?(clearTimeout(c),c=0):bubbleOutTimer||bubbleOut()})}function u(g){var a=ar[aF()?"loginUrl":"bindUrl"](g);aP.authInWin&&j(g,a)||(aV.href=a)}function r(){var a=a6("<h2>\u793e\u4ea4\u5e10\u53f7\u767b\u5f55</h2>"+ar.serviceList()+ar.additionalServices()).el.find(".ds-dialog").css("width","300px");k(a)}function D(g){var h={require:"site,visitor,nonce,serverTime,lang"+(x++?"":",unread,log,extraCss"),site_ims:aZ&&aZ["ds_site_"+aN.short_name+":timestamp"],lang_ims:aZ&&aZ["ds_lang_"+aN.short_name+":timestamp"],referer:aT.referrer};aN.stylePatch&&(h.style_patch=aN.stylePatch);for(var a in h){h[a]&&(!ai||encodeURIComponent(h[a]).length<200)&&(g[a]=h[a])}return g}var z=aQ.jQuery,p=z(bc),E=z(aT),w=aQ.loadRequire=function(g){g.serverTime&&(be=(new Date).getTime()-g.serverTime*1000),g.visitor&&(!aK.data&&g.visitor.user_id&&aS&&!aS.checkPermission()&&aB({logged_user_id:g.visitor.user_id}),aK.reset(g.visitor)),g.site&&(a5.reset(g.site),a0("ds_site_"+aN.short_name,g.site,g.serverTime)),!aQ.theme&&a5.data.theme&&av(a5.data.theme),g.lang&&(aG(a4,g.lang),a0("ds_lang_"+aN.short_name,g.lang,g.serverTime));if(g.stylesheets){for(var a=0;a<g.stylesheets.length;a++){aQ.injectStylesheet(g.stylesheets[a])}}g.nonce&&(aQ.nonce=g.nonce),g.style&&aQ.setCustomStyle((g.style||"")+aQ.compileStyle(aN.component_style)),g.unread&&aH.reset(g.unread)},A=function(a){a.stopPropagation()},C=function(a){(a.ctrlKey&&a.which==13||a.which==10)&&z(this.form).trigger("submit")},m=function(g){var a=z(this);a.height(Math.max(54,a.next(".ds-hidden-text").text(this.value).height()+27))},j=function(g,h){var a={weibo:[760,600],renren:[420,322],qq:[504,445],netease:[810,645],sohu:[972,600],google:[600,440],taobao:[480,585]}[g]||[550,400];return bc.open(h+(h.indexOf("?")==-1?"?":"&")+aQ.param({origin:aV.origin||"http://"+aV.host}),"_blank","width="+a[0]+",height="+a[1]+",toolbar=no,menubar=no,location=yes")},k=function(g,a){aP.authInWin&&g.find(a||"a.ds-service-link").click(function(i){var h=this.href.match(/\/(login|bind)\/(\w+)\//i);if(!h||!aQ.serviceNames[h[2]]){return}return !j(h[2],this.href)})},H=function(a){return aP.touch&&a.addClass("ds-touch"),ag("transition")||a.addClass("ds-no-transition"),ai&&a.addClass("ds-ie6"),z.support.opacity||a.addClass("ds-no-opacity"),a},t=function(g){if(!aP.placeholder){var a=g.attr("placeholder");g.val(a).focus(function(){this.value===a&&(this.value="")}).blur(function(){this.value===""&&(this.value=a)})}return g};if(bc.postMessage){var o=function(a){if(a.origin==="http://duoshuo.com"){switch(a.data.type){case"login":aV.href=a.data.redirectUrl;break;default:}}};bc.addEventListener?bc.addEventListener("message",o,!1):bc.attachEvent&&bc.attachEvent("onmessage",o)}aQ.scrollTo=function(g){var a=g.offset().top;(a<p.scrollTop()||a>p.scrollTop()+p.height())&&z("html, body").animate({scrollTop:a-40},200,"swing")},aQ.toJSON=function(i){var a=/\r?\n/g,y=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,h=/^(?:select|textarea)/i,g=i.map(function(){return this.elements?z.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||h.test(this.nodeName)||y.test(this.type))}).map(function(B,F){var s=z(this).val();return s==null?null:z.isArray(s)?z.map(s,function(I,G){return{name:F.name,value:I.replace(a,"\r\n")}}):{name:F.name,value:s.replace(a,"\r\n")}}).toArray(),l={};return z.each(g,function(){l[this.name]=this.value}),l};var f=aQ.Widget=aa.extend({init:function(g,a){this.el=g,this.options=a||{},this.render()},render:function(){},reset:function(){},load:function(a){switch(a.code){case 0:w(a),this.onload(a);break;default:this.onError(a)}},onload:function(a){this.el.html(ar[this.tmpl].call(ar,a.response,z.extend(this.options,a.options)))},onMessage:function(){},onError:function(a){au("\u51fa\u9519\u5566("+a.code+"): "+a.errorMessage),a.errorTrace&&au(a.errorTrace)}}),d=function(h){var a={"unread-comments":{title:"\u65b0\u7559\u8a00\u53ca\u56de\u590d",apiUrl:"/api/users/unreadComments",tmpl:function(l){return'<li data-thread-id="'+l.thread.thread_id+'">'+z.map(l.authors,ar.userAnchor).join("\u3001")+' \u5728 <a class="ds-read" href="'+l.thread.url+'#comments" target="_blank">'+aY(l.thread.title||"\u65e0\u6807\u9898")+'</a> \u4e2d\u56de\u590d\u4e86\u4f60 <a class="ds-delete ds-read" title="\u77e5\u9053\u4e86" href="javascript:void(0)">\u77e5\u9053\u4e86</a></li>'},read:function(s){var l=s.attr("data-thread-id");aE("/api/threads/read",{thread_id:l}),aH.data.comments--}},"unread-notifications":{title:"\u7cfb\u7edf\u6d88\u606f",apiUrl:"/api/users/unreadNotifications",tmpl:function(l){return'<li data-notification-id="'+l.notification_id+'" data-notification-type="'+l.type+'">'+l.content+' <a class="ds-delete ds-read" title="\u77e5\u9053\u4e86" href="javascript:void(0)">\u77e5\u9053\u4e86</a></li>'},read:function(s){var l=s.attr("data-notification-id");aE("/api/notifications/read",{notification_id:l}),aH.data.notifications--}}}[h],i=a6("<h2>"+a.title+'</h2><ul class="ds-unread-list"></ul>');i.on("close",aQ.resetNotify);var g=i.el.find(".ds-unread-list").delegate(".ds-delete","click",function(l){return z(this).parent().remove(),g.children().length===0&&i.close(),!1}).delegate(".ds-read","click",function(l){a.read(z(this).parent())});z("#ds-notify").hide(),ap(a.apiUrl,{},function(l){i.el.find(".ds-unread-list").html(z.map(l.response,a.tmpl).join("\n"))}),aS&&aS.checkPermission()&&aS.requestPermission(aI)};aQ.resetNotify=function(){var a=z("#ds-notify"),g=aH.data;a[0]||(a=z('<div id="ds-notify"></div>').css({hidden:{display:"none"},"top-right":{top:"24px",right:"24px"},"bottom-right":{bottom:"24px",right:"24px"}}[a5.data.notify_position]).delegate(".ds-notify-unread a","click",function(h){return d(z(this).data("type")),!1}).appendTo(aT.body)),a.html('<div id="ds-reset"><a class="ds-logo" href="http://duoshuo.com/" target="_blank" title="\u591a\u8bf4"></a><ul class="ds-notify-unread"><li'+(g.comments?"":' style="display:none;"')+'><a data-type="unread-comments" href="javascript:void(0);">\u4f60\u6709'+g.comments+"\u6761\u65b0\u56de\u590d</a></li><li"+(g.notifications?"":' style="display:none;"')+'><a data-type="unread-notifications" href="javascript:void(0);">\u4f60\u6709'+g.notifications+"\u6761\u7cfb\u7edf\u6d88\u606f</a></li></ul></div>")[(g.comments||g.notifications)&&a5.data.notify_position!=="hidden"&&!z(".ds-dialog")[0]?"show":"hide"]()},aH.on("reset",aQ.resetNotify),ar.replybox=function(B,I){var l=B.options,g=aK.data,y=[],J="",h,G={thread_id:B.threadId,parent_id:"",nonce:aQ.nonce};for(var F in g.repostOptions){g.repostOptions[F]&&(y.push(F),h=1),J+=ar.serviceIcon(F,!g.repostOptions[F])}return'<div class="ds-replybox"><a class="ds-avatar"'+(aF()?' href="javascript:void(0);" onclick="return false"':' href="'+aQ.REMOTE+"/settings/avatar/"+ad(ac())+'" target="_blank" title="\u8bbe\u7f6e\u5934\u50cf"')+">"+ar.avatarImg(g)+'</a><form method="post">'+ak(G)+'<div class="ds-textarea-wrapper ds-rounded-top"><textarea name="message" title="Ctrl+Enter\u5feb\u6377\u63d0\u4ea4" placeholder="'+aY(a4.leave_a_message)+'"></textarea><pre class="ds-hidden-text"></pre></div><div class="ds-post-toolbar"><div class="ds-post-options ds-gradient-bg"><span class="ds-sync">'+(!aF()&&J?'<input id="ds-sync-checkbox'+(I?"-inline":"")+'" type="checkbox" name="repost" '+(h?'checked="checked" ':"")+'value="'+y.join(",")+'"> <label for="ds-sync-checkbox'+(I?"-inline":"")+'">'+a4.share_to+"</label>"+J:"")+'</span></div><button class="ds-post-button" type="submit">'+aY(a4.post)+'</button><div class="ds-toolbar-buttons">'+(l.use_smilies?'<a class="ds-toolbar-button ds-add-emote" title="\u63d2\u5165\u8868\u60c5"></a>':"")+(l.use_images&&l.parse_html_enabled?'<a class="ds-toolbar-button ds-add-image" title="\u63d2\u5165\u56fe\u7247"></a>':"")+"</div></div></form></div>"},aw.Replybox=function(a){this.embedThread=a},aw.Replybox.prototype={render:function(R){function g(a){a.data("submitting",!0),a.find(".ds-post-button").addClass("ds-waiting").html(a4.posting)[0].disabled=!0}function y(a){a.data("submitting",!1),a.find(".ds-post-button").removeClass("ds-waiting").html(a4.post)[0].disabled=!1}var M=this,K=M.embedThread,I=K.options,F=function(a){aQ.require("smilies",function(){})},X=M.el=z(ar.replybox(K,R)).click(F),Q=X.find("form"),O=Q.find("input[type=checkbox]")[0],V=Q.find("a.ds-service-icon, a.ds-service-icon-grey"),P=t(Q.find("textarea")).focus(F).keyup(C).keyup(m).bind("focus mousedown mouseup keyup",a2),U=X.find(".ds-add-emote").click(function(h){var a=aQ.smiliesTooltip;return U.toggleClass("ds-expanded").hasClass("ds-expanded")?(a||(a=aQ.smiliesTooltip=new aw.SmiliesTooltip,a.render(),aQ.require("smilies",function(){a.reset("\u5fae\u535a-\u9ed8\u8ba4")})),a.replybox=M,a.el.appendTo(aT.body).css({top:M.el.offset().top+M.el.outerHeight()+4+"px",left:M.el.find(".ds-textarea-wrapper").offset().left+"px"}),z(aT.body).click(G)):G(h),!1}),W=X.find(".ds-add-image").click(function(N){var T=P[0],L=T.value,h="\u8bf7\u8f93\u5165\u56fe\u7247\u5730\u5740",l='<img src="'+h+'" />';if(aT.selection){T.value=L.substring(0,aR.start)+l+L.substring(aR.end,L.length),T.value=T.value.replace("\u8bf4\u70b9\u4ec0\u4e48\u5427 ...",""),T.focus();var S=aT.selection.createRange();S.collapse(),S.findText(h),S.select()}else{T.value=L.substring(0,T.selectionStart)+l+L.substring(T.selectionEnd);var a=T.value.search(h);T.setSelectionRange(a,a+h.length),T.focus()}N.preventDefault()}),G=M.hideSmilies=function(a){U.removeClass("ds-expanded"),aQ.smiliesTooltip.el.detach(),z(aT.body).unbind("click",G)},i=function(l,a){var L=a6('<h2>\u793e\u4ea4\u5e10\u53f7\u767b\u5f55</h2><div class="ds-icons-32">'+z.map(["weibo","qq","renren","kaixin","douban","netease","sohu"],function(N){return'<a class="ds-'+N+'" href="'+ar.loginUrl(N)+'">'+aQ.sourceName[N]+"</a>"}).join("")+"</div>"+(I.deny_anonymous?"":'<h2>\u4f5c\u4e3a\u6e38\u5ba2\u7559\u8a00</h2><form><div class="ds-control-group"><input type="text" name="author_name" id="ds-dialog-name" value="'+aY(aK.data.name)+'" required /><label for="ds-dialog-name">\u540d\u5b57(\u5fc5\u586b)</label></div>'+(I.require_guest_email?'<div class="ds-control-group"><input type="email" name="author_email" id="ds-dialog-email" value="'+aY(aK.data.email)+'" required /><label for="ds-dialog-email">\u90ae\u7bb1(\u5fc5\u586b)</label></div>':"")+(I.require_guest_url?'<div class="ds-control-group"><input type="url" name="author_url" id="ds-dialog-url" placeholder="http://" value="'+aY(aK.data.url||"")+'" /><label for="ds-dialog-url">\u7f51\u5740(\u53ef\u9009)</label></div>':"")+'<button type="submit">\u53d1\u5e03</button></form>')),h=L.el.find(".ds-dialog").css("width","320px");k(h,".ds-icons-32 a");if(!I.deny_anonymous){var s=L.el.find("form");s.submit(function(S){var N=s.find("input[name=author_email]").val();return(N||I.require_guest_email)&&!N.match(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)?(alert("\u8bf7\u8f93\u5165\u4e00\u4e2a\u6709\u6548\u7684email\u5730\u5740."),!1):(a(aQ.toJSON(s)),L.close(),!1)}),s.find("input[name=author_name]")[0].focus()}};I.deny_anonymous&&P.focus(function(h){if(aF()){i(Q,J);var a=function(l){l.stopPropagation(),P.unbind("click",a)};P.click(a)}return !1});var J=function(a){g(Q),aE("/api/posts/create",z.extend(aQ.toJSON(Q),a),function(L){var s=L.response,l=q(M.postList,s,I);I.order=="asc"==(I.formPosition=="top")&&aQ.scrollTo(l),aJ[s.post_id]=new aX(s),K.data.comments++,K.updateCounter("duoshuo"),P.val("").trigger("keyup"),y(Q),X.hasClass("ds-inline-replybox")&&(X.detach(),M.actionsBar.removeClass("ds-reply-active"));if(aZ){try{aZ.removeItem("ds_draft_"+K.threadId)}catch(h){}}},function(h){y(Q),alert(h.errorMessage)})};Q.submit(function(h){if(Q.data("submitting")){return !1}var a=z.trim(Q[0].message.value);return a==""||!aP.placeholder&&a==P.attr("placeholder")?(alert("\u60a8\u8fd8\u6ca1\u5199\u5185\u5bb9\u5462"),!1):(aF()?i(Q,J):J(),!1)});var B=function(a){return z(a).hasClass("ds-service-icon-grey")?null:z(a).attr("data-service")};return V.click(function(){return z(this).toggleClass("ds-service-icon-grey").toggleClass("ds-service-icon"),O.value=z.map(V,B).join(","),O.checked=O.value!="",!1}),z(O).change(function(){var a=this.checked;V[a?"removeClass":"addClass"]("ds-service-icon-grey")[a?"addClass":"removeClass"]("ds-service-icon"),this.value=z.map(V,B).join(",")}),this}},aw.Dialog=aa.extend({init:function(g,a){(this.el=z("#ds-wrapper"))[0]||(this.el=H(z('<div id="ds-wrapper"></div>'))),this.options=z.extend({width:600},a),g!==a1&&z(g).attr("id","ds-reset").appendTo(this.el)},open:function(){var g=this;g.el.hide().appendTo(aT.body).fadeIn(200),ai&&g.el.css("top",p.scrollTop()+100),g.el.show().find(".ds-dialog").delegate("a.ds-dialog-close","click",function(i){return g.close(),!1}).click(A);var h=function(i){if(i.which==27){return g.close(),!1}},a=function(i){return g.close(),!1};return E.keydown(h),z(aT.body).click(a),g.close=function(i){E.unbind("keydown",h),z(aT.body).unbind("click",a),g.el.fadeOut(200,function(){z(this).remove()}),g.trigger("close")},g}}),ar.likePanel=function(a){return a.likes?'<span class="ds-highlight">'+a.likes+"</span> \u4eba\u559c\u6b22":""},ar.likeTooltip=function(l){var g={qzone:"QQ\u7a7a\u95f4",weibo:"\u65b0\u6d6a\u5fae\u535a",qqt:"\u817e\u8baf\u5fae\u535a",renren:"\u4eba\u4eba\u7f51",kaixin:"\u5f00\u5fc3\u7f51",douban:"\u8c46\u74e3\u7f51",baidu:"\u767e\u5ea6\u641c\u85cf",netease:"\u7f51\u6613\u5fae\u535a",sohu:"\u641c\u72d0\u5fae\u535a"},s=[];for(var h in g){s.push('<li><a class="ds-share-to-'+h+" ds-service-link ds-"+h+'" href="'+aQ.hostUrl+"/share-proxy/?"+aQ.param({service:h,thread_id:l.thread_id})+'">'+g[h]+"</a></li>")}var a=Math.ceil(s.length/2);return'<div class="ds-like-tooltip ds-rounded"><p>\u5f88\u9ad8\u5174\u4f60\u80fd\u559c\u6b22\uff0c\u5206\u4eab\u4e00\u4e0b\u5427\uff1a</p><ul>'+s.slice(0,a).join("")+"</ul><ul>"+s.slice(a).join("")+'</ul><p class="ds-like-tooltip-footer"><a class="ds-like-tooltip-close">\u7b97\u4e86</a></p></div>'},aw.Meta=function(a){this.embedThread=a},aw.Meta.prototype={render:function(){var l=this,i=l.embedThread,y=i.data,h=l.el=z('<div class="ds-meta"><a href="javascript:void(0)" class="ds-like-thread-button ds-rounded'+(y.user_vote>0?" ds-thread-liked":"")+'"><span class="ds-icon ds-icon-heart"></span> <span class="ds-thread-like-text">'+(y.user_vote>0?"\u5df2\u559c\u6b22":"\u559c\u6b22")+'</span><span class="ds-thread-cancel-like">\u53d6\u6d88\u559c\u6b22</span></a><span class="ds-like-panel"></span></div>'),g=h.find(".ds-like-thread-button").click(function(s){var a=g.hasClass("ds-thread-liked");aE("/api/threads/vote",{thread_id:i.threadId,vote:a?0:1},function(F){z.each(F.response.thread,function(I,G){y[I]=G}),l.resetLikePanel()}),g.toggleClass("ds-thread-liked"),g.find(".ds-thread-like-text").text(a?"\u559c\u6b22":"\u5df2\u559c\u6b22");var B=function(F){l.tooltip.detach(),z(aT.body).unbind("click",B)};return a?l.tooltip&&B(s):(l.tooltip===a1&&(l.tooltip=z(ar.likeTooltip(y)).click(A).delegate("a","click",function(F){switch(this.className){case"ds-like-tooltip-close":B(F);break;default:if(!bc.open(this.href,"_blank","height=500,width=600,top=0,left=0,toolbar=no,menubar=no,resizable=yes,location=yes,status=no")){return}}return !1})),l.tooltip.appendTo(i.innerEl).css({top:h.position().top+h.outerHeight()-4+"px",left:0}),z(aT.body).click(B)),!1});return l.resetLikePanel(),aF()&&h.hide(),l},resetLikePanel:function(){this.el.find(".ds-like-panel").html(ar.likePanel(this.embedThread.data))}},ar.postListHead=function(g){var a=g.data,h=g.options;return'<div class="ds-comments-info"><div class="ds-sort"><a class="ds-order-desc">'+a4.latest+'</a><a class="ds-order-asc">'+a4.earliest+'</a><a class="ds-order-hot">'+a4.hottest+'</a></div><ul class="ds-comments-tabs"><li class="ds-tab"><a class="ds-comments-tab-duoshuo ds-current" href="javascript:void(0);"></a></li>'+(h.show_reposts&&a.reposts?'<li class="ds-tab"><a class="ds-comments-tab-repost" href="javascript:void(0);"></a></li>':"")+(h.show_weibo&&a.weibo_reposts?'<li class="ds-tab"><a class="ds-comments-tab-weibo" href="javascript:void(0);"></a></li>':"")+(h.show_qqt&&a.qqt_reposts?'<li class="ds-tab"><a class="ds-comments-tab-qqt" href="javascript:void(0);"></a></li>':"")+"</ul></div>"},aw.PostListHead=function(a){this.embedThread=a},aw.PostListHead.prototype={render:function(){var i=this.embedThread,a=i.options,y=i.postList,h=this.el=z(ar.postListHead(i)),g=h.find("ul.ds-comments-tabs").delegate(".ds-tab a","click",function(s){g.find("a.ds-current").removeClass("ds-current"),y.params.page=1;var B=s.currentTarget;switch(B.className){case"ds-comments-tab-duoshuo":y.params.source="duoshuo",i.replybox.el.show();break;case"ds-comments-tab-repost":y.params.source="repost",i.replybox.el.hide();break;case"ds-comments-tab-weibo":y.params.source="weibo",i.replybox.el.hide();break;case"ds-comments-tab-qqt":y.params.source="qqt",i.replybox.el.hide();break;default:}return z(B).addClass("ds-current"),y.refetch(),!1}),l=h.find(".ds-sort").delegate("a","click",function(s){return l.find("a.ds-current").removeClass("ds-current"),y.params.order=a.order=this.className.replace("ds-order-",""),y.params.page=1,y.refetch(),z(this).addClass("ds-current"),!1});return l.find(".ds-order-"+y.params.order).addClass("ds-current"),this}},aw.Paginator=function(h){h=h||{};var a=this,i=a.el=h.el||z('<div class="ds-paginator"></div>'),g=a.collection=h.collection;i.delegate("a","click",function(l){return g.params.page=parseInt(this.innerHTML),g.refetch(),i.find(".ds-current").removeClass("ds-current"),z(this).addClass("ds-current"),!1})},aw.Paginator.prototype={reset:function(l){function g(i){h.push('<a data-page="'+i+'" href="javascript:void(0);">'+i+"</a>")}var a=this.collection.params.page||1,s,h=[];if(a>1){g(1),s=a>4?a-2:2,s>2&&h.push('<span class="page-break">...</span>');for(;s<a;s++){g(s)}}h.push('<a data-page="'+a+'" href="javascript:void(0);" class="ds-current">'+a+"</a>");if(a<l.pages){for(s=a+1;s<=a+4&&s<l.pages;s++){g(s)}s<l.pages&&h.push('<span class="page-break">...</span>'),g(l.pages)}this.el.html('<div class="ds-border"></div>'+h.join(" "))[l.pages>1?"show":"hide"]()}},ar.smiliesTooltip=function(g){var a='<div id="ds-smilies-tooltip"><ul class="ds-smilies-tabs">';for(var h in g){a+="<li><a>"+h+"</a></li>"}return a+'</ul><div class="ds-smilies-container"></div></div>'},aQ.addSmilies=function(g,a){var h=aQ.smiliesTooltip;h&&h.el.find("ul.ds-smilies-tabs").append("<li><a>"+g+"</a></li>"),aQ.smilies[g]=a},aw.SmiliesTooltip=function(){},aw.SmiliesTooltip.prototype={render:function(){var a=this,g=a.el=z(ar.smiliesTooltip(aW));return g.click(A).find("ul.ds-smilies-tabs").delegate("a","click",function(h){a.reset(this.innerHTML)}),g.find(".ds-smilies-container").delegate("img","click",function(G){var B=a.replybox,l=B.el.find("textarea")[0],y=l.value;if(aT.selection){l.value=y.substring(0,aR.start)+this.title+y.substring(aR.end,y.length),l.value=l.value.replace(a4.leave_a_message,""),l.focus();var F=aT.selection.createRange();F.moveStart("character",aR.start+this.title.length),F.collapse(),F.select()}else{var h=l.selectionStart+this.title.length;l.value=y.substring(0,l.selectionStart)+this.title+y.substring(l.selectionEnd),l.setSelectionRange(h,h)}B.hideSmilies(),l.focus()}),this},reset:function(g){var a=this.el.find("ul.ds-smilies-tabs");a.find("a.ds-current").removeClass("ds-current"),a.find("a").filter(function(){return this.innerHTML==g}).addClass("ds-current");var h="<ul>";return z.each(aW[g],function(s,y){var l=g.indexOf("\u5fae\u535a")===0?"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/"+y.replace("_org","_thumb"):bf+"/images/smilies/"+y;g==="WordPress"&&(s=" "+s+" "),h+='<li><img src="'+l+'" title="'+aY(s)+'" /></li>'}),h+="</ul>",this.el.find(".ds-smilies-container").html(h),this}},ar.postPlaceholder=function(){return'<li class="ds-post ds-post-placeholder">'+a4.no_comments_yet+"</li>"},ar.post=function(l,g){var B=aq(l),i=B.user_id?' data-user-id="'+B.user_id+'"':"",h=B.qqt_account||"",y=ar.timeHtml(l.created_at,l.url),a=l.parents||[];switch(l.source){case"duoshuo":y+='<a class="ds-post-reply" href="javascript:void(0);"><span class="ds-icon ds-icon-reply"></span>'+a4.reply+"</a>"+ar.likePost(l)+'<a class="ds-post-repost" href="javascript:void(0);"><span class="ds-icon ds-icon-share"></span>'+a4.repost+'</a><a class="ds-post-report" href="javascript:void(0);"><span class="ds-icon ds-icon-report"></span>'+a4.report+"</a>"+(l.privileges["delete"]?'<a class="ds-post-delete" href="javascript:void(0);"><span class="ds-icon ds-icon-delete"></span>'+a4["delete"]+"</a>":"");break;case"qqt":case"weibo":y+='<a class="ds-weibo-comments" href="javascript:void(0);">'+a4.comments+(l.type.match(/\-comment$/)?"":'(<span class="ds-count">'+l.comments+"</span>)")+'</a><a class="ds-weibo-reposts" href="javascript:void(0);">'+a4.reposts+(l.type.match(/\-comment$/)?"":'(<span class="ds-count">'+l.reposts+"</span>)")+"</a>";break;default:}return'<li class="ds-post" data-post-id="'+l.post_id+'"><div class="ds-post-self" data-post-id="'+l.post_id+'" data-thread-id="'+l.thread_id+'" data-root-id="'+l.root_id+'" data-source="'+l.source+'"><div class="ds-avatar"'+i+">"+ar.avatar(B)+(aQ.sourceName[l.source]?ar.serviceIcon(l.source):"")+'</div><div class="ds-comment-body"><div class="ds-comment-header">'+(B.url?'<a class="ds-user-name ds-highlight" data-qqt-account="'+h+'" href="'+aY(B.url)+'" '+(B.user_id?" onclick=\"this.href='"+aQ.hostUrl+"/user-url/?user_id="+B.user_id+"';\"":"")+' rel="nofollow" target="_blank"'+i+">"+aY(B.name)+"</a>":'<span class="ds-user-name"'+i+' data-qqt-account="'+h+'">'+aY(B.name)+"</span>")+"</div>"+(g.max_depth==1&&g.show_context&&a.length?'<ol id="ds-ctx">'+z.map(a,function(F,s){return(s==1&&a.length>2?'<li class="ds-ctx-entry"><a href="javascript:void(0);" class="ds-expand">\u8fd8\u6709'+(a.length-2)+"\u6761\u8bc4\u8bba</a></li>":"")+(aJ[F]?ar.ctxPost(aJ[F].data,s,s&&s<a.length-1):"")}).join("")+"</ol>":"")+"<p>"+(a.length>=g.max_depth&&(!g.show_context||g.max_depth>1)&&l.parent_id&&aJ[l.parent_id]?'<a class="ds-comment-context" data-post-id="'+l.post_id+'" data-parent-id="'+l.parent_id+'">'+a4.reply_to+aY(aq(aJ[l.parent_id].data).name)+": </a>":"")+l.message+'</p><div class="ds-comment-footer ds-comment-actions'+(l.vote>0?" ds-post-liked":"")+'">'+y+"</div></div></div>"+(g.max_depth>1&&(l.childrenArray||l.children)&&l.source!="weibo"&&l.source!="qqt"?'<ul class="ds-children">'+z.map(l.childrenArray||l.children,function(s){return aJ[s]?ar.post(aJ[s].data,g):""}).join("")+"</ul>":"")+"</li>"};var e=z('<div id="ds-bubble"><div class="ds-bubble-content"></div><div class="ds-arrow ds-arrow-down ds-arrow-border"></div><div class="ds-arrow ds-arrow-down"></div></div>'),n=e.find(".ds-bubble-content").delegate("a.ds-ctx-open","click",function(g){ap("/api/posts/conversation",{post_id:n.attr("data-post-id")},function(h){a.el.find("ol").html(z.map(h.response,ar.ctxPost).join("\n"))});var a=a6('<h2>\u67e5\u770b\u5bf9\u8bdd</h2><ol id="ds-ctx"></ol>');return a.el.find(".ds-dialog").css("width","600px"),a.el.find(".ds-dialog-body").css({"max-height":"350px",_height:"350px","overflow-y":"auto","padding-top":"10px"}),!1}),c=bubbleOutTimer=0,b=function(){bubbleOutTimer&&(clearTimeout(bubbleOutTimer),bubbleOutTimer=0)};bubbleOut=function(){bubbleOutTimer=setTimeout(function(){bubbleOutTimer=0,e.detach()},400)},e.mouseenter(b).mouseleave(bubbleOut),ar.userInfo=function(g){var a=[];return z.each(g.social_uid,function(h,i){a.push('<a href="'+aQ.REMOTE+"/user-proxy/"+h+"/"+i+'/" target="_blank" class="ds-service-icon ds-'+h+'" title="'+aQ.sourceName[h]+'"></a>')}),'<a href="'+aY(g.url)+'" class="ds-avatar" target="_blank">'+ar.avatarImg(g)+'</a><a href="'+aY(g.url)+'" class="ds-user-name ds-highlight" target="_blank">'+aY(g.name)+"</a>"+a.join("")+'<p class="ds-user-card-meta"><a href="'+aQ.REMOTE+"/profile/"+g.user_id+'/" target="_blank"><span class="ds-highlight">'+g.comments+"</span>\u6761\u8bc4\u8bba</a></p>"+(g.description?'<p class="ds-user-description">'+aY(g.description)+"</p>":"")},al.PostList=function(a){a&&(a.params&&(this.params=a.params),a.embedThread&&(this.embedThread=a.embedThread)),this.el=z('<ul class="ds-comments"></ul>')},al.PostList.prototype={url:"/api/threads/listPosts",render:function(){return v.call(this.el,this.embedThread,this.embedThread.options),this},reset:function(g){var a=this.embedThread.options;this.el.html(g[0]?z.map(g,function(h){return aJ[h]?ar.post(aJ[h].data,a):""}).join(""):ar.postPlaceholder())},refetch:function(){var a=this,g=z(ar.indicator()).appendTo(aT.body).fadeIn(200);a.el.fadeTo(200,0.5),ap(a.url,a.params,function(h){ah(aJ,h.parentPosts||h.relatedPosts),ah(aL,h.users),a.reset(h.response),a.embedThread.paginator.reset(h.cursor),a.el.fadeTo(200,1),aQ.scrollTo(a.el),g.remove()})}},aQ.repostDialog=function(y,g,B,l){var a=a6('<h2>\u8f6c\u53d1\u5230\u5fae\u535a</h2><div class="ds-quote"><strong>@'+aY(aq(y.data).name)+"</strong>: "+y.data.message+"</div><form>"+ak({post_id:y.data.post_id})+'<div class="ds-textarea-wrapper"><textarea name="message" title="Ctrl+Enter\u5feb\u6377\u63d0\u4ea4" placeholder="'+aY(a4.repost_reason)+'">'+aY(g)+'</textarea><pre class="ds-hidden-text"></pre></div><div class="ds-actions">'+(l?ak({"service[]":l}):'<label><input type="checkbox" name="service[]" value="weibo"'+(aK.data.social_uid.weibo?' checked="checked"':"")+' /><span class="ds-service-icon ds-weibo"></span>\u65b0\u6d6a\u5fae\u535a</label>  <label><input type="checkbox" name="service[]" value="qqt"'+(aK.data.social_uid.qq?' checked="checked"':"")+' /><span class="ds-service-icon ds-qqt"></span>\u817e\u8baf\u5fae\u535a</label>')+'<button type="submit">'+a4.repost+"</button></div></form>"),h=a.el.find("form").submit(function(i){return !l&&!h.find("[type=checkbox]:checked")[0]?(alert("\u8fd8\u6ca1\u6709\u9009\u53d1\u5e03\u5230\u54ea\u513f\u5462"),!1):(aE("/api/posts/repost",aQ.toJSON(h),function(J){if(B&&l){var G=B.options,F=q(B.postList.el,J.response[l],G);G.order=="asc"==(G.formPosition=="top")&&aQ.scrollTo(F);var I=B.el.find(".ds-comments-tab-"+l+" span.ds-highlight");I.html(parseInt(I.html())+1)}}),a.close(),!1)});return h.find(".ds-actions [type=checkbox]").change(function(s){var i=this.value;if(this.checked&&!aK.data.social_uid[i=="qqt"?"qq":i]){u(i);return}}),t(h.find("textarea")).keyup(C).keyup(m).focus(),!1},ar.toolbar=function(g){var a=ar.logoutUrl();return'<div class="ds-toolbar"><div class="ds-account-control"><span class="ds-icon ds-icon-settings"></span> <span>\u5e10\u53f7\u7ba1\u7406</span><ul><li><a class="ds-bind-more" href="javascript:void(0);" style="border-top: none">\u7ed1\u5b9a\u66f4\u591a</a></li><li><a target="_blank" href="'+aQ.REMOTE+"/settings/"+ad(ac())+'">'+aY(a4.settings)+'</a></li><li><a rel="nofollow" href="'+a+'" style="border-bottom: none">\u767b\u51fa</a></li></ul></div><div class="ds-visitor">'+(aK.data.url?'<a class="ds-visitor-name" href="'+aY(aK.data.url)+'" target="_blank">'+aY(aK.data.name)+"</a>":'<span class="ds-visitor-name">'+aY(aK.data.name)+"</span>")+'<a class="ds-unread-comments-count" href="javascript:void(0);" title="\u65b0\u56de\u590d"></a></div></div>'},aw.EmbedThread=f.extend({uri:"/api/threads/listPosts",params:"thread-id local-thread-id source-thread-id thread-key category channel-key author-key author-id url limit order max-depth form-position container-url"+(bb.match(/MSIE 6\.0/)?"":" title image thumbnail"),render:function(){var g=this.el.attr("id","ds-thread").append(ar.waitingImg()),a=g.width(),h=g.data("url")||!g.attr("data-thread-id")&&z("link[rel=canonical]").attr("href");h?g.data("url",bd(h)):g.data("container-url",aV.href),a&&a<=400&&g.addClass("ds-narrow").data("max-depth",1)},updateCounter:function(h){var a={duoshuo:["comments","\u8bc4\u8bba"],repost:["reposts","\u8f6c\u8f7d"],weibo:["weibo_reposts","\u65b0\u6d6a\u5fae\u535a"],qqt:["qqt_reposts","\u817e\u8baf\u5fae\u535a"]};for(var i in a){if(!h||h==i){var g=this.data[a[i][0]];this.el.find(".ds-comments-tab-"+i).html(this.el.hasClass("ds-narrow")?'<span class="ds-service-icon ds-'+i+'"></span>'+g:(g?'<span class="ds-highlight">'+g+"</span>\u6761":"")+a[i][1])}}},onError:function(a){this.el.html("\u8bc4\u8bba\u6846\u51fa\u9519\u5566("+a.code+"): "+a.errorMessage)},onload:function(K){var g=this,L=g.threadId=K.thread.thread_id,J=K.cursor,I=g.options=K.options,F=g.innerEl=H(z('<div id="ds-reset"></div>').appendTo(g.el));g.data=K.thread,ah(aJ,K.parentPosts||K.relatedPosts),ah(aL,K.users),g.el.find("#ds-waiting").remove(),I.like_thread_enabled&&(g.meta=new aw.Meta(g),g.meta.render().el.appendTo(F)),I.hot_posts&&K.hotPosts&&K.hotPosts.length&&(g.hotPosts=new aw.HotPosts(z('<div class="ds-rounded"></div>'),{max_depth:1,show_context:I.show_context}),g.hotPosts.thread=g,g.hotPosts.el.appendTo(F),g.hotPosts.onload({response:K.hotPosts,options:{}})),g.postListHead=new aw.PostListHead(g),g.postList=new al.PostList({embedThread:g,params:{source:"duoshuo",thread_id:L,max_depth:I.max_depth,order:I.order,limit:I.limit}}),g.postList.render().reset(K.response),g.paginator=new aw.Paginator({collection:g.postList}),g.paginator.reset(J);var y=g.replybox=new aw.Replybox(g),G=y.render().el.find("textarea");y.postList=g.postList.el;if(aZ){var B="ds_draft_"+L;G.bind("focus blur keyup",function(h){var a=z(h.currentTarget).val();try{aZ[B]=a}catch(h){}}),aZ[B]&&G.val(aZ[B])}if(aF()){var i=z(ar.loginButtons()).delegate("a.ds-more-services","click",function(){return i.find(".ds-additional-services").toggle(),!1});k(i)}else{g.toolbar=z(ar.toolbar()).delegate(".ds-account-control","mouseenter",function(){z(this).addClass("ds-active")}).delegate(".ds-account-control","mouseleave",function(){z(this).removeClass("ds-active")}).delegate("a.ds-bind-more","click",function(){var a=a6("<h2>\u7ed1\u5b9a\u66f4\u591a\u5e10\u53f7</h2>"+ar.serviceList(1)+ar.additionalServices(1)+'<div style="clear:both"></div>').el.find(".ds-dialog").addClass("ds-dialog-bind-more").css("width","300px");return k(a),!1}).delegate("a.ds-unread-comments-count","click",function(a){return d("unread-comments"),!1})}g.postListHead.render().el.appendTo(F)[I.formPosition=="top"?"before":"after"]('<a name="respond"></a>',g.toolbar||i,y.el).after(g.postList.el,g.paginator.el),g.updateCounter(),K.alerts&&z.each(K.alerts,function(h,a){z('<div class="ds-alert">'+a+"</div>").insertBefore(g.toolbar||i)}),I.message&&G.val(I.message).focus(),z(ar.poweredBy(I.poweredby_text)).appendTo(F),aH.on("reset",function(){var a=aH.data.comments||0;F.find("a.ds-unread-comments-count").html(a).attr("title",a?"\u4f60\u6709"+a+"\u6761\u65b0\u56de\u590d":"\u4f60\u6ca1\u6709\u65b0\u56de\u590d").css("display",a?"inline":"none")}),I.mzadx_id&&(aQ.require("mzadxN",function(){}),z('<div id="MZADX_'+I.mzadx_id+'" style="margin:0 auto;"></div>').appendTo(F),__mz_rpq=bc.__mz_rpq||[],__mz_rpq.push({l:[I.mzadx_id],r:"1",_srv:"MZADX",_callback:function(h,a){}})),aQ.thread=g,aH.data!==a1&&aH.trigger("reset"),aF()||aB({visit_thread_id:g.threadId})},onMessage:function(a){q(this.postList.el,a,this.options)}}),ar.hotPosts=function(g,a){return'<div class="ds-header ds-gradient-bg">'+a4.hot_posts_title+"</div><ul>"+z.map(g,function(h){return aJ[h]?ar.post(aJ[h].data,a):""}).join("")+"</ul>"},aw.HotPosts=f.extend({params:"show-quote",tmpl:"hotPosts",render:function(){return this.el.attr("id","ds-hot-posts"),this},onload:function(a){f.prototype.onload.call(this,a),v.call(this.el.find("ul"),this.thread,this.options)}}),ar.commentList=function(g,a){return z.map(g,function(h){var i=aq(h);return'<li class="ds-comment'+(a.show_avatars?" ds-show-avatars":"")+'" data-post-id="'+h.post_id+'">'+(a.show_avatars?'<div class="ds-avatar">'+ar.avatar(i,a.avatar_size)+"</div>":"")+'<div class="ds-meta">'+ar.userAnchor(i)+(a.show_time?ar.timeHtml(h.created_at):"")+"</div>"+(a.show_title?'<div class="ds-thread-title">\u5728 <a href="'+aY(h.thread.url+"#comments")+'">'+aY(h.thread.title)+'</a> \u4e2d\u8bc4\u8bba</div><div class="ds-excerpt">'+h.message+"</div>":'<a class="ds-excerpt" title="'+aY(h.thread.title)+' \u4e2d\u7684\u8bc4\u8bba" href="'+aY(h.thread.url+"#comments")+'">'+h.message+"</a>")+"</li>"}).join("")},aw.RecentComments=f.extend({uri:"/api/sites/listRecentPosts",params:"show-avatars show-time show-title avatar-size show-admin excerpt-length num-items channel-key",tmpl:"commentList",render:function(){this.el.attr("id","ds-recent-comments")}}),ar.recentVisitors=function(g,a){return z.map(g,function(h){return'<div class="ds-avatar">'+ar.avatar(h,a.avatar_size)+"</div>"}).join("")},aw.RecentVisitors=f.extend({uri:"/api/sites/listVisitors",params:"show-time avatar-size num-items channel-key",tmpl:"recentVisitors",render:function(){this.el.children().detach(),this.el.attr("id","ds-recent-visitors").append(this.waitingEl=z(ar.waitingImg()))}}),ar.topUsers=function(g,a){return z.map(g,function(h){return'<div class="ds-avatar">'+ar.avatar(h,a.avatar_size)+"<h4>"+h.name+"</h4></div>"}).join("")},aw.TopUsers=f.extend({uri:"/api/sites/listTopUsers",params:"show-time avatar-size num-items channel-key",tmpl:"topUsers",render:function(){this.el.children().detach(),this.el.attr("id","ds-top-users").append(this.waitingEl=z(ar.waitingImg()))}}),ar.topThreads=function(g,a){return z.map(g,function(h){return'<li><a target="_blank" href="'+aY(h.url)+'" title="'+h.title+'">'+h.title+"</a></li>"}).join("")},aw.TopThreads=f.extend({uri:"/api/sites/listTopThreads",params:"range num-items channel-key",tmpl:"topThreads",render:function(){this.el.children().detach(),this.el.attr("id","ds-top-threads").append(this.waitingEl=z(ar.waitingImg()))}}),ar.loginWidget=function(){var a='<div class="ds-icons-32">';return z.each(["weibo","qq","renren","kaixin","douban","netease","sohu"],function(g,h){a+='<a class="ds-'+h+'" href="'+ar.loginUrl(h)+'">'+aQ.sourceName[h]+"</a>"}),a+"</div>"},aw.LoginWidget=f.extend({tmpl:"loginWidget",render:function(){var a=this.el;a.attr("id","ds-login").html(ar.loginWidget()),k(a,"a"),a.find("a.ds-logout").attr("href",ar.logoutUrl())}}),aw.ThreadCount=f.extend({onload:function(h){var a=this.el,i=a.data("count-type")||"comments",g=h.data[i];a[a.data("replace")?"replaceWith":"html"](a4[i+"_"+(g?g>1?"multiple":"one":"zero")].replace("{num}",g))}});var x=0;aQ.initSelector=function(g,a){var h=[];ae()&&(z.isReady||!aA)&&z(g).each(function(F,B){var y=z(B);if(y.data("initialized")){return}y.data("initialized",!0);var G=new aw[a.type](y,a);aC.push(G);if(a.type==="ThreadCount"){var l=y.attr("data-thread-key");y.attr("data-channel-key")&&(l=y.attr("data-channel-key")+":"+l),h.push(l),ax[l]||(ax[l]=new aX({})),ax[l].on("reset",function(){G.onload(this)})}else{if(G.uri){var i={};z.each(G.params.split(" "),function(I,s){i[s.replace(/-/g,"_")]=y.attr("data-"+s)||y.data(s)}),ap(G.uri,D(i),function(s){G.load(s)})}}}),h.length&&ap("/api/threads/counts",D({threads:h.join(",")}),function(i){w(i),aG(a4,i.options),ah(ax,i.response)})},(aQ.initView=function(){z.each(an,aQ.initSelector)})(),z(function(){if(!ae()){return au("\u7f3a\u5c11duoshuoQuery\u7684\u5b9a\u4e49")}setInterval(function(){z(".ds-time").each(function(){var a=z(this).attr("datetime");a&&(this.innerHTML=aQ.elapsedTime(a))})},20000),aN.ondomready&&aN.ondomready(),aQ.initView(),!x&&aN.short_name&&ap("/api/analytics/ping",D({}),w)})})})(window,document);